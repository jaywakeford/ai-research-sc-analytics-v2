(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[129],{2927:function(module,__unused_webpack_exports,__webpack_require__){var Buffer=__webpack_require__(7133).lW,process=__webpack_require__(5566);!/**
 * @licstart The following is the entire license notice for the
 * JavaScript code in this page
 *
 * Copyright 2023 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @licend The above is the entire license notice for the
 * JavaScript code in this page
 */function(o,l){module.exports=l()}(globalThis,()=>(()=>{"use strict";var __webpack_modules__=[,(o,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.VerbosityLevel=l.Util=l.UnknownErrorException=l.UnexpectedResponseException=l.TextRenderingMode=l.RenderingIntentFlag=l.PromiseCapability=l.PermissionFlag=l.PasswordResponses=l.PasswordException=l.PageActionEventType=l.OPS=l.MissingPDFException=l.MAX_IMAGE_SIZE_TO_CACHE=l.LINE_FACTOR=l.LINE_DESCENT_FACTOR=l.InvalidPDFException=l.ImageKind=l.IDENTITY_MATRIX=l.FormatError=l.FeatureTest=l.FONT_IDENTITY_MATRIX=l.DocumentActionEventType=l.CMapCompressionType=l.BaseException=l.BASELINE_FACTOR=l.AnnotationType=l.AnnotationStateModelType=l.AnnotationReviewState=l.AnnotationReplyType=l.AnnotationMode=l.AnnotationMarkedState=l.AnnotationFlag=l.AnnotationFieldFlag=l.AnnotationEditorType=l.AnnotationEditorPrefix=l.AnnotationEditorParamsType=l.AnnotationBorderStyleType=l.AnnotationActionEventType=l.AbortException=void 0,l.assert=tp,l.bytesToString=tP,l.createValidAbsoluteUrl=tf,l.getModificationDate=tq,l.getVerbosityLevel=th,l.info=td,l.isArrayBuffer=tG,l.isArrayEqual=tH,l.normalizeUnicode=t$,l.objectFromMap=tR,l.objectSize=tw,l.setVerbosityLevel=tl,l.shadow=tm,l.string32=tk,l.stringToBytes=tM,l.stringToPDFString=tj,l.stringToUTF8String=tB,l.unreachable=tu,l.utf8StringToString=tU,l.warn=tc;let S=[1,0,0,1,0,0];l.IDENTITY_MATRIX=S;let E=[.001,0,0,.001,0,0];l.FONT_IDENTITY_MATRIX=E;let T=1e7;l.MAX_IMAGE_SIZE_TO_CACHE=T;let P=1.35;l.LINE_FACTOR=P;let M=.35;l.LINE_DESCENT_FACTOR=M;let F=M/P;l.BASELINE_FACTOR=F;let O={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};l.RenderingIntentFlag=O;let I={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};l.AnnotationMode=I;let D="pdfjs_internal_editor_";l.AnnotationEditorPrefix=D;let L={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};l.AnnotationEditorType=L;let N={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};l.AnnotationEditorParamsType=N;let U={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};l.PermissionFlag=U;let H={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};l.TextRenderingMode=H;let W={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};l.ImageKind=W;let z={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};l.AnnotationType=z;let V={MARKED:"Marked",REVIEW:"Review"};l.AnnotationStateModelType=V;let $={MARKED:"Marked",UNMARKED:"Unmarked"};l.AnnotationMarkedState=$;let K={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};l.AnnotationReviewState=K;let Y={GROUP:"Group",REPLY:"R"};l.AnnotationReplyType=Y;let J={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};l.AnnotationFlag=J;let Q={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};l.AnnotationFieldFlag=Q;let Z={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};l.AnnotationBorderStyleType=Z;let tt={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};l.AnnotationActionEventType=tt;let te={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};l.DocumentActionEventType=te;let ti={O:"PageOpen",C:"PageClose"};l.PageActionEventType=ti;let ts={ERRORS:0,WARNINGS:1,INFOS:5};l.VerbosityLevel=ts;let tr={NONE:0,BINARY:1};l.CMapCompressionType=tr;let ta={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};l.OPS=ta;let tn={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};l.PasswordResponses=tn;let to=ts.WARNINGS;function tl(o){Number.isInteger(o)&&(to=o)}function th(){return to}function td(o){to>=ts.INFOS&&console.log(`Info: ${o}`)}function tc(o){to>=ts.WARNINGS&&console.log(`Warning: ${o}`)}function tu(o){throw Error(o)}function tp(o,l){o||tu(l)}function tg(o){switch(o?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function tf(o,l=null,S=null){if(!o)return null;try{if(S&&"string"==typeof o){if(S.addDefaultProtocol&&o.startsWith("www.")){let l=o.match(/\./g);l?.length>=2&&(o=`http://${o}`)}if(S.tryConvertEncoding)try{o=tB(o)}catch(o){}}let E=l?new URL(o,l):new URL(o);if(tg(E))return E}catch(o){}return null}function tm(o,l,S,E=!1){return Object.defineProperty(o,l,{value:S,enumerable:!E,configurable:!0,writable:!1}),S}let tb=function(){function o(l,S){this.constructor===o&&tu("Cannot initialize BaseException."),this.message=l,this.name=S}return o.prototype=Error(),o.constructor=o,o}();l.BaseException=tb;class tA extends tb{constructor(o,l){super(o,"PasswordException"),this.code=l}}l.PasswordException=tA;class tv extends tb{constructor(o,l){super(o,"UnknownErrorException"),this.details=l}}l.UnknownErrorException=tv;class t_ extends tb{constructor(o){super(o,"InvalidPDFException")}}l.InvalidPDFException=t_;class tS extends tb{constructor(o){super(o,"MissingPDFException")}}l.MissingPDFException=tS;class tC extends tb{constructor(o,l){super(o,"UnexpectedResponseException"),this.status=l}}l.UnexpectedResponseException=tC;class tE extends tb{constructor(o){super(o,"FormatError")}}l.FormatError=tE;class tT extends tb{constructor(o){super(o,"AbortException")}}function tP(o){("object"!=typeof o||o?.length===void 0)&&tu("Invalid argument for bytesToString");let l=o.length,S=8192;if(l<S)return String.fromCharCode.apply(null,o);let E=[];for(let T=0;T<l;T+=S){let P=Math.min(T+S,l),M=o.subarray(T,P);E.push(String.fromCharCode.apply(null,M))}return E.join("")}function tM(o){"string"!=typeof o&&tu("Invalid argument for stringToBytes");let l=o.length,S=new Uint8Array(l);for(let E=0;E<l;++E)S[E]=255&o.charCodeAt(E);return S}function tk(o){return String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,255&o)}function tw(o){return Object.keys(o).length}function tR(o){let l=Object.create(null);for(let[S,E]of o)l[S]=E;return l}function tF(){let o=new Uint8Array(4);o[0]=1;let l=new Uint32Array(o.buffer,0,1);return 1===l[0]}function tO(){try{return Function(""),!0}catch(o){return!1}}l.AbortException=tT;class tI{static get isLittleEndian(){return tm(this,"isLittleEndian",tF())}static get isEvalSupported(){return tm(this,"isEvalSupported",tO())}static get isOffscreenCanvasSupported(){return tm(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}static get platform(){return"undefined"==typeof navigator?tm(this,"platform",{isWin:!1,isMac:!1}):tm(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}l.FeatureTest=tI;let tD=[...Array(256).keys()].map(o=>o.toString(16).padStart(2,"0"));class tL{static makeHexColor(o,l,S){return`#${tD[o]}${tD[l]}${tD[S]}`}static scaleMinMax(o,l){let S;o[0]?(o[0]<0&&(S=l[0],l[0]=l[1],l[1]=S),l[0]*=o[0],l[1]*=o[0],o[3]<0&&(S=l[2],l[2]=l[3],l[3]=S),l[2]*=o[3],l[3]*=o[3]):(S=l[0],l[0]=l[2],l[2]=S,S=l[1],l[1]=l[3],l[3]=S,o[1]<0&&(S=l[2],l[2]=l[3],l[3]=S),l[2]*=o[1],l[3]*=o[1],o[2]<0&&(S=l[0],l[0]=l[1],l[1]=S),l[0]*=o[2],l[1]*=o[2]),l[0]+=o[4],l[1]+=o[4],l[2]+=o[5],l[3]+=o[5]}static transform(o,l){return[o[0]*l[0]+o[2]*l[1],o[1]*l[0]+o[3]*l[1],o[0]*l[2]+o[2]*l[3],o[1]*l[2]+o[3]*l[3],o[0]*l[4]+o[2]*l[5]+o[4],o[1]*l[4]+o[3]*l[5]+o[5]]}static applyTransform(o,l){let S=o[0]*l[0]+o[1]*l[2]+l[4],E=o[0]*l[1]+o[1]*l[3]+l[5];return[S,E]}static applyInverseTransform(o,l){let S=l[0]*l[3]-l[1]*l[2],E=(o[0]*l[3]-o[1]*l[2]+l[2]*l[5]-l[4]*l[3])/S,T=(-o[0]*l[1]+o[1]*l[0]+l[4]*l[1]-l[5]*l[0])/S;return[E,T]}static getAxialAlignedBoundingBox(o,l){let S=tL.applyTransform(o,l),E=tL.applyTransform(o.slice(2,4),l),T=tL.applyTransform([o[0],o[3]],l),P=tL.applyTransform([o[2],o[1]],l);return[Math.min(S[0],E[0],T[0],P[0]),Math.min(S[1],E[1],T[1],P[1]),Math.max(S[0],E[0],T[0],P[0]),Math.max(S[1],E[1],T[1],P[1])]}static inverseTransform(o){let l=o[0]*o[3]-o[1]*o[2];return[o[3]/l,-o[1]/l,-o[2]/l,o[0]/l,(o[2]*o[5]-o[4]*o[3])/l,(o[4]*o[1]-o[5]*o[0])/l]}static singularValueDecompose2dScale(o){let l=[o[0],o[2],o[1],o[3]],S=o[0]*l[0]+o[1]*l[2],E=o[0]*l[1]+o[1]*l[3],T=o[2]*l[0]+o[3]*l[2],P=o[2]*l[1]+o[3]*l[3],M=(S+P)/2,F=Math.sqrt((S+P)**2-4*(S*P-T*E))/2,O=M+F||1,I=M-F||1;return[Math.sqrt(O),Math.sqrt(I)]}static normalizeRect(o){let l=o.slice(0);return o[0]>o[2]&&(l[0]=o[2],l[2]=o[0]),o[1]>o[3]&&(l[1]=o[3],l[3]=o[1]),l}static intersect(o,l){let S=Math.max(Math.min(o[0],o[2]),Math.min(l[0],l[2])),E=Math.min(Math.max(o[0],o[2]),Math.max(l[0],l[2]));if(S>E)return null;let T=Math.max(Math.min(o[1],o[3]),Math.min(l[1],l[3])),P=Math.min(Math.max(o[1],o[3]),Math.max(l[1],l[3]));return T>P?null:[S,T,E,P]}static bezierBoundingBox(o,l,S,E,T,P,M,F){let O,I,D,L,N,U,H,W;let z=[],V=[[],[]];for(let V=0;V<2;++V){if(0===V?(I=6*o-12*S+6*T,O=-3*o+9*S-9*T+3*M,D=3*S-3*o):(I=6*l-12*E+6*P,O=-3*l+9*E-9*P+3*F,D=3*E-3*l),1e-12>Math.abs(O)){if(1e-12>Math.abs(I))continue;0<(L=-D/I)&&L<1&&z.push(L);continue}W=Math.sqrt(H=I*I-4*D*O),!(H<0)&&(0<(N=(-I+W)/(2*O))&&N<1&&z.push(N),0<(U=(-I-W)/(2*O))&&U<1&&z.push(U))}let $=z.length,K,Y=$;for(;$--;)K=1-(L=z[$]),V[0][$]=K*K*K*o+3*K*K*L*S+3*K*L*L*T+L*L*L*M,V[1][$]=K*K*K*l+3*K*K*L*E+3*K*L*L*P+L*L*L*F;return V[0][Y]=o,V[1][Y]=l,V[0][Y+1]=M,V[1][Y+1]=F,V[0].length=V[1].length=Y+2,[Math.min(...V[0]),Math.min(...V[1]),Math.max(...V[0]),Math.max(...V[1])]}}l.Util=tL;let tN=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function tj(o){if(o[0]>="\xef"){let l;if("\xfe"===o[0]&&"\xff"===o[1]?l="utf-16be":"\xff"===o[0]&&"\xfe"===o[1]?l="utf-16le":"\xef"===o[0]&&"\xbb"===o[1]&&"\xbf"===o[2]&&(l="utf-8"),l)try{let S=new TextDecoder(l,{fatal:!0}),E=tM(o);return S.decode(E)}catch(o){tc(`stringToPDFString: "${o}".`)}}let l=[];for(let S=0,E=o.length;S<E;S++){let E=tN[o.charCodeAt(S)];l.push(E?String.fromCharCode(E):o.charAt(S))}return l.join("")}function tB(o){return decodeURIComponent(escape(o))}function tU(o){return unescape(encodeURIComponent(o))}function tG(o){return"object"==typeof o&&o?.byteLength!==void 0}function tH(o,l){if(o.length!==l.length)return!1;for(let S=0,E=o.length;S<E;S++)if(o[S]!==l[S])return!1;return!0}function tq(o=new Date){let l=[o.getUTCFullYear().toString(),(o.getUTCMonth()+1).toString().padStart(2,"0"),o.getUTCDate().toString().padStart(2,"0"),o.getUTCHours().toString().padStart(2,"0"),o.getUTCMinutes().toString().padStart(2,"0"),o.getUTCSeconds().toString().padStart(2,"0")];return l.join("")}class tW{#t=!1;constructor(){this.promise=new Promise((o,l)=>{this.resolve=l=>{this.#t=!0,o(l)},this.reject=o=>{this.#t=!0,l(o)}})}get settled(){return this.#t}}l.PromiseCapability=tW;let tz=null,tV=null;function t$(o){return tz||(tz=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,tV=new Map([["ﬅ","ſt"]])),o.replaceAll(tz,(o,l,S)=>l?l.normalize("NFKC"):tV.get(S))}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{let createPDFNetworkStream;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);let DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){let{NodeCanvasFactory,NodeCMapReaderFactory,NodeFilterFactory,NodeStandardFontDataFactory}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=NodeCanvasFactory,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=NodeCMapReaderFactory,exports.DefaultFilterFactory=DefaultFilterFactory=NodeFilterFactory,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=NodeStandardFontDataFactory}if(_is_node.isNodeJS){let{PDFNodeStream}=__w_pdfjs_require__(21);createPDFNetworkStream=o=>new PDFNodeStream(o)}else{let{PDFNetworkStream}=__w_pdfjs_require__(24),{PDFFetchStream}=__w_pdfjs_require__(25);createPDFNetworkStream=o=>(0,_display_utils.isValidFetchUrl)(o.url)?new PDFFetchStream(o):new PDFNetworkStream(o)}function getDocument(o){if("string"==typeof o||o instanceof URL?o={url:o}:(0,_util.isArrayBuffer)(o)&&(o={data:o}),"object"!=typeof o)throw Error("Invalid parameter in getDocument, need parameter object.");if(!o.url&&!o.data&&!o.range)throw Error("Invalid parameter object: need either .data, .range or .url");let l=new PDFDocumentLoadingTask,{docId:S}=l,E=o.url?getUrlProp(o.url):null,T=o.data?getDataProp(o.data):null,P=o.httpHeaders||null,M=!0===o.withCredentials,F=o.password??null,O=o.range instanceof PDFDataRangeTransport?o.range:null,I=Number.isInteger(o.rangeChunkSize)&&o.rangeChunkSize>0?o.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE,D=o.worker instanceof PDFWorker?o.worker:null,L=o.verbosity,N="string"!=typeof o.docBaseUrl||(0,_display_utils.isDataScheme)(o.docBaseUrl)?null:o.docBaseUrl,U="string"==typeof o.cMapUrl?o.cMapUrl:null,H=!1!==o.cMapPacked,W=o.CMapReaderFactory||DefaultCMapReaderFactory,z="string"==typeof o.standardFontDataUrl?o.standardFontDataUrl:null,V=o.StandardFontDataFactory||DefaultStandardFontDataFactory,$=!0!==o.stopAtErrors,K=Number.isInteger(o.maxImageSize)&&o.maxImageSize>-1?o.maxImageSize:-1,Y=!1!==o.isEvalSupported,J="boolean"==typeof o.isOffscreenCanvasSupported?o.isOffscreenCanvasSupported:!_is_node.isNodeJS,Q=Number.isInteger(o.canvasMaxAreaInBytes)?o.canvasMaxAreaInBytes:-1,Z="boolean"==typeof o.disableFontFace?o.disableFontFace:_is_node.isNodeJS,tt=!0===o.fontExtraProperties,te=!0===o.enableXfa,ti=o.ownerDocument||globalThis.document,ts=!0===o.disableRange,tr=!0===o.disableStream,ta=!0===o.disableAutoFetch,tn=!0===o.pdfBug,to=O?O.length:o.length??NaN,tl="boolean"==typeof o.useSystemFonts?o.useSystemFonts:!_is_node.isNodeJS&&!Z,th="boolean"==typeof o.useWorkerFetch?o.useWorkerFetch:W===_display_utils.DOMCMapReaderFactory&&V===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(U,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(z,document.baseURI),td=o.canvasFactory||new DefaultCanvasFactory({ownerDocument:ti}),tc=o.filterFactory||new DefaultFilterFactory({docId:S,ownerDocument:ti}),tu=null;(0,_util.setVerbosityLevel)(L);let tp={canvasFactory:td,filterFactory:tc};if(th||(tp.cMapReaderFactory=new W({baseUrl:U,isCompressed:H}),tp.standardFontDataFactory=new V({baseUrl:z})),!D){let o={verbosity:L,port:_worker_options.GlobalWorkerOptions.workerPort};D=o.port?PDFWorker.fromPort(o):new PDFWorker(o),l._worker=D}let tg={docId:S,apiVersion:"3.6.172",data:T,password:F,disableAutoFetch:ta,rangeChunkSize:I,length:to,docBaseUrl:N,enableXfa:te,evaluatorOptions:{maxImageSize:K,disableFontFace:Z,ignoreErrors:$,isEvalSupported:Y,isOffscreenCanvasSupported:J,canvasMaxAreaInBytes:Q,fontExtraProperties:tt,useSystemFonts:tl,cMapUrl:th?U:null,standardFontDataUrl:th?z:null}},tf={ignoreErrors:$,isEvalSupported:Y,disableFontFace:Z,fontExtraProperties:tt,enableXfa:te,ownerDocument:ti,disableAutoFetch:ta,pdfBug:tn,styleElement:tu};return D.promise.then(function(){if(l.destroyed)throw Error("Loading aborted");let o=_fetchDocument(D,tg),F=new Promise(function(o){let l;O?l=new _transport_stream.PDFDataTransportStream({length:to,initialData:O.initialData,progressiveDone:O.progressiveDone,contentDispositionFilename:O.contentDispositionFilename,disableRange:ts,disableStream:tr},O):T||(l=createPDFNetworkStream({url:E,length:to,httpHeaders:P,withCredentials:M,rangeChunkSize:I,disableRange:ts,disableStream:tr})),o(l)});return Promise.all([o,F]).then(function([o,E]){if(l.destroyed)throw Error("Loading aborted");let T=new _message_handler.MessageHandler(S,o,D.port),P=new WorkerTransport(T,l,E,tf,tp);l._transport=P,T.send("Ready",null)})}).catch(l._capability.reject),l}async function _fetchDocument(o,l){if(o.destroyed)throw Error("Worker was destroyed");let S=await o.messageHandler.sendWithPromise("GetDocRequest",l,l.data?[l.data.buffer]:null);if(o.destroyed)throw Error("Worker was destroyed");return S}function getUrlProp(o){if(o instanceof URL)return o.href;try{return new URL(o,window.location).href}catch(l){if(_is_node.isNodeJS&&"string"==typeof o)return o}throw Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(o){if(_is_node.isNodeJS&&void 0!==Buffer&&o instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(o);if(o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength)return o;if("string"==typeof o)return(0,_util.stringToBytes)(o);if("object"==typeof o&&!isNaN(o?.length)||(0,_util.isArrayBuffer)(o))return new Uint8Array(o);throw Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static #e=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0,await this._transport?.destroy(),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(o,l,S=!1,E=null){this.length=o,this.initialData=l,this.progressiveDone=S,this.contentDispositionFilename=E,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(o){this._rangeListeners.push(o)}addProgressListener(o){this._progressListeners.push(o)}addProgressiveReadListener(o){this._progressiveReadListeners.push(o)}addProgressiveDoneListener(o){this._progressiveDoneListeners.push(o)}onDataRange(o,l){for(let S of this._rangeListeners)S(o,l)}onDataProgress(o,l){this._readyCapability.promise.then(()=>{for(let S of this._progressListeners)S(o,l)})}onDataProgressiveRead(o){this._readyCapability.promise.then(()=>{for(let l of this._progressiveReadListeners)l(o)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(let o of this._progressiveDoneListeners)o()})}transportReady(){this._readyCapability.resolve()}requestDataRange(o,l){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(o,l){this._pdfInfo=o,this._transport=l}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(o){return this._transport.getPage(o)}getPageIndex(o){return this._transport.getPageIndex(o)}getDestinations(){return this._transport.getDestinations()}getDestination(o){return this._transport.getDestination(o)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(o=!1){return this._transport.startCleanup(o||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#i=null;#s=!1;constructor(o,l,S,E=!1){this._pageIndex=o,this._pageInfo=l,this._transport=S,this._stats=E?new _display_utils.StatTimer:null,this._pdfBug=E,this.commonObjs=S.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:o,rotation:l=this.rotate,offsetX:S=0,offsetY:E=0,dontFlip:T=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:o,rotation:l,offsetX:S,offsetY:E,dontFlip:T})}getAnnotations({intent:o="display"}={}){let l=this._transport.getRenderingIntent(o);return this._transport.getAnnotations(this._pageIndex,l.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:o,viewport:l,intent:S="display",annotationMode:E=_util.AnnotationMode.ENABLE,transform:T=null,background:P=null,optionalContentConfigPromise:M=null,annotationCanvasMap:F=null,pageColors:O=null,printAnnotationStorage:I=null}){if(arguments[0]?.canvasFactory)throw Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");this._stats?.time("Overall");let D=this._transport.getRenderingIntent(S,E,I);this.#s=!1,this.#r(),M||(M=this._transport.getOptionalContentConfig());let L=this._intentStates.get(D.cacheKey);L||(L=Object.create(null),this._intentStates.set(D.cacheKey,L)),L.streamReaderCancelTimeout&&(clearTimeout(L.streamReaderCancelTimeout),L.streamReaderCancelTimeout=null);let N=!!(D.renderingIntent&_util.RenderingIntentFlag.PRINT);L.displayReadyCapability||(L.displayReadyCapability=new _util.PromiseCapability,L.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(D));let U=o=>{L.renderTasks.delete(H),(this._maybeCleanupAfterRender||N)&&(this.#s=!0),this.#a(!N),o?(H.capability.reject(o),this._abortOperatorList({intentState:L,reason:o instanceof Error?o:Error(o)})):H.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},H=new InternalRenderTask({callback:U,params:{canvasContext:o,viewport:l,transform:T,background:P},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:F,operatorList:L.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!N,pdfBug:this._pdfBug,pageColors:O});(L.renderTasks||=new Set).add(H);let W=H.task;return Promise.all([L.displayReadyCapability.promise,M]).then(([o,l])=>{if(this.#s){U();return}this._stats?.time("Rendering"),H.initializeGraphics({transparency:o,optionalContentConfig:l}),H.operatorListChanged()}).catch(U),W}getOperatorList({intent:o="display",annotationMode:l=_util.AnnotationMode.ENABLE,printAnnotationStorage:S=null}={}){let E;function T(){M.operatorList.lastChunk&&(M.opListReadCapability.resolve(M.operatorList),M.renderTasks.delete(E))}let P=this._transport.getRenderingIntent(o,l,S,!0),M=this._intentStates.get(P.cacheKey);return M||(M=Object.create(null),this._intentStates.set(P.cacheKey,M)),M.opListReadCapability||((E=Object.create(null)).operatorListChanged=T,M.opListReadCapability=new _util.PromiseCapability,(M.renderTasks||=new Set).add(E),M.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(P)),M.opListReadCapability.promise}streamTextContent({includeMarkedContent:o=!1,disableNormalization:l=!1}={}){let S=100;return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===o,disableNormalization:!0===l},{highWaterMark:S,size:o=>o.items.length})}getTextContent(o={}){if(this._transport._htmlForXfa)return this.getXfa().then(o=>_xfa_text.XfaText.textContent(o));let l=this.streamTextContent(o);return new Promise(function(o,S){function E(){T.read().then(function({value:l,done:S}){if(S){o(P);return}Object.assign(P.styles,l.styles),P.items.push(...l.items),E()},S)}let T=l.getReader(),P={items:[],styles:Object.create(null)};E()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;let o=[];for(let l of this._intentStates.values())if(this._abortOperatorList({intentState:l,reason:Error("Page was destroyed."),force:!0}),!l.opListReadCapability)for(let S of l.renderTasks)o.push(S.completed),S.cancel();return this.objs.clear(),this.#s=!1,this.#r(),Promise.all(o)}cleanup(o=!1){this.#s=!0;let l=this.#a(!1);return o&&l&&(this._stats&&=new _display_utils.StatTimer),l}#a(o=!1){if(this.#r(),!this.#s)return!1;if(o)return this.#i=setTimeout(()=>{this.#i=null,this.#a(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(let{renderTasks:o,operatorList:l}of this._intentStates.values())if(o.size>0||!l.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#s=!1,!0}#r(){this.#i&&(clearTimeout(this.#i),this.#i=null)}_startRenderPage(o,l){let S=this._intentStates.get(l);S&&(this._stats?.timeEnd("Page Request"),S.displayReadyCapability?.resolve(o))}_renderPageChunk(o,l){for(let S=0,E=o.length;S<E;S++)l.operatorList.fnArray.push(o.fnArray[S]),l.operatorList.argsArray.push(o.argsArray[S]);for(let S of(l.operatorList.lastChunk=o.lastChunk,l.operatorList.separateAnnots=o.separateAnnots,l.renderTasks))S.operatorListChanged();o.lastChunk&&this.#a(!0)}_pumpOperatorList({renderingIntent:o,cacheKey:l,annotationStorageMap:S}){let E=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:o,cacheKey:l,annotationStorage:S}),T=E.getReader(),P=this._intentStates.get(l);P.streamReader=T;let M=()=>{T.read().then(({value:o,done:l})=>{if(l){P.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(o,P),M())},o=>{if(P.streamReader=null,!this._transport.destroyed){if(P.operatorList){for(let o of(P.operatorList.lastChunk=!0,P.renderTasks))o.operatorListChanged();this.#a(!0)}if(P.displayReadyCapability)P.displayReadyCapability.reject(o);else if(P.opListReadCapability)P.opListReadCapability.reject(o);else throw o}})};M()}_abortOperatorList({intentState:o,reason:l,force:S=!1}){if(o.streamReader){if(o.streamReaderCancelTimeout&&(clearTimeout(o.streamReaderCancelTimeout),o.streamReaderCancelTimeout=null),!S){if(o.renderTasks.size>0)return;if(l instanceof _display_utils.RenderingCancelledException){let S=RENDERING_CANCELLED_TIMEOUT;l.extraDelay>0&&l.extraDelay<1e3&&(S+=l.extraDelay),o.streamReaderCancelTimeout=setTimeout(()=>{o.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:o,reason:l,force:!0})},S);return}}if(o.streamReader.cancel(new _util.AbortException(l.message)).catch(()=>{}),o.streamReader=null,!this._transport.destroyed){for(let[l,S]of this._intentStates)if(S===o){this._intentStates.delete(l);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#n=new Set;#o=Promise.resolve();postMessage(o,l){let S={data:structuredClone(o,l?{transfer:l}:null)};this.#o.then(()=>{for(let o of this.#n)o.call(this,S)})}addEventListener(o,l){this.#n.add(l)}removeEventListener(o,l){this.#n.delete(l)}terminate(){this.#n.clear()}}exports.LoopbackPort=LoopbackPort;let PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_is_node.isNodeJS)PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if("object"==typeof document){let pdfjsFilePath=document?.currentScript?.src;pdfjsFilePath&&(PDFWorkerUtil.fallbackWorkerSrc=pdfjsFilePath.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(o,l){let S;try{if(!(S=new URL(o)).origin||"null"===S.origin)return!1}catch(o){return!1}let E=new URL(l,S);return S.origin===E.origin},PDFWorkerUtil.createCDNWrapper=function(o){let l=`importScripts("${o}");`;return URL.createObjectURL(new Blob([l]))};class PDFWorker{static #l=new WeakMap;constructor({name:o=null,port:l=null,verbosity:S=(0,_util.getVerbosityLevel)()}={}){if(l&&PDFWorker.#l.has(l))throw Error("Cannot use more than one PDFWorker per port.");if(this.name=o,this.destroyed=!1,this.verbosity=S,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,l){PDFWorker.#l.set(l,this),this._initializeFromPort(l);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(o){this._port=o,this._messageHandler=new _message_handler.MessageHandler("main","worker",o),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:o}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,o)||(o=PDFWorkerUtil.createCDNWrapper(new URL(o,window.location).href));let l=new Worker(o),S=new _message_handler.MessageHandler("main","worker",l),E=()=>{l.removeEventListener("error",T),S.destroy(),l.terminate(),this.destroyed?this._readyCapability.reject(Error("Worker was destroyed")):this._setupFakeWorker()},T=()=>{this._webWorker||E()};l.addEventListener("error",T),S.on("test",o=>{if(l.removeEventListener("error",T),this.destroyed){E();return}o?(this._messageHandler=S,this._port=l,this._webWorker=l,this._readyCapability.resolve(),S.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),S.destroy(),l.terminate())}),S.on("ready",o=>{if(l.removeEventListener("error",T),this.destroyed){E();return}try{P()}catch(o){this._setupFakeWorker()}});let P=()=>{let o=new Uint8Array;S.send("test",o,[o.buffer])};P();return}catch(o){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(o=>{if(this.destroyed){this._readyCapability.reject(Error("Worker was destroyed"));return}let l=new LoopbackPort;this._port=l;let S=`fake${PDFWorkerUtil.fakeWorkerId++}`,E=new _message_handler.MessageHandler(S+"_worker",S,l);o.setup(E,l);let T=new _message_handler.MessageHandler(S,S+"_worker",l);this._messageHandler=T,this._readyCapability.resolve(),T.send("configure",{verbosity:this.verbosity})}).catch(o=>{this._readyCapability.reject(Error(`Setting up fake worker failed: "${o.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#l.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(o){if(!o?.port)throw Error("PDFWorker.fromPort - invalid method signature.");return this.#l.has(o.port)?this.#l.get(o.port):new PDFWorker(o)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(null!==PDFWorkerUtil.fallbackWorkerSrc)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch(o){return null}}static get _setupFakeWorkerGlobal(){let loader=async()=>{let mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS){let worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await (0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#h=new Map;#d=new Map;#c=new Map;constructor(o,l,S,E,T){this.messageHandler=o,this.loadingTask=l,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:E.ownerDocument,styleElement:E.styleElement}),this._params=E,this.canvasFactory=T.canvasFactory,this.filterFactory=T.filterFactory,this.cMapReaderFactory=T.cMapReaderFactory,this.standardFontDataFactory=T.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=S,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#u(o,l=null){let S=this.#h.get(o);if(S)return S;let E=this.messageHandler.sendWithPromise(o,l);return this.#h.set(o,E),E}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(o,l=_util.AnnotationMode.ENABLE,S=null,E=!1){let T=_util.RenderingIntentFlag.DISPLAY,P=null;switch(o){case"any":T=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":T=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${o}`)}switch(l){case _util.AnnotationMode.DISABLE:T+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:T+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:T+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE;let M=T&_util.RenderingIntentFlag.PRINT&&S instanceof _annotation_storage.PrintAnnotationStorage?S:this.annotationStorage;P=M.serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${l}`)}return E&&(T+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:T,cacheKey:`${T}_${_annotation_storage.AnnotationStorage.getHash(P)}`,annotationStorageMap:P}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this._passwordCapability&&this._passwordCapability.reject(Error("Worker was destroyed during onPassword callback"));let o=[];for(let l of this.#d.values())o.push(l._destroy());this.#d.clear(),this.#c.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();let l=this.messageHandler.sendWithPromise("Terminate",null);return o.push(l),Promise.all(o).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#h.clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){let{messageHandler:o,loadingTask:l}=this;o.on("GetReader",(o,l)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},l.onPull=()=>{this._fullReader.read().then(function({value:o,done:S}){if(S){l.close();return}(0,_util.assert)(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),l.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{l.error(o)})},l.onCancel=o=>{this._fullReader.cancel(o),l.ready.catch(o=>{if(!this.destroyed)throw o})}}),o.on("ReaderHeadersReady",o=>{let S=new _util.PromiseCapability,E=this._fullReader;return E.headersReady.then(()=>{E.isStreamingSupported&&E.isRangeSupported||(this._lastProgress&&l.onProgress?.(this._lastProgress),E.onProgress=o=>{l.onProgress?.({loaded:o.loaded,total:o.total})}),S.resolve({isStreamingSupported:E.isStreamingSupported,isRangeSupported:E.isRangeSupported,contentLength:E.contentLength})},S.reject),S.promise}),o.on("GetRangeReader",(o,l)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");let S=this._networkStream.getRangeReader(o.begin,o.end);if(!S){l.close();return}l.onPull=()=>{S.read().then(function({value:o,done:S}){if(S){l.close();return}(0,_util.assert)(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),l.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{l.error(o)})},l.onCancel=o=>{S.cancel(o),l.ready.catch(o=>{if(!this.destroyed)throw o})}}),o.on("GetDoc",({pdfInfo:o})=>{this._numPages=o.numPages,this._htmlForXfa=o.htmlForXfa,delete o.htmlForXfa,l._capability.resolve(new PDFDocumentProxy(o,this))}),o.on("DocException",function(o){let S;switch(o.name){case"PasswordException":S=new _util.PasswordException(o.message,o.code);break;case"InvalidPDFException":S=new _util.InvalidPDFException(o.message);break;case"MissingPDFException":S=new _util.MissingPDFException(o.message);break;case"UnexpectedResponseException":S=new _util.UnexpectedResponseException(o.message,o.status);break;case"UnknownErrorException":S=new _util.UnknownErrorException(o.message,o.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}l._capability.reject(S)}),o.on("PasswordRequest",o=>{if(this._passwordCapability=new _util.PromiseCapability,l.onPassword){let S=o=>{o instanceof Error?this._passwordCapability.reject(o):this._passwordCapability.resolve({password:o})};try{l.onPassword(S,o.code)}catch(o){this._passwordCapability.reject(o)}}else this._passwordCapability.reject(new _util.PasswordException(o.message,o.code));return this._passwordCapability.promise}),o.on("DataLoaded",o=>{l.onProgress?.({loaded:o.length,total:o.length}),this.downloadInfoCapability.resolve(o)}),o.on("StartRenderPage",o=>{if(this.destroyed)return;let l=this.#d.get(o.pageIndex);l._startRenderPage(o.transparency,o.cacheKey)}),o.on("commonobj",([l,S,E])=>{if(!(this.destroyed||this.commonObjs.has(l)))switch(S){case"Font":let T=this._params;if("error"in E){let o=E.error;(0,_util.warn)(`Error during font loading: ${o}`),this.commonObjs.resolve(l,o);break}let P=T.pdfBug&&globalThis.FontInspector?.enabled?(o,l)=>globalThis.FontInspector.fontAdded(o,l):null,M=new _font_loader.FontFaceObject(E,{isEvalSupported:T.isEvalSupported,disableFontFace:T.disableFontFace,ignoreErrors:T.ignoreErrors,inspectFont:P});this.fontLoader.bind(M).catch(S=>o.sendWithPromise("FontFallback",{id:l})).finally(()=>{!T.fontExtraProperties&&M.data&&(M.data=null),this.commonObjs.resolve(l,M)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(l,E);break;default:throw Error(`Got unknown common object type ${S}`)}}),o.on("obj",([o,l,S,E])=>{if(this.destroyed)return;let T=this.#d.get(l);if(!T.objs.has(o))switch(S){case"Image":if(T.objs.resolve(o,E),E){let o;if(E.bitmap){let{width:l,height:S}=E;o=l*S*4}else o=E.data?.length||0;o>_util.MAX_IMAGE_SIZE_TO_CACHE&&(T._maybeCleanupAfterRender=!0)}break;case"Pattern":T.objs.resolve(o,E);break;default:throw Error(`Got unknown object type ${S}`)}}),o.on("DocProgress",o=>{this.destroyed||l.onProgress?.({loaded:o.loaded,total:o.total})}),o.on("FetchBuiltInCMap",o=>this.destroyed?Promise.reject(Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(o):Promise.reject(Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),o.on("FetchStandardFontData",o=>this.destroyed?Promise.reject(Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(o):Promise.reject(Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(o){if(!Number.isInteger(o)||o<=0||o>this._numPages)return Promise.reject(Error("Invalid page request."));let l=o-1,S=this.#c.get(l);if(S)return S;let E=this.messageHandler.sendWithPromise("GetPage",{pageIndex:l}).then(o=>{if(this.destroyed)throw Error("Transport destroyed");let S=new PDFPageProxy(l,o,this,this._params.pdfBug);return this.#d.set(l,S),S});return this.#c.set(l,E),E}getPageIndex(o){return"object"!=typeof o||null===o||!Number.isInteger(o.num)||o.num<0||!Number.isInteger(o.gen)||o.gen<0?Promise.reject(Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:o.num,gen:o.gen})}getAnnotations(o,l){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:o,intent:l})}getFieldObjects(){return this.#u("GetFieldObjects")}hasJSActions(){return this.#u("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(o){return"string"!=typeof o?Promise.reject(Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:o})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(o){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:o})}getStructTree(o){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:o})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(o=>new _optional_content_config.OptionalContentConfig(o))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){let o="GetMetadata",l=this.#h.get(o);if(l)return l;let S=this.messageHandler.sendWithPromise(o,null).then(o=>({info:o[0],metadata:o[1]?new _metadata.Metadata(o[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#h.set(o,S),S}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(o=!1){if(!this.destroyed){for(let o of(await this.messageHandler.sendWithPromise("Cleanup",null),this.#d.values())){let l=o.cleanup();if(!l)throw Error(`startCleanup: Page ${o.pageNumber} is currently rendering.`)}this.commonObjs.clear(),o||this.fontLoader.clear(),this.#h.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){let{disableAutoFetch:o,enableXfa:l}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:o,enableXfa:l})}}class PDFObjects{#p=Object.create(null);#g(o){let l=this.#p[o];return l||(this.#p[o]={capability:new _util.PromiseCapability,data:null})}get(o,l=null){if(l){let S=this.#g(o);return S.capability.promise.then(()=>l(S.data)),null}let S=this.#p[o];if(!S?.capability.settled)throw Error(`Requesting object that isn't resolved yet ${o}.`);return S.data}has(o){let l=this.#p[o];return l?.capability.settled||!1}resolve(o,l=null){let S=this.#g(o);S.data=l,S.capability.resolve()}clear(){for(let o in this.#p){let{data:l}=this.#p[o];l?.bitmap?.close()}this.#p=Object.create(null)}}class RenderTask{#f=null;constructor(o){this.#f=o,this.onContinue=null}get promise(){return this.#f.capability.promise}cancel(o=0){this.#f.cancel(null,o)}get separateAnnots(){let{separateAnnots:o}=this.#f.operatorList;if(!o)return!1;let{annotationCanvasMap:l}=this.#f;return o.form||o.canvas&&l?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static #m=new WeakSet;constructor({callback:o,params:l,objs:S,commonObjs:E,annotationCanvasMap:T,operatorList:P,pageIndex:M,canvasFactory:F,filterFactory:O,useRequestAnimationFrame:I=!1,pdfBug:D=!1,pageColors:L=null}){this.callback=o,this.params=l,this.objs=S,this.commonObjs=E,this.annotationCanvasMap=T,this.operatorListIdx=null,this.operatorList=P,this._pageIndex=M,this.canvasFactory=F,this.filterFactory=O,this._pdfBug=D,this.pageColors=L,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===I&&"undefined"!=typeof window,this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=l.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:o=!1,optionalContentConfig:l}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#m.has(this._canvas))throw Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#m.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());let{canvasContext:S,viewport:E,transform:T,background:P}=this.params;this.gfx=new _canvas.CanvasGraphics(S,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:l},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:T,viewport:E,transparency:o,background:P}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(o=null,l=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this._canvas&&InternalRenderTask.#m.delete(this._canvas),this.callback(o||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",l))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),this.running||this._continue()}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){!this.cancelled&&(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&InternalRenderTask.#m.delete(this._canvas),this.callback())))}}let version="3.6.172";exports.version=version;let build="4d3dfe254";exports.build=build},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.PrintAnnotationStorage=l.AnnotationStorage=void 0;var E=S(1),T=S(4),P=S(8);class M{#b=!1;#A=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(o,l){let S=this.#A.get(o);return void 0===S?l:Object.assign(l,S)}getRawValue(o){return this.#A.get(o)}remove(o){if(this.#A.delete(o),0===this.#A.size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(let o of this.#A.values())if(o instanceof T.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(o,l){let S=this.#A.get(o),E=!1;if(void 0!==S)for(let[o,T]of Object.entries(l))S[o]!==T&&(E=!0,S[o]=T);else E=!0,this.#A.set(o,l);E&&this.#v(),l instanceof T.AnnotationEditor&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(l.constructor._type)}has(o){return this.#A.has(o)}getAll(){return this.#A.size>0?(0,E.objectFromMap)(this.#A):null}setAll(o){for(let[l,S]of Object.entries(o))this.setValue(l,S)}get size(){return this.#A.size}#v(){this.#b||(this.#b=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this.#b&&(this.#b=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new F(this)}get serializable(){if(0===this.#A.size)return null;let o=new Map;for(let[l,S]of this.#A){let E=S instanceof T.AnnotationEditor?S.serialize():S;E&&o.set(l,E)}return o}static getHash(o){if(!o)return"";let l=new P.MurmurHash3_64;for(let[S,E]of o)l.update(`${S}:${JSON.stringify(E)}`);return l.hexdigest()}}l.AnnotationStorage=M;class F extends M{#y=null;constructor(o){super(),this.#y=structuredClone(o.serializable)}get print(){(0,E.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#y}}l.PrintAnnotationStorage=F},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.AnnotationEditor=void 0;var E=S(5),T=S(1);class P{#_=this.focusin.bind(this);#S=this.focusout.bind(this);#x=!1;#C=!1;#E=!1;_uiManager=null;#T=P._zIndex++;static _colorManager=new E.ColorManager;static _zIndex=1;constructor(o){this.constructor===P&&(0,T.unreachable)("Cannot initialize AnnotationEditor."),this.parent=o.parent,this.id=o.id,this.width=this.height=null,this.pageIndex=o.parent.pageIndex,this.name=o.name,this.div=null,this._uiManager=o.uiManager;let{rotation:l,rawDims:{pageWidth:S,pageHeight:E,pageX:M,pageY:F}}=this.parent.viewport;this.rotation=l,this.pageRotation=(360+l-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[S,E],this.pageTranslation=[M,F];let[O,I]=this.parentDimensions;this.x=o.x/O,this.y=o.y/I,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,T.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(o){this._uiManager.addCommands(o)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#T}setParent(o){null!==o&&(this.pageIndex=o.pageIndex,this.pageDimensions=o.pageDimensions),this.parent=o}focusin(o){this.#x?this.#x=!1:this.parent.setSelected(this)}focusout(o){if(!this.isAttachedToDOM)return;let l=o.relatedTarget;!l?.closest(`#${this.id}`)&&(o.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(o){let l=this.parent.div.getBoundingClientRect();this.startX=o.clientX-l.x,this.startY=o.clientY-l.y,o.dataTransfer.setData("text/plain",this.id),o.dataTransfer.effectAllowed="move"}setAt(o,l,S,E){let[T,P]=this.parentDimensions;[S,E]=this.screenToPageTranslation(S,E),this.x=(o+S)/T,this.y=(l+E)/P,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(o,l){let[S,E]=this.parentDimensions;[o,l]=this.screenToPageTranslation(o,l),this.x+=o/S,this.y+=l/E,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(o,l){switch(this.parentRotation){case 90:return[l,-o];case 180:return[-o,-l];case 270:return[-l,o];default:return[o,l]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){let{realScale:o}=this._uiManager.viewParameters,[l,S]=this.pageDimensions;return[l*o,S*o]}setDims(o,l){let[S,E]=this.parentDimensions;this.div.style.width=`${100*o/S}%`,this.div.style.height=`${100*l/E}%`}fixDims(){let{style:o}=this.div,{height:l,width:S}=o,E=S.endsWith("%"),T=l.endsWith("%");if(E&&T)return;let[P,M]=this.parentDimensions;E||(o.width=`${100*parseFloat(S)/P}%`),T||(o.height=`${100*parseFloat(l)/M}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#_),this.div.addEventListener("focusout",this.#S);let[o,l]=this.getInitialTranslation();return this.translate(o,l),(0,E.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(o){let{isMac:l}=T.FeatureTest.platform;if(0!==o.button||o.ctrlKey&&l){o.preventDefault();return}o.ctrlKey&&!l||o.shiftKey||o.metaKey&&l?this.parent.toggleSelected(this):this.parent.setSelected(this),this.#x=!0}getRect(o,l){let S=this.parentScale,[E,T]=this.pageDimensions,[P,M]=this.pageTranslation,F=o/S,O=l/S,I=this.x*E,D=this.y*T,L=this.width*E,N=this.height*T;switch(this.rotation){case 0:return[I+F+P,T-D-O-N+M,I+F+L+P,T-D-O+M];case 90:return[I+O+P,T-D+F+M,I+O+N+P,T-D+F+L+M];case 180:return[I-F-L+P,T-D+O+M,I-F+P,T-D+O+N+M];case 270:return[I-O-N+P,T-D-F-L+M,I-O+P,T-D-F+M];default:throw Error("Invalid rotation")}}getRectInCurrentCoords(o,l){let[S,E,T,P]=o,M=T-S,F=P-E;switch(this.rotation){case 0:return[S,l-P,M,F];case 90:return[S,l-E,F,M];case 180:return[T,l-E,M,F];case 270:return[T,l-P,F,M];default:throw Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#E=!0}disableEditMode(){this.#E=!1}isInEditMode(){return this.#E}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#_)}serialize(){(0,T.unreachable)("An editor must be serializable")}static deserialize(o,l,S){let E=new this.prototype.constructor({parent:l,id:l.getNextId(),uiManager:S});E.rotation=o.rotation;let[T,P]=E.pageDimensions,[M,F,O,I]=E.getRectInCurrentCoords(o.rect,P);return E.x=M/T,E.y=F/P,E.width=O/T,E.height=I/P,E}remove(){this.div.removeEventListener("focusin",this.#_),this.div.removeEventListener("focusout",this.#S),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){this.div?.classList.add("selectedEditor")}unselect(){this.div?.classList.remove("selectedEditor")}updateParams(o,l){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return this.#C}set isEditing(o){this.#C=o,o?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}l.AnnotationEditor=P},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.KeyboardManager=l.CommandManager=l.ColorManager=l.AnnotationEditorUIManager=void 0,l.bindEvents=P,l.opacityToHex=M;var E=S(1),T=S(6);function P(o,l,S){for(let E of S)l.addEventListener(E,o[E].bind(o))}function M(o){return Math.round(Math.min(255,Math.max(1,255*o))).toString(16).padStart(2,"0")}class F{#P=0;getId(){return`${E.AnnotationEditorPrefix}${this.#P++}`}}class O{#M=[];#k=!1;#w;#R=-1;constructor(o=128){this.#w=o}add({cmd:o,undo:l,mustExec:S,type:E=NaN,overwriteIfSameType:T=!1,keepUndo:P=!1}){if(S&&o(),this.#k)return;let M={cmd:o,undo:l,type:E};if(-1===this.#R){this.#M.length>0&&(this.#M.length=0),this.#R=0,this.#M.push(M);return}if(T&&this.#M[this.#R].type===E){P&&(M.undo=this.#M[this.#R].undo),this.#M[this.#R]=M;return}let F=this.#R+1;F===this.#w?this.#M.splice(0,1):(this.#R=F,F<this.#M.length&&this.#M.splice(F)),this.#M.push(M)}undo(){-1!==this.#R&&(this.#k=!0,this.#M[this.#R].undo(),this.#k=!1,this.#R-=1)}redo(){this.#R<this.#M.length-1&&(this.#R+=1,this.#k=!0,this.#M[this.#R].cmd(),this.#k=!1)}hasSomethingToUndo(){return -1!==this.#R}hasSomethingToRedo(){return this.#R<this.#M.length-1}destroy(){this.#M=null}}l.CommandManager=O;class I{constructor(o){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;let{isMac:l}=E.FeatureTest.platform;for(let[S,E]of o)for(let o of S){let S=o.startsWith("mac+");l&&S?(this.callbacks.set(o.slice(4),E),this.allKeys.add(o.split("+").at(-1))):l||S||(this.callbacks.set(o,E),this.allKeys.add(o.split("+").at(-1)))}}#F(o){o.altKey&&this.buffer.push("alt"),o.ctrlKey&&this.buffer.push("ctrl"),o.metaKey&&this.buffer.push("meta"),o.shiftKey&&this.buffer.push("shift"),this.buffer.push(o.key);let l=this.buffer.join("+");return this.buffer.length=0,l}exec(o,l){if(!this.allKeys.has(l.key))return;let S=this.callbacks.get(this.#F(l));S&&(S.bind(o)(),l.stopPropagation(),l.preventDefault())}}l.KeyboardManager=I;class D{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){let o=new Map([["CanvasText",null],["Canvas",null]]);return(0,T.getColorValues)(o),(0,E.shadow)(this,"_colors",o)}convert(o){let l=(0,T.getRGB)(o);if(!window.matchMedia("(forced-colors: active)").matches)return l;for(let[o,S]of this._colors)if(S.every((o,S)=>o===l[S]))return D._colorsMapping.get(o);return l}getHexCode(o){let l=this._colors.get(o);return l?E.Util.makeHexColor(...l):o}}l.ColorManager=D;class L{#O=null;#I=new Map;#D=new Map;#L=null;#N=new O;#j=0;#B=null;#U=new Set;#G=null;#H=new F;#q=!1;#W=E.AnnotationEditorType.NONE;#z=new Set;#V=this.copy.bind(this);#$=this.cut.bind(this);#X=this.paste.bind(this);#K=this.keydown.bind(this);#Y=this.onEditingAction.bind(this);#J=this.onPageChanging.bind(this);#Q=this.onScaleChanging.bind(this);#Z=this.onRotationChanging.bind(this);#tt={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#te=null;static _keyboardManager=new I([[["ctrl+a","mac+meta+a"],L.prototype.selectAll],[["ctrl+z","mac+meta+z"],L.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],L.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],L.prototype.delete],[["Escape","mac+Escape"],L.prototype.unselectAll]]);constructor(o,l,S){this.#te=o,this.#G=l,this.#G._on("editingaction",this.#Y),this.#G._on("pagechanging",this.#J),this.#G._on("scalechanging",this.#Q),this.#G._on("rotationchanging",this.#Z),this.#L=S,this.viewParameters={realScale:T.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){for(let o of(this.#ti(),this.#G._off("editingaction",this.#Y),this.#G._off("pagechanging",this.#J),this.#G._off("scalechanging",this.#Q),this.#G._off("rotationchanging",this.#Z),this.#D.values()))o.destroy();this.#D.clear(),this.#I.clear(),this.#U.clear(),this.#O=null,this.#z.clear(),this.#N.destroy()}onPageChanging({pageNumber:o}){this.#j=o-1}focusMainContainer(){this.#te.focus()}addShouldRescale(o){this.#U.add(o)}removeShouldRescale(o){this.#U.delete(o)}onScaleChanging({scale:o}){for(let l of(this.commitOrRemove(),this.viewParameters.realScale=o*T.PixelsPerInch.PDF_TO_CSS_UNITS,this.#U))l.onScaleChanging()}onRotationChanging({pagesRotation:o}){this.commitOrRemove(),this.viewParameters.rotation=o}addToAnnotationStorage(o){o.isEmpty()||!this.#L||this.#L.has(o.id)||this.#L.setValue(o.id,o)}#ts(){this.#te.addEventListener("keydown",this.#K)}#ti(){this.#te.removeEventListener("keydown",this.#K)}#tr(){document.addEventListener("copy",this.#V),document.addEventListener("cut",this.#$),document.addEventListener("paste",this.#X)}#ta(){document.removeEventListener("copy",this.#V),document.removeEventListener("cut",this.#$),document.removeEventListener("paste",this.#X)}copy(o){if(o.preventDefault(),this.#O&&this.#O.commitOrRemove(),!this.hasSelection)return;let l=[];for(let o of this.#z)o.isEmpty()||l.push(o.serialize());0!==l.length&&o.clipboardData.setData("application/pdfjs",JSON.stringify(l))}cut(o){this.copy(o),this.delete()}paste(o){o.preventDefault();let l=o.clipboardData.getData("application/pdfjs");if(!l)return;try{l=JSON.parse(l)}catch(o){(0,E.warn)(`paste: "${o.message}".`);return}if(!Array.isArray(l))return;this.unselectAll();let S=this.#D.get(this.#j);try{let o=[];for(let E of l){let l=S.deserialize(E);if(!l)return;o.push(l)}let E=()=>{for(let l of o)this.#tn(l);this.#to(o)},T=()=>{for(let l of o)l.remove()};this.addCommands({cmd:E,undo:T,mustExec:!0})}catch(o){(0,E.warn)(`paste: "${o.message}".`)}}keydown(o){this.getActive()?.shouldGetKeyboardEvents()||L._keyboardManager.exec(this,o)}onEditingAction(o){["undo","redo","delete","selectAll"].includes(o.name)&&this[o.name]()}#tl(o){let l=Object.entries(o).some(([o,l])=>this.#tt[o]!==l);l&&this.#G.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#tt,o)})}#th(o){this.#G.dispatch("annotationeditorparamschanged",{source:this,details:o})}setEditingState(o){o?(this.#ts(),this.#tr(),this.#tl({isEditing:this.#W!==E.AnnotationEditorType.NONE,isEmpty:this.#td(),hasSomethingToUndo:this.#N.hasSomethingToUndo(),hasSomethingToRedo:this.#N.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ti(),this.#ta(),this.#tl({isEditing:!1}))}registerEditorTypes(o){if(!this.#B)for(let l of(this.#B=o,this.#B))this.#th(l.defaultPropertiesToUpdate)}getId(){return this.#H.getId()}get currentLayer(){return this.#D.get(this.#j)}get currentPageIndex(){return this.#j}addLayer(o){this.#D.set(o.pageIndex,o),this.#q?o.enable():o.disable()}removeLayer(o){this.#D.delete(o.pageIndex)}updateMode(o){if(this.#W=o,o===E.AnnotationEditorType.NONE)this.setEditingState(!1),this.#tc();else for(let l of(this.setEditingState(!0),this.#tu(),this.#D.values()))l.updateMode(o)}updateToolbar(o){o!==this.#W&&this.#G.dispatch("switchannotationeditormode",{source:this,mode:o})}updateParams(o,l){if(this.#B){for(let S of this.#z)S.updateParams(o,l);for(let S of this.#B)S.updateDefaultParams(o,l)}}#tu(){if(!this.#q)for(let o of(this.#q=!0,this.#D.values()))o.enable()}#tc(){if(this.unselectAll(),this.#q)for(let o of(this.#q=!1,this.#D.values()))o.disable()}getEditors(o){let l=[];for(let S of this.#I.values())S.pageIndex===o&&l.push(S);return l}getEditor(o){return this.#I.get(o)}addEditor(o){this.#I.set(o.id,o)}removeEditor(o){this.#I.delete(o.id),this.unselect(o),this.#L?.remove(o.id)}#tn(o){let l=this.#D.get(o.pageIndex);l?l.addOrRebuild(o):this.addEditor(o)}setActiveEditor(o){this.#O!==o&&(this.#O=o,o&&this.#th(o.propertiesToUpdate))}toggleSelected(o){if(this.#z.has(o)){this.#z.delete(o),o.unselect(),this.#tl({hasSelectedEditor:this.hasSelection});return}this.#z.add(o),o.select(),this.#th(o.propertiesToUpdate),this.#tl({hasSelectedEditor:!0})}setSelected(o){for(let l of this.#z)l!==o&&l.unselect();this.#z.clear(),this.#z.add(o),o.select(),this.#th(o.propertiesToUpdate),this.#tl({hasSelectedEditor:!0})}isSelected(o){return this.#z.has(o)}unselect(o){o.unselect(),this.#z.delete(o),this.#tl({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#z.size}undo(){this.#N.undo(),this.#tl({hasSomethingToUndo:this.#N.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#td()})}redo(){this.#N.redo(),this.#tl({hasSomethingToUndo:!0,hasSomethingToRedo:this.#N.hasSomethingToRedo(),isEmpty:this.#td()})}addCommands(o){this.#N.add(o),this.#tl({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#td()})}#td(){if(0===this.#I.size)return!0;if(1===this.#I.size)for(let o of this.#I.values())return o.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;let o=[...this.#z],l=()=>{for(let l of o)l.remove()},S=()=>{for(let l of o)this.#tn(l)};this.addCommands({cmd:l,undo:S,mustExec:!0})}commitOrRemove(){this.#O?.commitOrRemove()}#to(o){for(let l of(this.#z.clear(),o))l.isEmpty()||(this.#z.add(l),l.select());this.#tl({hasSelectedEditor:!0})}selectAll(){for(let o of this.#z)o.commit();this.#to(this.#I.values())}unselectAll(){if(this.#O){this.#O.commitOrRemove();return}if(0!==this.#z.size){for(let o of this.#z)o.unselect();this.#z.clear(),this.#tl({hasSelectedEditor:!1})}}isActive(o){return this.#O===o}getActive(){return this.#O}getMode(){return this.#W}}l.AnnotationEditorUIManager=L},(o,l,S)=>{let E;Object.defineProperty(l,"__esModule",{value:!0}),l.StatTimer=l.RenderingCancelledException=l.PixelsPerInch=l.PageViewport=l.PDFDateString=l.DOMStandardFontDataFactory=l.DOMSVGFactory=l.DOMFilterFactory=l.DOMCanvasFactory=l.DOMCMapReaderFactory=l.AnnotationPrefix=void 0,l.deprecated=tt,l.getColorValues=tr,l.getCurrentTransform=ta,l.getCurrentTransformInverse=tn,l.getFilenameFromUrl=K,l.getPdfFilenameFromUrl=Y,l.getRGB=ts,l.getXfaPageViewport=ti,l.isDataScheme=V,l.isPdfFile=$,l.isValidFetchUrl=Q,l.loadScript=Z,l.setLayerDimensions=to;var T=S(7),P=S(1);let M="http://www.w3.org/2000/svg",F="pdfjs_internal_id_";l.AnnotationPrefix=F;class O{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}l.PixelsPerInch=O;class I extends T.BaseFilterFactory{#tp;#tg;#e;#tf;#tm;#tb;#tA;#P=0;constructor({docId:o,ownerDocument:l=globalThis.document}={}){super(),this.#e=o,this.#tf=l}get #tv(){return this.#tp||=new Map}get #ty(){if(!this.#tg){let o=this.#tf.createElement("div"),{style:l}=o;l.visibility="hidden",l.contain="strict",l.width=l.height=0,l.position="absolute",l.top=l.left=0,l.zIndex=-1;let S=this.#tf.createElementNS(M,"svg");S.setAttribute("width",0),S.setAttribute("height",0),this.#tg=this.#tf.createElementNS(M,"defs"),o.append(S),S.append(this.#tg),this.#tf.body.append(o)}return this.#tg}#t_(o,l,S){let E=this.#tf.createElementNS(M,l);E.setAttribute("type","discrete"),E.setAttribute("tableValues",S),o.append(E)}addFilter(o){let l,S,E,T;if(!o)return"none";let P=this.#tv.get(o);if(P)return P;if(1===o.length){let P=o[0],M=Array(256);for(let o=0;o<256;o++)M[o]=P[o]/255;T=l=S=E=M.join(",")}else{let[P,M,F]=o,O=Array(256),I=Array(256),D=Array(256);for(let o=0;o<256;o++)O[o]=P[o]/255,I[o]=M[o]/255,D[o]=F[o]/255;T=`${l=O.join(",")}${S=I.join(",")}${E=D.join(",")}`}if(P=this.#tv.get(T))return this.#tv.set(o,P),P;let F=`g_${this.#e}_transfer_map_${this.#P++}`,O=`url(#${F})`;this.#tv.set(o,O),this.#tv.set(T,O);let I=this.#tf.createElementNS(M,"filter",M);I.setAttribute("id",F),I.setAttribute("color-interpolation-filters","sRGB");let D=this.#tf.createElementNS(M,"feComponentTransfer");return I.append(D),this.#t_(D,"feFuncR",l),this.#t_(D,"feFuncG",S),this.#t_(D,"feFuncB",E),this.#ty.append(I),O}addHCMFilter(o,l){let S=`${o}-${l}`;if(this.#tb===S||(this.#tb=S,this.#tA="none",this.#tm?.remove(),!o||!l))return this.#tA;this.#ty.style.color=o,o=getComputedStyle(this.#ty).getPropertyValue("color");let E=ts(o);o=P.Util.makeHexColor(...E),this.#ty.style.color=l,l=getComputedStyle(this.#ty).getPropertyValue("color");let T=ts(l);if(l=P.Util.makeHexColor(...T),this.#ty.style.color="","#000000"===o&&"#ffffff"===l||o===l)return this.#tA;let F=Array(256);for(let o=0;o<=255;o++){let l=o/255;F[o]=l<=.03928?l/12.92:((l+.055)/1.055)**2.4}let O=F.join(","),I=`g_${this.#e}_hcm_filter`,D=this.#tm=this.#tf.createElementNS(M,"filter",M);D.setAttribute("id",I),D.setAttribute("color-interpolation-filters","sRGB");let L=this.#tf.createElementNS(M,"feComponentTransfer");D.append(L),this.#t_(L,"feFuncR",O),this.#t_(L,"feFuncG",O),this.#t_(L,"feFuncB",O);let N=this.#tf.createElementNS(M,"feColorMatrix");N.setAttribute("type","matrix"),N.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),D.append(N),L=this.#tf.createElementNS(M,"feComponentTransfer"),D.append(L);let U=(o,l)=>{let S=E[o]/255,P=T[o]/255,M=Array(l+1);for(let o=0;o<=l;o++)M[o]=S+o/l*(P-S);return M.join(",")};return this.#t_(L,"feFuncR",U(0,5)),this.#t_(L,"feFuncG",U(1,5)),this.#t_(L,"feFuncB",U(2,5)),this.#ty.append(D),this.#tA=`url(#${I})`,this.#tA}destroy(o=!1){o&&this.#tA||(this.#tg&&(this.#tg.parentNode.parentNode.remove(),this.#tg=null),this.#tp&&(this.#tp.clear(),this.#tp=null),this.#P=0)}}l.DOMFilterFactory=I;class D extends T.BaseCanvasFactory{constructor({ownerDocument:o=globalThis.document}={}){super(),this._document=o}_createCanvas(o,l){let S=this._document.createElement("canvas");return S.width=o,S.height=l,S}}async function L(o,l=!1){if(Q(o,document.baseURI)){let S=await fetch(o);if(!S.ok)throw Error(S.statusText);return l?new Uint8Array(await S.arrayBuffer()):(0,P.stringToBytes)(await S.text())}return new Promise((S,E)=>{let T=new XMLHttpRequest;T.open("GET",o,!0),l&&(T.responseType="arraybuffer"),T.onreadystatechange=()=>{if(T.readyState===XMLHttpRequest.DONE){if(200===T.status||0===T.status){let o;if(l&&T.response?o=new Uint8Array(T.response):!l&&T.responseText&&(o=(0,P.stringToBytes)(T.responseText)),o){S(o);return}}E(Error(T.statusText))}},T.send(null)})}l.DOMCanvasFactory=D;class N extends T.BaseCMapReaderFactory{_fetchData(o,l){return L(o,this.isCompressed).then(o=>({cMapData:o,compressionType:l}))}}l.DOMCMapReaderFactory=N;class U extends T.BaseStandardFontDataFactory{_fetchData(o){return L(o,!0)}}l.DOMStandardFontDataFactory=U;class H extends T.BaseSVGFactory{_createSVG(o){return document.createElementNS(M,o)}}l.DOMSVGFactory=H;class W{constructor({viewBox:o,scale:l,rotation:S,offsetX:E=0,offsetY:T=0,dontFlip:P=!1}){let M,F,O,I,D,L,N,U;this.viewBox=o,this.scale=l,this.rotation=S,this.offsetX=E,this.offsetY=T;let H=(o[2]+o[0])/2,W=(o[3]+o[1])/2;switch((S%=360)<0&&(S+=360),S){case 180:M=-1,F=0,O=0,I=1;break;case 90:M=0,F=1,O=1,I=0;break;case 270:M=0,F=-1,O=-1,I=0;break;case 0:M=1,F=0,O=0,I=-1;break;default:throw Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}P&&(O=-O,I=-I),0===M?(D=Math.abs(W-o[1])*l+E,L=Math.abs(H-o[0])*l+T,N=(o[3]-o[1])*l,U=(o[2]-o[0])*l):(D=Math.abs(H-o[0])*l+E,L=Math.abs(W-o[1])*l+T,N=(o[2]-o[0])*l,U=(o[3]-o[1])*l),this.transform=[M*l,F*l,O*l,I*l,D-M*l*H-O*l*W,L-F*l*H-I*l*W],this.width=N,this.height=U}get rawDims(){let{viewBox:o}=this;return(0,P.shadow)(this,"rawDims",{pageWidth:o[2]-o[0],pageHeight:o[3]-o[1],pageX:o[0],pageY:o[1]})}clone({scale:o=this.scale,rotation:l=this.rotation,offsetX:S=this.offsetX,offsetY:E=this.offsetY,dontFlip:T=!1}={}){return new W({viewBox:this.viewBox.slice(),scale:o,rotation:l,offsetX:S,offsetY:E,dontFlip:T})}convertToViewportPoint(o,l){return P.Util.applyTransform([o,l],this.transform)}convertToViewportRectangle(o){let l=P.Util.applyTransform([o[0],o[1]],this.transform),S=P.Util.applyTransform([o[2],o[3]],this.transform);return[l[0],l[1],S[0],S[1]]}convertToPdfPoint(o,l){return P.Util.applyInverseTransform([o,l],this.transform)}}l.PageViewport=W;class z extends P.BaseException{constructor(o,l,S=0){super(o,"RenderingCancelledException"),this.type=l,this.extraDelay=S}}function V(o){let l=o.length,S=0;for(;S<l&&""===o[S].trim();)S++;return"data:"===o.substring(S,S+5).toLowerCase()}function $(o){return"string"==typeof o&&/\.pdf$/i.test(o)}function K(o,l=!1){return l||([o]=o.split(/[#?]/,1)),o.substring(o.lastIndexOf("/")+1)}function Y(o,l="document.pdf"){if("string"!=typeof o)return l;if(V(o))return(0,P.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),l;let S=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,E=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,T=S.exec(o),M=E.exec(T[1])||E.exec(T[2])||E.exec(T[3]);if(M&&(M=M[0]).includes("%"))try{M=E.exec(decodeURIComponent(M))[0]}catch(o){}return M||l}l.RenderingCancelledException=z;class J{started=Object.create(null);times=[];time(o){o in this.started&&(0,P.warn)(`Timer is already running for ${o}`),this.started[o]=Date.now()}timeEnd(o){o in this.started||(0,P.warn)(`Timer has not been started for ${o}`),this.times.push({name:o,start:this.started[o],end:Date.now()}),delete this.started[o]}toString(){let o=[],l=0;for(let{name:o}of this.times)l=Math.max(o.length,l);for(let{name:S,start:E,end:T}of this.times)o.push(`${S.padEnd(l)} ${T-E}ms
`);return o.join("")}}function Q(o,l){try{let{protocol:S}=l?new URL(o,l):new URL(o);return"http:"===S||"https:"===S}catch(o){return!1}}function Z(o,l=!1){return new Promise((S,E)=>{let T=document.createElement("script");T.src=o,T.onload=function(o){l&&T.remove(),S(o)},T.onerror=function(){E(Error(`Cannot load script at: ${T.src}`))},(document.head||document.documentElement).append(T)})}function tt(o){console.log("Deprecated API usage: "+o)}l.StatTimer=J;class te{static toDateObject(o){if(!o||"string"!=typeof o)return null;E||(E=RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));let l=E.exec(o);if(!l)return null;let S=parseInt(l[1],10),T=parseInt(l[2],10);T=T>=1&&T<=12?T-1:0;let P=parseInt(l[3],10);P=P>=1&&P<=31?P:1;let M=parseInt(l[4],10);M=M>=0&&M<=23?M:0;let F=parseInt(l[5],10);F=F>=0&&F<=59?F:0;let O=parseInt(l[6],10);O=O>=0&&O<=59?O:0;let I=l[7]||"Z",D=parseInt(l[8],10);D=D>=0&&D<=23?D:0;let L=parseInt(l[9],10)||0;return L=L>=0&&L<=59?L:0,"-"===I?(M+=D,F+=L):"+"===I&&(M-=D,F-=L),new Date(Date.UTC(S,T,P,M,F,O))}}function ti(o,{scale:l=1,rotation:S=0}){let{width:E,height:T}=o.attributes.style,P=[0,0,parseInt(E),parseInt(T)];return new W({viewBox:P,scale:l,rotation:S})}function ts(o){if(o.startsWith("#")){let l=parseInt(o.slice(1),16);return[(16711680&l)>>16,(65280&l)>>8,255&l]}return o.startsWith("rgb(")?o.slice(4,-1).split(",").map(o=>parseInt(o)):o.startsWith("rgba(")?o.slice(5,-1).split(",").map(o=>parseInt(o)).slice(0,3):((0,P.warn)(`Not a valid color format: "${o}"`),[0,0,0])}function tr(o){let l=document.createElement("span");for(let S of(l.style.visibility="hidden",document.body.append(l),o.keys())){l.style.color=S;let E=window.getComputedStyle(l).color;o.set(S,ts(E))}l.remove()}function ta(o){let{a:l,b:S,c:E,d:T,e:P,f:M}=o.getTransform();return[l,S,E,T,P,M]}function tn(o){let{a:l,b:S,c:E,d:T,e:P,f:M}=o.getTransform().invertSelf();return[l,S,E,T,P,M]}function to(o,l,S=!1,E=!0){if(l instanceof W){let{pageWidth:E,pageHeight:T}=l.rawDims,{style:P}=o,M=`calc(var(--scale-factor) * ${E}px)`,F=`calc(var(--scale-factor) * ${T}px)`;S&&l.rotation%180!=0?(P.width=F,P.height=M):(P.width=M,P.height=F)}E&&o.setAttribute("data-main-rotation",l.rotation)}l.PDFDateString=te},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.BaseStandardFontDataFactory=l.BaseSVGFactory=l.BaseFilterFactory=l.BaseCanvasFactory=l.BaseCMapReaderFactory=void 0;var E=S(1);class T{constructor(){this.constructor===T&&(0,E.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(o){return"none"}addHCMFilter(o,l){return"none"}destroy(o=!1){}}l.BaseFilterFactory=T;class P{constructor(){this.constructor===P&&(0,E.unreachable)("Cannot initialize BaseCanvasFactory.")}create(o,l){if(o<=0||l<=0)throw Error("Invalid canvas size");let S=this._createCanvas(o,l);return{canvas:S,context:S.getContext("2d")}}reset(o,l,S){if(!o.canvas)throw Error("Canvas is not specified");if(l<=0||S<=0)throw Error("Invalid canvas size");o.canvas.width=l,o.canvas.height=S}destroy(o){if(!o.canvas)throw Error("Canvas is not specified");o.canvas.width=0,o.canvas.height=0,o.canvas=null,o.context=null}_createCanvas(o,l){(0,E.unreachable)("Abstract method `_createCanvas` called.")}}l.BaseCanvasFactory=P;class M{constructor({baseUrl:o=null,isCompressed:l=!0}){this.constructor===M&&(0,E.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=o,this.isCompressed=l}async fetch({name:o}){if(!this.baseUrl)throw Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!o)throw Error("CMap name must be specified.");let l=this.baseUrl+o+(this.isCompressed?".bcmap":""),S=this.isCompressed?E.CMapCompressionType.BINARY:E.CMapCompressionType.NONE;return this._fetchData(l,S).catch(o=>{throw Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${l}`)})}_fetchData(o,l){(0,E.unreachable)("Abstract method `_fetchData` called.")}}l.BaseCMapReaderFactory=M;class F{constructor({baseUrl:o=null}){this.constructor===F&&(0,E.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=o}async fetch({filename:o}){if(!this.baseUrl)throw Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!o)throw Error("Font filename must be specified.");let l=`${this.baseUrl}${o}`;return this._fetchData(l).catch(o=>{throw Error(`Unable to load font data at: ${l}`)})}_fetchData(o){(0,E.unreachable)("Abstract method `_fetchData` called.")}}l.BaseStandardFontDataFactory=F;class O{constructor(){this.constructor===O&&(0,E.unreachable)("Cannot initialize BaseSVGFactory.")}create(o,l,S=!1){if(o<=0||l<=0)throw Error("Invalid SVG dimensions");let E=this._createSVG("svg:svg");return E.setAttribute("version","1.1"),S||(E.setAttribute("width",`${o}px`),E.setAttribute("height",`${l}px`)),E.setAttribute("preserveAspectRatio","none"),E.setAttribute("viewBox",`0 0 ${o} ${l}`),E}createElement(o){if("string"!=typeof o)throw Error("Invalid SVG element type");return this._createSVG(o)}_createSVG(o){(0,E.unreachable)("Abstract method `_createSVG` called.")}}l.BaseSVGFactory=O},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.MurmurHash3_64=void 0;var E=S(1);let T=3285377520,P=4294901760,M=65535;class F{constructor(o){this.h1=o?4294967295&o:T,this.h2=o?4294967295&o:T}update(o){let l,S;if("string"==typeof o){l=new Uint8Array(2*o.length),S=0;for(let E=0,T=o.length;E<T;E++){let T=o.charCodeAt(E);T<=255?l[S++]=T:(l[S++]=T>>>8,l[S++]=255&T)}}else if((0,E.isArrayBuffer)(o))S=(l=o.slice()).byteLength;else throw Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");let T=S>>2,F=S-4*T,O=new Uint32Array(l.buffer,0,T),I=0,D=0,L=this.h1,N=this.h2,U=3432918353,H=461845907,W=U&M,z=H&M;for(let o=0;o<T;o++)1&o?(L^=I=(I=(I=(I=O[o])*U&P|I*W&M)<<15|I>>>17)*H&P|I*z&M,L=5*(L=L<<13|L>>>19)+3864292196):(N^=D=(D=(D=(D=O[o])*U&P|D*W&M)<<15|D>>>17)*H&P|D*z&M,N=5*(N=N<<13|N>>>19)+3864292196);switch(I=0,F){case 3:I^=l[4*T+2]<<16;case 2:I^=l[4*T+1]<<8;case 1:I^=l[4*T],I=(I=(I=I*U&P|I*W&M)<<15|I>>>17)*H&P|I*z&M,1&T?L^=I:N^=I}this.h1=L,this.h2=N}hexdigest(){let o=this.h1,l=this.h2;return o^=l>>>1,o=3981806797*o&P|36045*o&M,l=4283543511*l&P|((l<<16|o>>>16)*2950163797&P)>>>16,o^=l>>>1,o=444984403*o&P|60499*o&M,l=3301882366*l&P|((l<<16|o>>>16)*3120437893&P)>>>16,((o^=l>>>1)>>>0).toString(16).padStart(8,"0")+(l>>>0).toString(16).padStart(8,"0")}}l.MurmurHash3_64=F},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.FontLoader=l.FontFaceObject=void 0;var E=S(1),T=S(10);class P{constructor({ownerDocument:o=globalThis.document,styleElement:l=null}){this._document=o,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(o){this.nativeFontFaces.push(o),this._document.fonts.add(o)}insertRule(o){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));let l=this.styleElement.sheet;l.insertRule(o,l.cssRules.length)}clear(){for(let o of this.nativeFontFaces)this._document.fonts.delete(o);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(o){if(o.attached||o.missingFile)return;if(o.attached=!0,this.isFontLoadingAPISupported){let l=o.createNativeFontFace();if(l){this.addNativeFontFace(l);try{await l.loaded}catch(S){throw(0,E.warn)(`Failed to load font '${l.family}': '${S}'.`),o.disableFontFace=!0,S}}return}let l=o.createFontFaceRule();if(l){if(this.insertRule(l),this.isSyncFontLoadingSupported)return;await new Promise(l=>{let S=this._queueLoadingCallback(l);this._prepareFontLoadEvent(o,S)})}}get isFontLoadingAPISupported(){let o=!!this._document?.fonts;return(0,E.shadow)(this,"isFontLoadingAPISupported",o)}get isSyncFontLoadingSupported(){let o=!1;return T.isNodeJS?o=!0:"undefined"!=typeof navigator&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent)&&(o=!0),(0,E.shadow)(this,"isSyncFontLoadingSupported",o)}_queueLoadingCallback(o){function l(){for((0,E.assert)(!T.done,"completeRequest() cannot be called twice."),T.done=!0;S.length>0&&S[0].done;){let o=S.shift();setTimeout(o.callback,0)}}let{loadingRequests:S}=this,T={done:!1,complete:l,callback:o};return S.push(T),T}get _loadTestFont(){let o=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,E.shadow)(this,"_loadTestFont",o)}_prepareFontLoadEvent(o,l){let S,T;function P(o,l){return o.charCodeAt(l)<<24|o.charCodeAt(l+1)<<16|o.charCodeAt(l+2)<<8|255&o.charCodeAt(l+3)}function M(o,l,S,E){let T=o.substring(0,l),P=o.substring(l+S);return T+E+P}let F=this._document.createElement("canvas");F.width=1,F.height=1;let O=F.getContext("2d"),I=0;function D(o,l){if(++I>30){(0,E.warn)("Load test font never loaded."),l();return}O.font="30px "+o,O.fillText(".",0,20);let S=O.getImageData(0,0,1,1);if(S.data[3]>0){l();return}setTimeout(D.bind(null,o,l))}let L=`lt${Date.now()}${this.loadTestFontId++}`,N=this._loadTestFont,U=976;N=M(N,U,L.length,L);let H=16,W=1482184792,z=P(N,H);for(S=0,T=L.length-3;S<T;S+=4)z=z-W+P(L,S)|0;S<L.length&&(z=z-W+P(L+"XXX",S)|0),N=M(N,H,4,(0,E.string32)(z));let V=`url(data:font/opentype;base64,${btoa(N)});`,$=`@font-face {font-family:"${L}";src:${V}}`;this.insertRule($);let K=this._document.createElement("div");for(let l of(K.style.visibility="hidden",K.style.width=K.style.height="10px",K.style.position="absolute",K.style.top=K.style.left="0px",[o.loadedName,L])){let o=this._document.createElement("span");o.textContent="Hi",o.style.fontFamily=l,K.append(o)}this._document.body.append(K),D(L,()=>{K.remove(),l.complete()})}}l.FontLoader=P;class M{constructor(o,{isEvalSupported:l=!0,disableFontFace:S=!1,ignoreErrors:E=!1,inspectFont:T=null}){for(let l in this.compiledGlyphs=Object.create(null),o)this[l]=o[l];this.isEvalSupported=!1!==l,this.disableFontFace=!0===S,this.ignoreErrors=!0===E,this._inspectFont=T}createNativeFontFace(){let o;if(!this.data||this.disableFontFace)return null;if(this.cssFontInfo){let l={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(l.style=`oblique ${this.cssFontInfo.italicAngle}deg`),o=new FontFace(this.cssFontInfo.fontFamily,this.data,l)}else o=new FontFace(this.loadedName,this.data,{});return this._inspectFont?.(this),o}createFontFaceRule(){let o;if(!this.data||this.disableFontFace)return null;let l=(0,E.bytesToString)(this.data),S=`url(data:${this.mimetype};base64,${btoa(l)});`;if(this.cssFontInfo){let l=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(l+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),o=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${l}src:${S}}`}else o=`@font-face {font-family:"${this.loadedName}";src:${S}}`;return this._inspectFont?.(this,S),o}getPathGenerator(o,l){let S;if(void 0!==this.compiledGlyphs[l])return this.compiledGlyphs[l];try{S=o.get(this.loadedName+"_path_"+l)}catch(o){if(!this.ignoreErrors)throw o;return(0,E.warn)(`getPathGenerator - ignoring character: "${o}".`),this.compiledGlyphs[l]=function(o,l){}}if(this.isEvalSupported&&E.FeatureTest.isEvalSupported){let o=[];for(let l of S){let S=void 0!==l.args?l.args.join(","):"";o.push("c.",l.cmd,"(",S,");\n")}return this.compiledGlyphs[l]=Function("c","size",o.join(""))}return this.compiledGlyphs[l]=function(o,l){for(let E of S)"scale"===E.cmd&&(E.args=[l,-l]),o[E.cmd].apply(o,E.args)}}}l.FontFaceObject=M},(o,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.isNodeJS=void 0;let S="object"==typeof process&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&"browser"!==process.type);l.isNodeJS=S},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.CanvasGraphics=void 0;var E=S(1),T=S(6),P=S(12),M=S(13),F=S(10);let O=16,I=100,D=4096,L=15,N=10,U=1e3,H=16;function W(o,l){if(o._removeMirroring)throw Error("Context is already forwarding operations.");o.__originalSave=o.save,o.__originalRestore=o.restore,o.__originalRotate=o.rotate,o.__originalScale=o.scale,o.__originalTranslate=o.translate,o.__originalTransform=o.transform,o.__originalSetTransform=o.setTransform,o.__originalResetTransform=o.resetTransform,o.__originalClip=o.clip,o.__originalMoveTo=o.moveTo,o.__originalLineTo=o.lineTo,o.__originalBezierCurveTo=o.bezierCurveTo,o.__originalRect=o.rect,o.__originalClosePath=o.closePath,o.__originalBeginPath=o.beginPath,o._removeMirroring=()=>{o.save=o.__originalSave,o.restore=o.__originalRestore,o.rotate=o.__originalRotate,o.scale=o.__originalScale,o.translate=o.__originalTranslate,o.transform=o.__originalTransform,o.setTransform=o.__originalSetTransform,o.resetTransform=o.__originalResetTransform,o.clip=o.__originalClip,o.moveTo=o.__originalMoveTo,o.lineTo=o.__originalLineTo,o.bezierCurveTo=o.__originalBezierCurveTo,o.rect=o.__originalRect,o.closePath=o.__originalClosePath,o.beginPath=o.__originalBeginPath,delete o._removeMirroring},o.save=function(){l.save(),this.__originalSave()},o.restore=function(){l.restore(),this.__originalRestore()},o.translate=function(o,S){l.translate(o,S),this.__originalTranslate(o,S)},o.scale=function(o,S){l.scale(o,S),this.__originalScale(o,S)},o.transform=function(o,S,E,T,P,M){l.transform(o,S,E,T,P,M),this.__originalTransform(o,S,E,T,P,M)},o.setTransform=function(o,S,E,T,P,M){l.setTransform(o,S,E,T,P,M),this.__originalSetTransform(o,S,E,T,P,M)},o.resetTransform=function(){l.resetTransform(),this.__originalResetTransform()},o.rotate=function(o){l.rotate(o),this.__originalRotate(o)},o.clip=function(o){l.clip(o),this.__originalClip(o)},o.moveTo=function(o,S){l.moveTo(o,S),this.__originalMoveTo(o,S)},o.lineTo=function(o,S){l.lineTo(o,S),this.__originalLineTo(o,S)},o.bezierCurveTo=function(o,S,E,T,P,M){l.bezierCurveTo(o,S,E,T,P,M),this.__originalBezierCurveTo(o,S,E,T,P,M)},o.rect=function(o,S,E,T){l.rect(o,S,E,T),this.__originalRect(o,S,E,T)},o.closePath=function(){l.closePath(),this.__originalClosePath()},o.beginPath=function(){l.beginPath(),this.__originalBeginPath()}}class z{constructor(o){this.canvasFactory=o,this.cache=Object.create(null)}getCanvas(o,l,S){let E;return void 0!==this.cache[o]?(E=this.cache[o],this.canvasFactory.reset(E,l,S)):(E=this.canvasFactory.create(l,S),this.cache[o]=E),E}delete(o){delete this.cache[o]}clear(){for(let o in this.cache){let l=this.cache[o];this.canvasFactory.destroy(l),delete this.cache[o]}}}function V(o,l,S,E,P,M,F,O,I,D){let[L,N,U,H,W,z]=(0,T.getCurrentTransform)(o);if(0===N&&0===U){let T=F*L+W,V=Math.round(T),$=O*H+z,K=Math.round($),Y=(F+I)*L+W,J=Math.abs(Math.round(Y)-V)||1,Q=(O+D)*H+z,Z=Math.abs(Math.round(Q)-K)||1;return o.setTransform(Math.sign(L),0,0,Math.sign(H),V,K),o.drawImage(l,S,E,P,M,0,0,J,Z),o.setTransform(L,N,U,H,W,z),[J,Z]}if(0===L&&0===H){let T=O*U+W,V=Math.round(T),$=F*N+z,K=Math.round($),Y=(O+D)*U+W,J=Math.abs(Math.round(Y)-V)||1,Q=(F+I)*N+z,Z=Math.abs(Math.round(Q)-K)||1;return o.setTransform(0,Math.sign(N),Math.sign(U),0,V,K),o.drawImage(l,S,E,P,M,0,0,Z,J),o.setTransform(L,N,U,H,W,z),[Z,J]}o.drawImage(l,S,E,P,M,F,O,I,D);let V=Math.hypot(L,N),$=Math.hypot(U,H);return[V*I,$*D]}function $(o){let l,S,E;let{width:T,height:P}=o;if(T>U||P>U)return null;let M=1e3,F=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),O=T+1,I=new Uint8Array(O*(P+1)),D=T+7&-8,L=new Uint8Array(D*P),N=0;for(let l of o.data){let o=128;for(;o>0;)L[N++]=l&o?0:255,o>>=1}let H=0;for(0!==L[N=0]&&(I[0]=1,++H),S=1;S<T;S++)L[N]!==L[N+1]&&(I[S]=L[N]?2:1,++H),N++;for(0!==L[N]&&(I[S]=2,++H),l=1;l<P;l++){N=l*D,E=l*O,L[N-D]!==L[N]&&(I[E]=L[N]?1:8,++H);let o=(L[N]?4:0)+(L[N-D]?8:0);for(S=1;S<T;S++)F[o=(o>>2)+(L[N+1]?4:0)+(L[N-D+1]?8:0)]&&(I[E+S]=F[o],++H),N++;if(L[N-D]!==L[N]&&(I[E+S]=L[N]?2:4,++H),H>M)return null}for(N=D*(P-1),E=l*O,0!==L[N]&&(I[E]=8,++H),S=1;S<T;S++)L[N]!==L[N+1]&&(I[E+S]=L[N]?4:8,++H),N++;if(0!==L[N]&&(I[E+S]=4,++H),H>M)return null;let W=new Int32Array([0,O,-1,0,-O,0,0,0,1]),z=new Path2D;for(l=0;H&&l<=P;l++){let o=l*O,S=o+T;for(;o<S&&!I[o];)o++;if(o===S)continue;z.moveTo(o%O,l);let E=o,P=I[o];do{let l=W[P];do o+=l;while(!I[o]);let S=I[o];5!==S&&10!==S?(P=S,I[o]=0):(P=S&51*P>>4,I[o]&=P>>2|P<<2),z.lineTo(o%O,o/O|0),!I[o]&&--H}while(E!==o);--l}L=null,I=null;let V=function(o){o.save(),o.scale(1/T,-1/P),o.translate(0,-P),o.fill(z),o.beginPath(),o.restore()};return V}class K{constructor(o,l){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=E.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=E.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=E.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,o,l])}clone(){let o=Object.create(this);return o.clipBox=this.clipBox.slice(),o}setCurrentPoint(o,l){this.x=o,this.y=l}updatePathMinMax(o,l,S){[l,S]=E.Util.applyTransform([l,S],o),this.minX=Math.min(this.minX,l),this.minY=Math.min(this.minY,S),this.maxX=Math.max(this.maxX,l),this.maxY=Math.max(this.maxY,S)}updateRectMinMax(o,l){let S=E.Util.applyTransform(l,o),T=E.Util.applyTransform(l.slice(2),o);this.minX=Math.min(this.minX,S[0],T[0]),this.minY=Math.min(this.minY,S[1],T[1]),this.maxX=Math.max(this.maxX,S[0],T[0]),this.maxY=Math.max(this.maxY,S[1],T[1])}updateScalingPathMinMax(o,l){E.Util.scaleMinMax(o,l),this.minX=Math.min(this.minX,l[0]),this.maxX=Math.max(this.maxX,l[1]),this.minY=Math.min(this.minY,l[2]),this.maxY=Math.max(this.maxY,l[3])}updateCurvePathMinMax(o,l,S,T,P,M,F,O,I,D){let L=E.Util.bezierBoundingBox(l,S,T,P,M,F,O,I);if(D){D[0]=Math.min(D[0],L[0],L[2]),D[1]=Math.max(D[1],L[0],L[2]),D[2]=Math.min(D[2],L[1],L[3]),D[3]=Math.max(D[3],L[1],L[3]);return}this.updateRectMinMax(o,L)}getPathBoundingBox(o=P.PathType.FILL,l=null){let S=[this.minX,this.minY,this.maxX,this.maxY];if(o===P.PathType.STROKE){l||(0,E.unreachable)("Stroke bounding box must include transform.");let o=E.Util.singularValueDecompose2dScale(l),T=o[0]*this.lineWidth/2,P=o[1]*this.lineWidth/2;S[0]-=T,S[1]-=P,S[2]+=T,S[3]+=P}return S}updateClipFromPath(){let o=E.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(o||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(o){this.clipBox=o,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(o=P.PathType.FILL,l=null){return E.Util.intersect(this.clipBox,this.getPathBoundingBox(o,l))}}function Y(o,l){let S,T,P,M;if("undefined"!=typeof ImageData&&l instanceof ImageData){o.putImageData(l,0,0);return}let F=l.height,O=l.width,I=F%H,D=(F-I)/H,L=0===I?D:D+1,N=o.createImageData(O,H),U=0,W,z=l.data,V=N.data;if(l.kind===E.ImageKind.GRAYSCALE_1BPP){let l=z.byteLength,M=new Uint32Array(V.buffer,0,V.byteLength>>2),F=M.length,$=O+7>>3,K=4294967295,Y=E.FeatureTest.isLittleEndian?4278190080:255;for(S=0;S<L;S++){for(T=0,P=S<D?H:I,W=0;T<P;T++){let o=l-U,S=0,E=o>$?O:8*o-7,T=-8&E,P=0,F=0;for(;S<T;S+=8)F=z[U++],M[W++]=128&F?K:Y,M[W++]=64&F?K:Y,M[W++]=32&F?K:Y,M[W++]=16&F?K:Y,M[W++]=8&F?K:Y,M[W++]=4&F?K:Y,M[W++]=2&F?K:Y,M[W++]=1&F?K:Y;for(;S<E;S++)0===P&&(F=z[U++],P=128),M[W++]=F&P?K:Y,P>>=1}for(;W<F;)M[W++]=0;o.putImageData(N,0,S*H)}}else if(l.kind===E.ImageKind.RGBA_32BPP){for(S=0,T=0,M=O*H*4;S<D;S++)V.set(z.subarray(U,U+M)),U+=M,o.putImageData(N,0,T),T+=H;S<L&&(M=O*I*4,V.set(z.subarray(U,U+M)),o.putImageData(N,0,T))}else if(l.kind===E.ImageKind.RGB_24BPP)for(S=0,M=O*(P=H);S<L;S++){for(S>=D&&(M=O*(P=I)),W=0,T=M;T--;)V[W++]=z[U++],V[W++]=z[U++],V[W++]=z[U++],V[W++]=255;o.putImageData(N,0,S*H)}else throw Error(`bad image kind: ${l.kind}`)}function J(o,l){if(l.bitmap){o.drawImage(l.bitmap,0,0);return}let S=l.height,E=l.width,T=S%H,P=(S-T)/H,F=0===T?P:P+1,O=o.createImageData(E,H),I=0,D=l.data,L=O.data;for(let l=0;l<F;l++){let S=l<P?H:T;({srcPos:I}=(0,M.convertBlackAndWhiteToRGBA)({src:D,srcPos:I,dest:L,width:E,height:S,nonBlackColor:0})),o.putImageData(O,0,l*H)}}function Q(o,l){let S=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(let E of S)void 0!==o[E]&&(l[E]=o[E]);void 0!==o.setLineDash&&(l.setLineDash(o.getLineDash()),l.lineDashOffset=o.lineDashOffset)}function Z(o){o.strokeStyle=o.fillStyle="#000000",o.fillRule="nonzero",o.globalAlpha=1,o.lineWidth=1,o.lineCap="butt",o.lineJoin="miter",o.miterLimit=10,o.globalCompositeOperation="source-over",o.font="10px sans-serif",void 0!==o.setLineDash&&(o.setLineDash([]),o.lineDashOffset=0),F.isNodeJS||(o.filter="none")}function tt(o,l,S,E){let T=o.length;for(let P=3;P<T;P+=4){let T=o[P];if(0===T)o[P-3]=l,o[P-2]=S,o[P-1]=E;else if(T<255){let M=255-T;o[P-3]=o[P-3]*T+l*M>>8,o[P-2]=o[P-2]*T+S*M>>8,o[P-1]=o[P-1]*T+E*M>>8}}}function te(o,l,S){let E=o.length,T=1/255;for(let P=3;P<E;P+=4){let E=S?S[o[P]]:o[P];l[P]=l[P]*E*T|0}}function ti(o,l,S){let E=o.length;for(let T=3;T<E;T+=4){let E=77*o[T-3]+152*o[T-2]+28*o[T-1];l[T]=S?l[T]*S[E>>8]>>8:l[T]*E>>16}}function ts(o,l,S,E,T,P,M,F,O,I,D){let L;let N=!!P,U=N?P[0]:0,H=N?P[1]:0,W=N?P[2]:0;L="Luminosity"===T?ti:te;let z=1048576,V=Math.min(E,Math.ceil(z/S));for(let T=0;T<E;T+=V){let P=Math.min(V,E-T),z=o.getImageData(F-I,T+(O-D),S,P),$=l.getImageData(F,T+O,S,P);N&&tt(z.data,U,H,W),L(z.data,$.data,M),l.putImageData($,F,T+O)}}function tr(o,l,S,E){let T=E[0],P=E[1],M=E[2]-T,F=E[3]-P;0!==M&&0!==F&&(ts(l.context,S,M,F,l.subtype,l.backdrop,l.transferMap,T,P,l.offsetX,l.offsetY),o.save(),o.globalAlpha=1,o.globalCompositeOperation="source-over",o.setTransform(1,0,0,1,0,0),o.drawImage(S.canvas,0,0),o.restore())}function ta(o,l){let S=E.Util.singularValueDecompose2dScale(o);S[0]=Math.fround(S[0]),S[1]=Math.fround(S[1]);let P=Math.fround((globalThis.devicePixelRatio||1)*T.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==l?l:S[0]<=P||S[1]<=P}let tn=["butt","round","square"],to=["miter","round","bevel"],tl={},th={};class td{constructor(o,l,S,E,T,{optionalContentConfig:P,markedContentStack:M=null},F,O){this.ctx=o,this.current=new K(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=l,this.objs=S,this.canvasFactory=E,this.filterFactory=T,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=M||[],this.optionalContentConfig=P,this.cachedCanvases=new z(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=F,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=O,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(o,l=null){return"string"==typeof o?o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o):l}beginDrawing({transform:o,viewport:l,transparency:S=!1,background:E=null}){let P=this.ctx.canvas.width,M=this.ctx.canvas.height,F=this.ctx.fillStyle;if(this.ctx.fillStyle=E||"#ffffff",this.ctx.fillRect(0,0,P,M),this.ctx.fillStyle=F,S){let o=this.cachedCanvases.getCanvas("transparent",P,M);this.compositeCtx=this.ctx,this.transparentCanvas=o.canvas,this.ctx=o.context,this.ctx.save(),this.ctx.transform(...(0,T.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Z(this.ctx),o&&(this.ctx.transform(...o),this.outputScaleX=o[0],this.outputScaleY=o[0]),this.ctx.transform(...l.transform),this.viewportScale=l.scale,this.baseTransform=(0,T.getCurrentTransform)(this.ctx)}executeOperatorList(o,l,S,T){let P;let M=o.argsArray,F=o.fnArray,O=l||0,I=M.length;if(I===O)return O;let D=I-O>N&&"function"==typeof S,U=D?Date.now()+L:0,H=0,W=this.commonObjs,z=this.objs;for(;;){if(void 0!==T&&O===T.nextBreakPoint)return T.breakIt(O,S),O;if((P=F[O])!==E.OPS.dependency)this[P].apply(this,M[O]);else for(let o of M[O]){let l=o.startsWith("g_")?W:z;if(!l.has(o))return l.get(o,S),O}if(++O===I)return O;if(D&&++H>N){if(Date.now()>U)return S(),O;H=0}}}#tS(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){for(let o of(this.#tS(),this.cachedCanvases.clear(),this.cachedPatterns.clear(),this._cachedBitmapsMap.values())){for(let l of o.values())"undefined"!=typeof HTMLCanvasElement&&l instanceof HTMLCanvasElement&&(l.width=l.height=0);o.clear()}this._cachedBitmapsMap.clear(),this.#tx()}#tx(){if(this.pageColors){let o=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==o){let l=this.ctx.filter;this.ctx.filter=o,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=l}}}_scaleImage(o,l){let S,E;let T=o.width,P=o.height,M=Math.max(Math.hypot(l[0],l[1]),1),F=Math.max(Math.hypot(l[2],l[3]),1),O=T,I=P,D="prescale1";for(;M>2&&O>1||F>2&&I>1;){let l=O,T=I;M>2&&O>1&&(l=O>=16384?Math.floor(O/2)-1||1:Math.ceil(O/2),M/=O/l),F>2&&I>1&&(T=I>=16384?Math.floor(I/2)-1||1:Math.ceil(I)/2,F/=I/T),(E=(S=this.cachedCanvases.getCanvas(D,l,T)).context).clearRect(0,0,l,T),E.drawImage(o,0,0,O,I,0,0,l,T),o=S.canvas,O=l,I=T,D="prescale1"===D?"prescale2":"prescale1"}return{img:o,paintWidth:O,paintHeight:I}}_createMaskCanvas(o){let l,S,M,F;let O=this.ctx,{width:I,height:D}=o,L=this.current.fillColor,N=this.current.patternFill,U=(0,T.getCurrentTransform)(O);if((o.bitmap||o.data)&&o.count>1){let E=o.bitmap||o.data.buffer;S=JSON.stringify(N?U:[U.slice(0,4),L]),(l=this._cachedBitmapsMap.get(E))||(l=new Map,this._cachedBitmapsMap.set(E,l));let T=l.get(S);if(T&&!N){let o=Math.round(Math.min(U[0],U[2])+U[4]),l=Math.round(Math.min(U[1],U[3])+U[5]);return{canvas:T,offsetX:o,offsetY:l}}M=T}M||J((F=this.cachedCanvases.getCanvas("maskCanvas",I,D)).context,o);let H=E.Util.transform(U,[1/I,0,0,-1/D,0,0]);H=E.Util.transform(H,[1,0,0,1,0,-D]);let W=E.Util.applyTransform([0,0],H),z=E.Util.applyTransform([I,D],H),$=E.Util.normalizeRect([W[0],W[1],z[0],z[1]]),K=Math.round($[2]-$[0])||1,Y=Math.round($[3]-$[1])||1,Q=this.cachedCanvases.getCanvas("fillCanvas",K,Y),Z=Q.context,tt=Math.min(W[0],z[0]),te=Math.min(W[1],z[1]);Z.translate(-tt,-te),Z.transform(...H),!M&&(M=(M=this._scaleImage(F.canvas,(0,T.getCurrentTransformInverse)(Z))).img,l&&N&&l.set(S,M)),Z.imageSmoothingEnabled=ta((0,T.getCurrentTransform)(Z),o.interpolate),V(Z,M,0,0,M.width,M.height,0,0,I,D),Z.globalCompositeOperation="source-in";let ti=E.Util.transform((0,T.getCurrentTransformInverse)(Z),[1,0,0,1,-tt,-te]);return Z.fillStyle=N?L.getPattern(O,this,ti,P.PathType.FILL):L,Z.fillRect(0,0,I,D),l&&!N&&(this.cachedCanvases.delete("fillCanvas"),l.set(S,Q.canvas)),{canvas:Q.canvas,offsetX:Math.round(tt),offsetY:Math.round(te)}}setLineWidth(o){o!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=o,this.ctx.lineWidth=o}setLineCap(o){this.ctx.lineCap=tn[o]}setLineJoin(o){this.ctx.lineJoin=to[o]}setMiterLimit(o){this.ctx.miterLimit=o}setDash(o,l){let S=this.ctx;void 0!==S.setLineDash&&(S.setLineDash(o),S.lineDashOffset=l)}setRenderingIntent(o){}setFlatness(o){}setGState(o){for(let[l,S]of o)switch(l){case"LW":this.setLineWidth(S);break;case"LC":this.setLineCap(S);break;case"LJ":this.setLineJoin(S);break;case"ML":this.setMiterLimit(S);break;case"D":this.setDash(S[0],S[1]);break;case"RI":this.setRenderingIntent(S);break;case"FL":this.setFlatness(S);break;case"Font":this.setFont(S[0],S[1]);break;case"CA":this.current.strokeAlpha=S;break;case"ca":this.current.fillAlpha=S,this.ctx.globalAlpha=S;break;case"BM":this.ctx.globalCompositeOperation=S;break;case"SMask":this.current.activeSMask=S?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(S)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){let o=this.inSMaskMode;this.current.activeSMask&&!o?this.beginSMaskMode():!this.current.activeSMask&&o&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw Error("beginSMaskMode called while already in smask mode");let o=this.ctx.canvas.width,l=this.ctx.canvas.height,S="smaskGroupAt"+this.groupLevel,E=this.cachedCanvases.getCanvas(S,o,l);this.suspendedCtx=this.ctx,this.ctx=E.context;let P=this.ctx;P.setTransform(...(0,T.getCurrentTransform)(this.suspendedCtx)),Q(this.suspendedCtx,P),W(P,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Q(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(o){if(!this.current.activeSMask)return;o?(o[0]=Math.floor(o[0]),o[1]=Math.floor(o[1]),o[2]=Math.ceil(o[2]),o[3]=Math.ceil(o[3])):o=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];let l=this.current.activeSMask,S=this.suspendedCtx;tr(S,l,this.ctx,o),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Q(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();let o=this.current;this.stateStack.push(o),this.current=o.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Q(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(o,l,S,E,T,P){this.ctx.transform(o,l,S,E,T,P),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(o,l,S){let P,M;let F=this.ctx,O=this.current,I=O.x,D=O.y,L=(0,T.getCurrentTransform)(F),N=0===L[0]&&0===L[3]||0===L[1]&&0===L[2],U=N?S.slice(0):null;for(let S=0,T=0,H=o.length;S<H;S++)switch(0|o[S]){case E.OPS.rectangle:I=l[T++],D=l[T++];let H=l[T++],W=l[T++],z=I+H,V=D+W;F.moveTo(I,D),0===H||0===W?F.lineTo(z,V):(F.lineTo(z,D),F.lineTo(z,V),F.lineTo(I,V)),N||O.updateRectMinMax(L,[I,D,z,V]),F.closePath();break;case E.OPS.moveTo:I=l[T++],D=l[T++],F.moveTo(I,D),N||O.updatePathMinMax(L,I,D);break;case E.OPS.lineTo:I=l[T++],D=l[T++],F.lineTo(I,D),N||O.updatePathMinMax(L,I,D);break;case E.OPS.curveTo:P=I,M=D,I=l[T+4],D=l[T+5],F.bezierCurveTo(l[T],l[T+1],l[T+2],l[T+3],I,D),O.updateCurvePathMinMax(L,P,M,l[T],l[T+1],l[T+2],l[T+3],I,D,U),T+=6;break;case E.OPS.curveTo2:P=I,M=D,F.bezierCurveTo(I,D,l[T],l[T+1],l[T+2],l[T+3]),O.updateCurvePathMinMax(L,P,M,I,D,l[T],l[T+1],l[T+2],l[T+3],U),I=l[T+2],D=l[T+3],T+=4;break;case E.OPS.curveTo3:P=I,M=D,I=l[T+2],D=l[T+3],F.bezierCurveTo(l[T],l[T+1],I,D,I,D),O.updateCurvePathMinMax(L,P,M,l[T],l[T+1],I,D,I,D,U),T+=4;break;case E.OPS.closePath:F.closePath()}N&&O.updateScalingPathMinMax(L,U),O.setCurrentPoint(I,D)}closePath(){this.ctx.closePath()}stroke(o=!0){let l=this.ctx,S=this.current.strokeColor;l.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof S&&S?.getPattern?(l.save(),l.strokeStyle=S.getPattern(l,this,(0,T.getCurrentTransformInverse)(l),P.PathType.STROKE),this.rescaleAndStroke(!1),l.restore()):this.rescaleAndStroke(!0)),o&&this.consumePath(this.current.getClippedPathBoundingBox()),l.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(o=!0){let l=this.ctx,S=this.current.fillColor,E=this.current.patternFill,M=!1;E&&(l.save(),l.fillStyle=S.getPattern(l,this,(0,T.getCurrentTransformInverse)(l),P.PathType.FILL),M=!0);let F=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==F&&(this.pendingEOFill?(l.fill("evenodd"),this.pendingEOFill=!1):l.fill()),M&&l.restore(),o&&this.consumePath(F)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=tl}eoClip(){this.pendingClip=th}beginText(){this.current.textMatrix=E.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){let o=this.pendingTextPaths,l=this.ctx;if(void 0===o){l.beginPath();return}for(let S of(l.save(),l.beginPath(),o))l.setTransform(...S.transform),l.translate(S.x,S.y),S.addToPath(l,S.fontSize);l.restore(),l.clip(),l.beginPath(),delete this.pendingTextPaths}setCharSpacing(o){this.current.charSpacing=o}setWordSpacing(o){this.current.wordSpacing=o}setHScale(o){this.current.textHScale=o/100}setLeading(o){this.current.leading=-o}setFont(o,l){let S=this.commonObjs.get(o),T=this.current;if(!S)throw Error(`Can't find font for ${o}`);if(T.fontMatrix=S.fontMatrix||E.FONT_IDENTITY_MATRIX,(0===T.fontMatrix[0]||0===T.fontMatrix[3])&&(0,E.warn)("Invalid font matrix for font "+o),l<0?(l=-l,T.fontDirection=-1):T.fontDirection=1,this.current.font=S,this.current.fontSize=l,S.isType3Font)return;let P=S.loadedName||"sans-serif",M="normal";S.black?M="900":S.bold&&(M="bold");let F=S.italic?"italic":"normal",D=`"${P}", ${S.fallbackName}`,L=l;l<O?L=O:l>I&&(L=I),this.current.fontSizeScale=l/L,this.ctx.font=`${F} ${M} ${L}px ${D}`}setTextRenderingMode(o){this.current.textRenderingMode=o}setTextRise(o){this.current.textRise=o}moveText(o,l){this.current.x=this.current.lineX+=o,this.current.y=this.current.lineY+=l}setLeadingMoveText(o,l){this.setLeading(-l),this.moveText(o,l)}setTextMatrix(o,l,S,E,T,P){this.current.textMatrix=[o,l,S,E,T,P],this.current.textMatrixScale=Math.hypot(o,l),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(o,l,S,P){let M;let F=this.ctx,O=this.current,I=O.font,D=O.textRenderingMode,L=O.fontSize/O.fontSizeScale,N=D&E.TextRenderingMode.FILL_STROKE_MASK,U=!!(D&E.TextRenderingMode.ADD_TO_PATH_FLAG),H=O.patternFill&&!I.missingFile;if((I.disableFontFace||U||H)&&(M=I.getPathGenerator(this.commonObjs,o)),I.disableFontFace||H?(F.save(),F.translate(l,S),F.beginPath(),M(F,L),P&&F.setTransform(...P),(N===E.TextRenderingMode.FILL||N===E.TextRenderingMode.FILL_STROKE)&&F.fill(),(N===E.TextRenderingMode.STROKE||N===E.TextRenderingMode.FILL_STROKE)&&F.stroke(),F.restore()):((N===E.TextRenderingMode.FILL||N===E.TextRenderingMode.FILL_STROKE)&&F.fillText(o,l,S),(N===E.TextRenderingMode.STROKE||N===E.TextRenderingMode.FILL_STROKE)&&F.strokeText(o,l,S)),U){let o=this.pendingTextPaths||(this.pendingTextPaths=[]);o.push({transform:(0,T.getCurrentTransform)(F),x:l,y:S,fontSize:L,addToPath:M})}}get isFontSubpixelAAEnabled(){let{context:o}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);o.scale(1.5,1),o.fillText("I",0,10);let l=o.getImageData(0,0,10,10).data,S=!1;for(let o=3;o<l.length;o+=4)if(l[o]>0&&l[o]<255){S=!0;break}return(0,E.shadow)(this,"isFontSubpixelAAEnabled",S)}showText(o){let l;let S=this.current,M=S.font;if(M.isType3Font)return this.showType3Text(o);let F=S.fontSize;if(0===F)return;let O=this.ctx,I=S.fontSizeScale,D=S.charSpacing,L=S.wordSpacing,N=S.fontDirection,U=S.textHScale*N,H=o.length,W=M.vertical,z=W?1:-1,V=M.defaultVMetrics,$=F*S.fontMatrix[0],K=S.textRenderingMode===E.TextRenderingMode.FILL&&!M.disableFontFace&&!S.patternFill;if(O.save(),O.transform(...S.textMatrix),O.translate(S.x,S.y+S.textRise),N>0?O.scale(U,-1):O.scale(U,1),S.patternFill){O.save();let o=S.fillColor.getPattern(O,this,(0,T.getCurrentTransformInverse)(O),P.PathType.FILL);l=(0,T.getCurrentTransform)(O),O.restore(),O.fillStyle=o}let Y=S.lineWidth,J=S.textMatrixScale;if(0===J||0===Y){let o=S.textRenderingMode&E.TextRenderingMode.FILL_STROKE_MASK;(o===E.TextRenderingMode.STROKE||o===E.TextRenderingMode.FILL_STROKE)&&(Y=this.getSinglePixelWidth())}else Y/=J;if(1!==I&&(O.scale(I,I),Y/=I),O.lineWidth=Y,M.isInvalidPDFjsFont){let l=[],E=0;for(let S of o)l.push(S.unicode),E+=S.width;O.fillText(l.join(""),0,0),S.x+=E*$*U,O.restore(),this.compose();return}let Q=0,Z;for(Z=0;Z<H;++Z){let S,E,T;let P=o[Z];if("number"==typeof P){Q+=z*P*F/1e3;continue}let U=!1,H=(P.isSpace?L:0)+D,Y=P.fontChar,J=P.accent,tt=P.width;if(W){let o=P.vmetric||V,l=-(P.vmetric?o[1]:.5*tt)*$,T=o[2]*$;tt=o?-o[0]:tt,S=l/I,E=(Q+T)/I}else S=Q/I,E=0;if(M.remeasure&&tt>0){let o=1e3*O.measureText(Y).width/F*I;if(tt<o&&this.isFontSubpixelAAEnabled){let l=tt/o;U=!0,O.save(),O.scale(l,1),S/=l}else tt!==o&&(S+=(tt-o)/2e3*F/I)}if(this.contentVisible&&(P.isInFont||M.missingFile)){if(K&&!J)O.fillText(Y,S,E);else if(this.paintChar(Y,S,E,l),J){let o=S+F*J.offset.x/I,T=E-F*J.offset.y/I;this.paintChar(J.fontChar,o,T,l)}}Q+=T=W?tt*$-H*N:tt*$+H*N,U&&O.restore()}W?S.y-=Q:S.x+=Q*U,O.restore(),this.compose()}showType3Text(o){let l,S,T,P;let M=this.ctx,F=this.current,O=F.font,I=F.fontSize,D=F.fontDirection,L=O.vertical?1:-1,N=F.charSpacing,U=F.wordSpacing,H=F.textHScale*D,W=F.fontMatrix||E.FONT_IDENTITY_MATRIX,z=o.length,V=F.textRenderingMode===E.TextRenderingMode.INVISIBLE;if(!V&&0!==I){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,M.save(),M.transform(...F.textMatrix),M.translate(F.x,F.y),M.scale(H,D),l=0;l<z;++l){if("number"==typeof(S=o[l])){P=L*S*I/1e3,this.ctx.translate(P,0),F.x+=P*H;continue}let D=(S.isSpace?U:0)+N,z=O.charProcOperatorList[S.operatorListId];if(!z){(0,E.warn)(`Type3 character "${S.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=S,this.save(),M.scale(I,I),M.transform(...W),this.executeOperatorList(z),this.restore());let V=E.Util.applyTransform([S.width,0],W);T=V[0]*I+D,M.translate(T,0),F.x+=T*H}M.restore(),this.processingType3=null}}setCharWidth(o,l){}setCharWidthAndBounds(o,l,S,E,T,P){this.ctx.rect(S,E,T-S,P-E),this.ctx.clip(),this.endPath()}getColorN_Pattern(o){let l;if("TilingPattern"===o[0]){let S=o[1],E=this.baseTransform||(0,T.getCurrentTransform)(this.ctx),M={createCanvasGraphics:o=>new td(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};l=new P.TilingPattern(o,S,this.ctx,M,E)}else l=this._getPattern(o[1],o[2]);return l}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(o,l,S){let T=E.Util.makeHexColor(o,l,S);this.ctx.strokeStyle=T,this.current.strokeColor=T}setFillRGBColor(o,l,S){let T=E.Util.makeHexColor(o,l,S);this.ctx.fillStyle=T,this.current.fillColor=T,this.current.patternFill=!1}_getPattern(o,l=null){let S;return this.cachedPatterns.has(o)?S=this.cachedPatterns.get(o):(S=(0,P.getShadingPattern)(this.getObject(o)),this.cachedPatterns.set(o,S)),l&&(S.matrix=l),S}shadingFill(o){if(!this.contentVisible)return;let l=this.ctx;this.save();let S=this._getPattern(o);l.fillStyle=S.getPattern(l,this,(0,T.getCurrentTransformInverse)(l),P.PathType.SHADING);let M=(0,T.getCurrentTransformInverse)(l);if(M){let o=l.canvas,S=o.width,T=o.height,P=E.Util.applyTransform([0,0],M),F=E.Util.applyTransform([0,T],M),O=E.Util.applyTransform([S,0],M),I=E.Util.applyTransform([S,T],M),D=Math.min(P[0],F[0],O[0],I[0]),L=Math.min(P[1],F[1],O[1],I[1]),N=Math.max(P[0],F[0],O[0],I[0]),U=Math.max(P[1],F[1],O[1],I[1]);this.ctx.fillRect(D,L,N-D,U-L)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,E.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,E.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(o,l){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(o)&&6===o.length&&this.transform(...o),this.baseTransform=(0,T.getCurrentTransform)(this.ctx),l)){let o=l[2]-l[0],S=l[3]-l[1];this.ctx.rect(l[0],l[1],o,S),this.current.updateRectMinMax((0,T.getCurrentTransform)(this.ctx),l),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(o){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);let l=this.ctx;o.isolated||(0,E.info)("TODO: Support non-isolated groups."),o.knockout&&(0,E.warn)("Knockout groups not supported.");let S=(0,T.getCurrentTransform)(l);if(o.matrix&&l.transform(...o.matrix),!o.bbox)throw Error("Bounding box is required.");let P=E.Util.getAxialAlignedBoundingBox(o.bbox,(0,T.getCurrentTransform)(l)),M=[0,0,l.canvas.width,l.canvas.height];P=E.Util.intersect(P,M)||[0,0,0,0];let F=Math.floor(P[0]),O=Math.floor(P[1]),I=Math.max(Math.ceil(P[2])-F,1),L=Math.max(Math.ceil(P[3])-O,1),N=1,U=1;I>D&&(N=I/D,I=D),L>D&&(U=L/D,L=D),this.current.startNewPathAndClipBox([0,0,I,L]);let H="groupAt"+this.groupLevel;o.smask&&(H+="_smask_"+this.smaskCounter++%2);let W=this.cachedCanvases.getCanvas(H,I,L),z=W.context;z.scale(1/N,1/U),z.translate(-F,-O),z.transform(...S),o.smask?this.smaskStack.push({canvas:W.canvas,context:z,offsetX:F,offsetY:O,scaleX:N,scaleY:U,subtype:o.smask.subtype,backdrop:o.smask.backdrop,transferMap:o.smask.transferMap||null,startTransformInverse:null}):(l.setTransform(1,0,0,1,0,0),l.translate(F,O),l.scale(N,U),l.save()),Q(l,z),this.ctx=z,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(l),this.groupLevel++}endGroup(o){if(!this.contentVisible)return;this.groupLevel--;let l=this.ctx,S=this.groupStack.pop();if(this.ctx=S,this.ctx.imageSmoothingEnabled=!1,o.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();let o=(0,T.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...o);let S=E.Util.getAxialAlignedBoundingBox([0,0,l.canvas.width,l.canvas.height],o);this.ctx.drawImage(l.canvas,0,0),this.ctx.restore(),this.compose(S)}}beginAnnotation(o,l,S,P,M){if(this.#tS(),Z(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(l)&&4===l.length){let P=l[2]-l[0],F=l[3]-l[1];if(M&&this.annotationCanvasMap){S=S.slice(),S[4]-=l[0],S[5]-=l[1],(l=l.slice())[0]=l[1]=0,l[2]=P,l[3]=F;let[M,O]=E.Util.singularValueDecompose2dScale((0,T.getCurrentTransform)(this.ctx)),{viewportScale:I}=this,D=Math.ceil(P*this.outputScaleX*I),L=Math.ceil(F*this.outputScaleY*I);this.annotationCanvas=this.canvasFactory.create(D,L);let{canvas:N,context:U}=this.annotationCanvas;this.annotationCanvasMap.set(o,N),this.annotationCanvas.savedCtx=this.ctx,this.ctx=U,this.ctx.save(),this.ctx.setTransform(M,0,0,-O,0,F*O),Z(this.ctx)}else Z(this.ctx),this.ctx.rect(l[0],l[1],P,F),this.ctx.clip(),this.endPath()}this.current=new K(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...S),this.transform(...P)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#tx(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(o){if(!this.contentVisible)return;let l=o.count;(o=this.getObject(o.data,o)).count=l;let S=this.ctx,E=this.processingType3;if(E&&(void 0===E.compiled&&(E.compiled=$(o)),E.compiled)){E.compiled(S);return}let T=this._createMaskCanvas(o),P=T.canvas;S.save(),S.setTransform(1,0,0,1,0,0),S.drawImage(P,T.offsetX,T.offsetY),S.restore(),this.compose()}paintImageMaskXObjectRepeat(o,l,S=0,P=0,M,F){if(!this.contentVisible)return;o=this.getObject(o.data,o);let O=this.ctx;O.save();let I=(0,T.getCurrentTransform)(O);O.transform(l,S,P,M,0,0);let D=this._createMaskCanvas(o);O.setTransform(1,0,0,1,D.offsetX-I[4],D.offsetY-I[5]);for(let o=0,T=F.length;o<T;o+=2){let T=E.Util.transform(I,[l,S,P,M,F[o],F[o+1]]),[L,N]=E.Util.applyTransform([0,0],T);O.drawImage(D.canvas,L,N)}O.restore(),this.compose()}paintImageMaskXObjectGroup(o){if(!this.contentVisible)return;let l=this.ctx,S=this.current.fillColor,E=this.current.patternFill;for(let M of o){let{data:o,width:F,height:O,transform:I}=M,D=this.cachedCanvases.getCanvas("maskCanvas",F,O),L=D.context;L.save();let N=this.getObject(o,M);J(L,N),L.globalCompositeOperation="source-in",L.fillStyle=E?S.getPattern(L,this,(0,T.getCurrentTransformInverse)(l),P.PathType.FILL):S,L.fillRect(0,0,F,O),L.restore(),l.save(),l.transform(...I),l.scale(1,-1),V(l,D.canvas,0,0,F,O,0,-1,1,1),l.restore()}this.compose()}paintImageXObject(o){if(!this.contentVisible)return;let l=this.getObject(o);if(!l){(0,E.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(l)}paintImageXObjectRepeat(o,l,S,T){if(!this.contentVisible)return;let P=this.getObject(o);if(!P){(0,E.warn)("Dependent image isn't ready yet");return}let M=P.width,F=P.height,O=[];for(let o=0,E=T.length;o<E;o+=2)O.push({transform:[l,0,0,S,T[o],T[o+1]],x:0,y:0,w:M,h:F});this.paintInlineImageXObjectGroup(P,O)}applyTransferMapsToCanvas(o){return"none"!==this.current.transferMaps&&(o.filter=this.current.transferMaps,o.drawImage(o.canvas,0,0),o.filter="none"),o.canvas}applyTransferMapsToBitmap(o){if("none"===this.current.transferMaps)return o.bitmap;let{bitmap:l,width:S,height:E}=o,T=this.cachedCanvases.getCanvas("inlineImage",S,E),P=T.context;return P.filter=this.current.transferMaps,P.drawImage(l,0,0),P.filter="none",T.canvas}paintInlineImageXObject(o){let l;if(!this.contentVisible)return;let S=o.width,E=o.height,P=this.ctx;if(this.save(),F.isNodeJS||(P.filter="none"),P.scale(1/S,-1/E),o.bitmap)l=this.applyTransferMapsToBitmap(o);else if("function"==typeof HTMLElement&&o instanceof HTMLElement||!o.data)l=o;else{let T=this.cachedCanvases.getCanvas("inlineImage",S,E),P=T.context;Y(P,o),l=this.applyTransferMapsToCanvas(P)}let M=this._scaleImage(l,(0,T.getCurrentTransformInverse)(P));P.imageSmoothingEnabled=ta((0,T.getCurrentTransform)(P),o.interpolate),V(P,M.img,0,0,M.paintWidth,M.paintHeight,0,-E,S,E),this.compose(),this.restore()}paintInlineImageXObjectGroup(o,l){let S;if(!this.contentVisible)return;let E=this.ctx;if(o.bitmap)S=o.bitmap;else{let l=o.width,E=o.height,T=this.cachedCanvases.getCanvas("inlineImage",l,E),P=T.context;Y(P,o),S=this.applyTransferMapsToCanvas(P)}for(let o of l)E.save(),E.transform(...o.transform),E.scale(1,-1),V(E,S,o.x,o.y,o.w,o.h,0,-1,1,1),E.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(o){}markPointProps(o,l){}beginMarkedContent(o){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(o,l){"OC"===o?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(l)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(o){let l=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(o);let S=this.ctx;this.pendingClip&&(l||(this.pendingClip===th?S.clip("evenodd"):S.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),S.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){let o=(0,T.getCurrentTransform)(this.ctx);if(0===o[1]&&0===o[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(o[0]),Math.abs(o[3]));else{let l=Math.abs(o[0]*o[3]-o[2]*o[1]),S=Math.hypot(o[0],o[2]),E=Math.hypot(o[1],o[3]);this._cachedGetSinglePixelWidth=Math.max(S,E)/l}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){let o,l;let{lineWidth:S}=this.current,E=(0,T.getCurrentTransform)(this.ctx);if(0===E[1]&&0===E[2]){let T=Math.abs(E[0]),P=Math.abs(E[3]);if(0===S)o=1/T,l=1/P;else{let E=T*S,M=P*S;o=E<1?1/E:1,l=M<1?1/M:1}}else{let T=Math.abs(E[0]*E[3]-E[2]*E[1]),P=Math.hypot(E[0],E[1]),M=Math.hypot(E[2],E[3]);if(0===S)o=M/T,l=P/T;else{let E=S*T;o=M>E?M/E:1,l=P>E?P/E:1}}this._cachedScaleForStroking=[o,l]}return this._cachedScaleForStroking}rescaleAndStroke(o){let l,S,E;let{ctx:P}=this,{lineWidth:M}=this.current,[F,O]=this.getScaleForStroking();if(P.lineWidth=M||1,1===F&&1===O){P.stroke();return}o&&(l=(0,T.getCurrentTransform)(P),S=P.getLineDash().slice(),E=P.lineDashOffset),P.scale(F,O);let I=Math.max(F,O);P.setLineDash(P.getLineDash().map(o=>o/I)),P.lineDashOffset/=I,P.stroke(),o&&(P.setTransform(...l),P.setLineDash(S),P.lineDashOffset=E)}isContentVisible(){for(let o=this.markedContentStack.length-1;o>=0;o--)if(!this.markedContentStack[o].visible)return!1;return!0}}for(let o in l.CanvasGraphics=td,E.OPS)void 0!==td.prototype[o]&&(td.prototype[E.OPS[o]]=td.prototype[o])},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.TilingPattern=l.PathType=void 0,l.getShadingPattern=U;var E=S(1),T=S(6);let P={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function M(o,l){if(!l)return;let S=l[2]-l[0],E=l[3]-l[1],T=new Path2D;T.rect(l[0],l[1],S,E),o.clip(T)}l.PathType=P;class F{constructor(){this.constructor===F&&(0,E.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,E.unreachable)("Abstract method `getPattern` called.")}}class O extends F{constructor(o){super(),this._type=o[1],this._bbox=o[2],this._colorStops=o[3],this._p0=o[4],this._p1=o[5],this._r0=o[6],this._r1=o[7],this.matrix=null}_createGradient(o){let l;for(let S of("axial"===this._type?l=o.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(l=o.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1)),this._colorStops))l.addColorStop(S[0],S[1]);return l}getPattern(o,l,S,F){let O;if(F===P.STROKE||F===P.FILL){let P=l.current.getClippedPathBoundingBox(F,(0,T.getCurrentTransform)(o))||[0,0,0,0],I=Math.ceil(P[2]-P[0])||1,D=Math.ceil(P[3]-P[1])||1,L=l.cachedCanvases.getCanvas("pattern",I,D,!0),N=L.context;N.clearRect(0,0,N.canvas.width,N.canvas.height),N.beginPath(),N.rect(0,0,N.canvas.width,N.canvas.height),N.translate(-P[0],-P[1]),S=E.Util.transform(S,[1,0,0,1,P[0],P[1]]),N.transform(...l.baseTransform),this.matrix&&N.transform(...this.matrix),M(N,this._bbox),N.fillStyle=this._createGradient(N),N.fill(),O=o.createPattern(L.canvas,"no-repeat");let U=new DOMMatrix(S);O.setTransform(U)}else M(o,this._bbox),O=this._createGradient(o);return O}}function I(o,l,S,E,T,P,M,F){let O,I,D,L,N,U,H,W,z;let V=l.coords,$=l.colors,K=o.data,Y=4*o.width;V[S+1]>V[E+1]&&(O=S,S=E,E=O,O=P,P=M,M=O),V[E+1]>V[T+1]&&(O=E,E=T,T=O,O=M,M=F,F=O),V[S+1]>V[E+1]&&(O=S,S=E,E=O,O=P,P=M,M=O);let J=(V[S]+l.offsetX)*l.scaleX,Q=(V[S+1]+l.offsetY)*l.scaleY,Z=(V[E]+l.offsetX)*l.scaleX,tt=(V[E+1]+l.offsetY)*l.scaleY,te=(V[T]+l.offsetX)*l.scaleX,ti=(V[T+1]+l.offsetY)*l.scaleY;if(Q>=ti)return;let ts=$[P],tr=$[P+1],ta=$[P+2],tn=$[M],to=$[M+1],tl=$[M+2],th=$[F],td=$[F+1],tc=$[F+2],tu=Math.round(Q),tp=Math.round(ti);for(let o=tu;o<=tp;o++){let l;if(o<tt){let l;I=J-(J-Z)*(l=o<Q?0:(Q-o)/(Q-tt)),D=ts-(ts-tn)*l,L=tr-(tr-to)*l,N=ta-(ta-tl)*l}else{let l;I=Z-(Z-te)*(l=o>ti?1:tt===ti?0:(tt-o)/(tt-ti)),D=tn-(tn-th)*l,L=to-(to-td)*l,N=tl-(tl-tc)*l}U=J-(J-te)*(l=o<Q?0:o>ti?1:(Q-o)/(Q-ti)),H=ts-(ts-th)*l,W=tr-(tr-td)*l,z=ta-(ta-tc)*l;let S=Math.round(Math.min(I,U)),E=Math.round(Math.max(I,U)),T=Y*o+4*S;for(let o=S;o<=E;o++)(l=(I-o)/(I-U))<0?l=0:l>1&&(l=1),K[T++]=D-(D-H)*l|0,K[T++]=L-(L-W)*l|0,K[T++]=N-(N-z)*l|0,K[T++]=255}}function D(o,l,S){let E,T;let P=l.coords,M=l.colors;switch(l.type){case"lattice":let F=l.verticesPerRow,O=Math.floor(P.length/F)-1,D=F-1;for(E=0;E<O;E++){let l=E*F;for(let E=0;E<D;E++,l++)I(o,S,P[l],P[l+1],P[l+F],M[l],M[l+1],M[l+F]),I(o,S,P[l+F+1],P[l+1],P[l+F],M[l+F+1],M[l+1],M[l+F])}break;case"triangles":for(E=0,T=P.length;E<T;E+=3)I(o,S,P[E],P[E+1],P[E+2],M[E],M[E+1],M[E+2]);break;default:throw Error("illegal figure")}}class L extends F{constructor(o){super(),this._coords=o[2],this._colors=o[3],this._figures=o[4],this._bounds=o[5],this._bbox=o[7],this._background=o[8],this.matrix=null}_createMeshCanvas(o,l,S){let E=1.1,T=3e3,P=2,M=Math.floor(this._bounds[0]),F=Math.floor(this._bounds[1]),O=Math.ceil(this._bounds[2])-M,I=Math.ceil(this._bounds[3])-F,L=Math.min(Math.ceil(Math.abs(O*o[0]*E)),T),N=Math.min(Math.ceil(Math.abs(I*o[1]*E)),T),U=O/L,H=I/N,W={coords:this._coords,colors:this._colors,offsetX:-M,offsetY:-F,scaleX:1/U,scaleY:1/H},z=L+2*P,V=N+2*P,$=S.getCanvas("mesh",z,V,!1),K=$.context,Y=K.createImageData(L,N);if(l){let o=Y.data;for(let S=0,E=o.length;S<E;S+=4)o[S]=l[0],o[S+1]=l[1],o[S+2]=l[2],o[S+3]=255}for(let o of this._figures)D(Y,o,W);K.putImageData(Y,P,P);let J=$.canvas;return{canvas:J,offsetX:M-P*U,offsetY:F-P*H,scaleX:U,scaleY:H}}getPattern(o,l,S,F){let O;if(M(o,this._bbox),F===P.SHADING)O=E.Util.singularValueDecompose2dScale((0,T.getCurrentTransform)(o));else if(O=E.Util.singularValueDecompose2dScale(l.baseTransform),this.matrix){let o=E.Util.singularValueDecompose2dScale(this.matrix);O=[O[0]*o[0],O[1]*o[1]]}let I=this._createMeshCanvas(O,F===P.SHADING?null:this._background,l.cachedCanvases);return F!==P.SHADING&&(o.setTransform(...l.baseTransform),this.matrix&&o.transform(...this.matrix)),o.translate(I.offsetX,I.offsetY),o.scale(I.scaleX,I.scaleY),o.createPattern(I.canvas,"no-repeat")}}class N extends F{getPattern(){return"hotpink"}}function U(o){switch(o[0]){case"RadialAxial":return new O(o);case"Mesh":return new L(o);case"Dummy":return new N}throw Error(`Unknown IR type: ${o[0]}`)}let H={COLORED:1,UNCOLORED:2};class W{static MAX_PATTERN_SIZE=3e3;constructor(o,l,S,E,T){this.operatorList=o[2],this.matrix=o[3]||[1,0,0,1,0,0],this.bbox=o[4],this.xstep=o[5],this.ystep=o[6],this.paintType=o[7],this.tilingType=o[8],this.color=l,this.ctx=S,this.canvasGraphicsFactory=E,this.baseTransform=T}createPatternCanvas(o){let l=this.operatorList,S=this.bbox,P=this.xstep,M=this.ystep,F=this.paintType,O=this.tilingType,I=this.color,D=this.canvasGraphicsFactory;(0,E.info)("TilingType: "+O);let L=S[0],N=S[1],U=S[2],H=S[3],W=E.Util.singularValueDecompose2dScale(this.matrix),z=E.Util.singularValueDecompose2dScale(this.baseTransform),V=[W[0]*z[0],W[1]*z[1]],$=this.getSizeAndScale(P,this.ctx.canvas.width,V[0]),K=this.getSizeAndScale(M,this.ctx.canvas.height,V[1]),Y=o.cachedCanvases.getCanvas("pattern",$.size,K.size,!0),J=Y.context,Q=D.createCanvasGraphics(J);Q.groupLevel=o.groupLevel,this.setFillAndStrokeStyleToContext(Q,F,I);let Z=L,tt=N,te=U,ti=H;return L<0&&(Z=0,te+=Math.abs(L)),N<0&&(tt=0,ti+=Math.abs(N)),J.translate(-($.scale*Z),-(K.scale*tt)),Q.transform($.scale,0,0,K.scale,0,0),J.save(),this.clipBbox(Q,Z,tt,te,ti),Q.baseTransform=(0,T.getCurrentTransform)(Q.ctx),Q.executeOperatorList(l),Q.endDrawing(),{canvas:Y.canvas,scaleX:$.scale,scaleY:K.scale,offsetX:Z,offsetY:tt}}getSizeAndScale(o,l,S){o=Math.abs(o);let E=Math.max(W.MAX_PATTERN_SIZE,l),T=Math.ceil(o*S);return T>=E?T=E:S=T/o,{scale:S,size:T}}clipBbox(o,l,S,E,P){let M=E-l,F=P-S;o.ctx.rect(l,S,M,F),o.current.updateRectMinMax((0,T.getCurrentTransform)(o.ctx),[l,S,E,P]),o.clip(),o.endPath()}setFillAndStrokeStyleToContext(o,l,S){let T=o.ctx,P=o.current;switch(l){case H.COLORED:let M=this.ctx;T.fillStyle=M.fillStyle,T.strokeStyle=M.strokeStyle,P.fillColor=M.fillStyle,P.strokeColor=M.strokeStyle;break;case H.UNCOLORED:let F=E.Util.makeHexColor(S[0],S[1],S[2]);T.fillStyle=F,T.strokeStyle=F,P.fillColor=F,P.strokeColor=F;break;default:throw new E.FormatError(`Unsupported paint type: ${l}`)}}getPattern(o,l,S,T){let M=S;T!==P.SHADING&&(M=E.Util.transform(M,l.baseTransform),this.matrix&&(M=E.Util.transform(M,this.matrix)));let F=this.createPatternCanvas(l),O=new DOMMatrix(M);O=(O=O.translate(F.offsetX,F.offsetY)).scale(1/F.scaleX,1/F.scaleY);let I=o.createPattern(F.canvas,"repeat");return I.setTransform(O),I}}l.TilingPattern=W},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.convertBlackAndWhiteToRGBA=P,l.convertToRGBA=T,l.grayToRGBA=F;var E=S(1);function T(o){switch(o.kind){case E.ImageKind.GRAYSCALE_1BPP:return P(o);case E.ImageKind.RGB_24BPP:return M(o)}return null}function P({src:o,srcPos:l=0,dest:S,width:T,height:P,nonBlackColor:M=4294967295,inverseDecode:F=!1}){let O=E.FeatureTest.isLittleEndian?4278190080:255,[I,D]=F?[M,O]:[O,M],L=T>>3,N=7&T,U=o.length;S=new Uint32Array(S.buffer);let H=0;for(let E=0;E<P;E++){for(let E=l+L;l<E;l++){let E=l<U?o[l]:255;S[H++]=128&E?D:I,S[H++]=64&E?D:I,S[H++]=32&E?D:I,S[H++]=16&E?D:I,S[H++]=8&E?D:I,S[H++]=4&E?D:I,S[H++]=2&E?D:I,S[H++]=1&E?D:I}if(0===N)continue;let E=l<U?o[l++]:255;for(let o=0;o<N;o++)S[H++]=E&1<<7-o?D:I}return{srcPos:l,destPos:H}}function M({src:o,srcPos:l=0,dest:S,destPos:T=0,width:P,height:M}){let F=0,O=o.length>>2,I=new Uint32Array(o.buffer,l,O);if(E.FeatureTest.isLittleEndian){for(;F<O-2;F+=3,T+=4){let o=I[F],l=I[F+1],E=I[F+2];S[T]=4278190080|o,S[T+1]=o>>>24|l<<8|4278190080,S[T+2]=l>>>16|E<<16|4278190080,S[T+3]=E>>>8|4278190080}for(let l=4*F,E=o.length;l<E;l+=3)S[T++]=o[l]|o[l+1]<<8|o[l+2]<<16|4278190080}else{for(;F<O-2;F+=3,T+=4){let o=I[F],l=I[F+1],E=I[F+2];S[T]=255|o,S[T+1]=o<<24|l>>>8|255,S[T+2]=l<<16|E>>>16|255,S[T+3]=E<<8|255}for(let l=4*F,E=o.length;l<E;l+=3)S[T++]=o[l]<<24|o[l+1]<<16|o[l+2]<<8|255}return{srcPos:l,destPos:T}}function F(o,l){if(E.FeatureTest.isLittleEndian)for(let S=0,E=o.length;S<E;S++)l[S]=65793*o[S]|4278190080;else for(let S=0,E=o.length;S<E;S++)l[S]=16843008*o[S]|255}},(o,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.GlobalWorkerOptions=void 0;let S=Object.create(null);l.GlobalWorkerOptions=S,S.workerPort=null,S.workerSrc=""},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.MessageHandler=void 0;var E=S(1);let T={DATA:1,ERROR:2},P={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function M(o){switch(o instanceof Error||"object"==typeof o&&null!==o||(0,E.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),o.name){case"AbortException":return new E.AbortException(o.message);case"MissingPDFException":return new E.MissingPDFException(o.message);case"PasswordException":return new E.PasswordException(o.message,o.code);case"UnexpectedResponseException":return new E.UnexpectedResponseException(o.message,o.status);case"UnknownErrorException":return new E.UnknownErrorException(o.message,o.details);default:return new E.UnknownErrorException(o.message,o.toString())}}class F{constructor(o,l,S){this.sourceName=o,this.targetName=l,this.comObj=S,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=o=>{let l=o.data;if(l.targetName!==this.sourceName)return;if(l.stream){this.#tC(l);return}if(l.callback){let o=l.callbackId,S=this.callbackCapabilities[o];if(!S)throw Error(`Cannot resolve callback ${o}`);if(delete this.callbackCapabilities[o],l.callback===T.DATA)S.resolve(l.data);else if(l.callback===T.ERROR)S.reject(M(l.reason));else throw Error("Unexpected callback case");return}let E=this.actionHandler[l.action];if(!E)throw Error(`Unknown action from worker: ${l.action}`);if(l.callbackId){let o=this.sourceName,P=l.sourceName;new Promise(function(o){o(E(l.data))}).then(function(E){S.postMessage({sourceName:o,targetName:P,callback:T.DATA,callbackId:l.callbackId,data:E})},function(E){S.postMessage({sourceName:o,targetName:P,callback:T.ERROR,callbackId:l.callbackId,reason:M(E)})});return}if(l.streamId){this.#tE(l);return}E(l.data)},S.addEventListener("message",this._onComObjOnMessage)}on(o,l){let S=this.actionHandler;if(S[o])throw Error(`There is already an actionName called "${o}"`);S[o]=l}send(o,l,S){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:o,data:l},S)}sendWithPromise(o,l,S){let T=this.callbackId++,P=new E.PromiseCapability;this.callbackCapabilities[T]=P;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:o,callbackId:T,data:l},S)}catch(o){P.reject(o)}return P.promise}sendWithStream(o,l,S,T){let F=this.streamId++,O=this.sourceName,I=this.targetName,D=this.comObj;return new ReadableStream({start:S=>{let P=new E.PromiseCapability;return this.streamControllers[F]={controller:S,startCall:P,pullCall:null,cancelCall:null,isClosed:!1},D.postMessage({sourceName:O,targetName:I,action:o,streamId:F,data:l,desiredSize:S.desiredSize},T),P.promise},pull:o=>{let l=new E.PromiseCapability;return this.streamControllers[F].pullCall=l,D.postMessage({sourceName:O,targetName:I,stream:P.PULL,streamId:F,desiredSize:o.desiredSize}),l.promise},cancel:o=>{(0,E.assert)(o instanceof Error,"cancel must have a valid reason");let l=new E.PromiseCapability;return this.streamControllers[F].cancelCall=l,this.streamControllers[F].isClosed=!0,D.postMessage({sourceName:O,targetName:I,stream:P.CANCEL,streamId:F,reason:M(o)}),l.promise}},S)}#tE(o){let l=o.streamId,S=this.sourceName,T=o.sourceName,F=this.comObj,O=this,I=this.actionHandler[o.action],D={enqueue(o,M=1,O){if(this.isCancelled)return;let I=this.desiredSize;this.desiredSize-=M,I>0&&this.desiredSize<=0&&(this.sinkCapability=new E.PromiseCapability,this.ready=this.sinkCapability.promise),F.postMessage({sourceName:S,targetName:T,stream:P.ENQUEUE,streamId:l,chunk:o},O)},close(){this.isCancelled||(this.isCancelled=!0,F.postMessage({sourceName:S,targetName:T,stream:P.CLOSE,streamId:l}),delete O.streamSinks[l])},error(o){(0,E.assert)(o instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,F.postMessage({sourceName:S,targetName:T,stream:P.ERROR,streamId:l,reason:M(o)}))},sinkCapability:new E.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:o.desiredSize,ready:null};D.sinkCapability.resolve(),D.ready=D.sinkCapability.promise,this.streamSinks[l]=D,new Promise(function(l){l(I(o.data,D))}).then(function(){F.postMessage({sourceName:S,targetName:T,stream:P.START_COMPLETE,streamId:l,success:!0})},function(o){F.postMessage({sourceName:S,targetName:T,stream:P.START_COMPLETE,streamId:l,reason:M(o)})})}#tC(o){let l=o.streamId,S=this.sourceName,T=o.sourceName,F=this.comObj,O=this.streamControllers[l],I=this.streamSinks[l];switch(o.stream){case P.START_COMPLETE:o.success?O.startCall.resolve():O.startCall.reject(M(o.reason));break;case P.PULL_COMPLETE:o.success?O.pullCall.resolve():O.pullCall.reject(M(o.reason));break;case P.PULL:if(!I){F.postMessage({sourceName:S,targetName:T,stream:P.PULL_COMPLETE,streamId:l,success:!0});break}I.desiredSize<=0&&o.desiredSize>0&&I.sinkCapability.resolve(),I.desiredSize=o.desiredSize,new Promise(function(o){o(I.onPull?.())}).then(function(){F.postMessage({sourceName:S,targetName:T,stream:P.PULL_COMPLETE,streamId:l,success:!0})},function(o){F.postMessage({sourceName:S,targetName:T,stream:P.PULL_COMPLETE,streamId:l,reason:M(o)})});break;case P.ENQUEUE:if((0,E.assert)(O,"enqueue should have stream controller"),O.isClosed)break;O.controller.enqueue(o.chunk);break;case P.CLOSE:if((0,E.assert)(O,"close should have stream controller"),O.isClosed)break;O.isClosed=!0,O.controller.close(),this.#tT(O,l);break;case P.ERROR:(0,E.assert)(O,"error should have stream controller"),O.controller.error(M(o.reason)),this.#tT(O,l);break;case P.CANCEL_COMPLETE:o.success?O.cancelCall.resolve():O.cancelCall.reject(M(o.reason)),this.#tT(O,l);break;case P.CANCEL:if(!I)break;new Promise(function(l){l(I.onCancel?.(M(o.reason)))}).then(function(){F.postMessage({sourceName:S,targetName:T,stream:P.CANCEL_COMPLETE,streamId:l,success:!0})},function(o){F.postMessage({sourceName:S,targetName:T,stream:P.CANCEL_COMPLETE,streamId:l,reason:M(o)})}),I.sinkCapability.reject(M(o.reason)),I.isCancelled=!0,delete this.streamSinks[l];break;default:throw Error("Unexpected stream case")}}async #tT(o,l){await Promise.allSettled([o.startCall?.promise,o.pullCall?.promise,o.cancelCall?.promise]),delete this.streamControllers[l]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}l.MessageHandler=F},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.Metadata=void 0;var E=S(1);class T{#tP;#tM;constructor({parsedData:o,rawData:l}){this.#tP=o,this.#tM=l}getRaw(){return this.#tM}get(o){return this.#tP.get(o)??null}getAll(){return(0,E.objectFromMap)(this.#tP)}has(o){return this.#tP.has(o)}}l.Metadata=T},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.OptionalContentConfig=void 0;var E=S(1),T=S(8);let P=Symbol("INTERNAL");class M{#tk=!0;constructor(o,l){this.name=o,this.intent=l}get visible(){return this.#tk}_setVisible(o,l){o!==P&&(0,E.unreachable)("Internal method `_setVisible` called."),this.#tk=l}}class F{#tw=null;#tR=new Map;#tF=null;#tO=null;constructor(o){if(this.name=null,this.creator=null,null===o)return;for(let l of(this.name=o.name,this.creator=o.creator,this.#tO=o.order,o.groups))this.#tR.set(l.id,new M(l.name,l.intent));if("OFF"===o.baseState)for(let o of this.#tR.values())o._setVisible(P,!1);for(let l of o.on)this.#tR.get(l)._setVisible(P,!0);for(let l of o.off)this.#tR.get(l)._setVisible(P,!1);this.#tF=this.getHash()}#tI(o){let l=o.length;if(l<2)return!0;let S=o[0];for(let T=1;T<l;T++){let l;let P=o[T];if(Array.isArray(P))l=this.#tI(P);else{if(!this.#tR.has(P))return(0,E.warn)(`Optional content group not found: ${P}`),!0;l=this.#tR.get(P).visible}switch(S){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return"And"===S}isVisible(o){if(0===this.#tR.size)return!0;if(!o)return(0,E.warn)("Optional content group not defined."),!0;if("OCG"===o.type)return this.#tR.has(o.id)?this.#tR.get(o.id).visible:((0,E.warn)(`Optional content group not found: ${o.id}`),!0);if("OCMD"===o.type){if(o.expression)return this.#tI(o.expression);if(o.policy&&"AnyOn"!==o.policy){if("AllOn"===o.policy){for(let l of o.ids){if(!this.#tR.has(l)){(0,E.warn)(`Optional content group not found: ${l}`);break}if(!this.#tR.get(l).visible)return!1}return!0}if("AnyOff"===o.policy){for(let l of o.ids){if(!this.#tR.has(l))return(0,E.warn)(`Optional content group not found: ${l}`),!0;if(!this.#tR.get(l).visible)return!0}return!1}if("AllOff"===o.policy){for(let l of o.ids){if(!this.#tR.has(l)){(0,E.warn)(`Optional content group not found: ${l}`);break}if(this.#tR.get(l).visible)return!1}return!0}}else{for(let l of o.ids){if(!this.#tR.has(l))return(0,E.warn)(`Optional content group not found: ${l}`),!0;if(this.#tR.get(l).visible)return!0}return!1}return(0,E.warn)(`Unknown optional content policy ${o.policy}.`),!0}return(0,E.warn)(`Unknown group type ${o.type}.`),!0}setVisibility(o,l=!0){if(!this.#tR.has(o)){(0,E.warn)(`Optional content group not found: ${o}`);return}this.#tR.get(o)._setVisible(P,!!l),this.#tw=null}get hasInitialVisibility(){return this.getHash()===this.#tF}getOrder(){return this.#tR.size?this.#tO?this.#tO.slice():[...this.#tR.keys()]:null}getGroups(){return this.#tR.size>0?(0,E.objectFromMap)(this.#tR):null}getGroup(o){return this.#tR.get(o)||null}getHash(){if(null!==this.#tw)return this.#tw;let o=new T.MurmurHash3_64;for(let[l,S]of this.#tR)o.update(`${l}:${S.visible}`);return this.#tw=o.hexdigest()}}l.OptionalContentConfig=F},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.PDFDataTransportStream=void 0;var E=S(1),T=S(6);class P{constructor({length:o,initialData:l,progressiveDone:S=!1,contentDispositionFilename:T=null,disableRange:P=!1,disableStream:M=!1},F){if((0,E.assert)(F,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=S,this._contentDispositionFilename=T,l?.length>0){let o=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(o)}this._pdfDataRangeTransport=F,this._isStreamingSupported=!M,this._isRangeSupported=!P,this._contentLength=o,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((o,l)=>{this._onReceiveData({begin:o,chunk:l})}),this._pdfDataRangeTransport.addProgressListener((o,l)=>{this._onProgress({loaded:o,total:l})}),this._pdfDataRangeTransport.addProgressiveReadListener(o=>{this._onReceiveData({chunk:o})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:o,chunk:l}){let S=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;if(void 0===o)this._fullRequestReader?this._fullRequestReader._enqueue(S):this._queuedChunks.push(S);else{let l=this._rangeReaders.some(function(l){return l._begin===o&&(l._enqueue(S),!0)});(0,E.assert)(l,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(o){void 0===o.total?this._rangeReaders[0]?.onProgress?.({loaded:o.loaded}):this._fullRequestReader?.onProgress?.({loaded:o.loaded,total:o.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(o){let l=this._rangeReaders.indexOf(o);l>=0&&this._rangeReaders.splice(l,1)}getFullReader(){(0,E.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");let o=this._queuedChunks;return this._queuedChunks=null,new M(this,o,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(o,l){if(l<=this._progressiveDataLength)return null;let S=new F(this,o,l);return this._pdfDataRangeTransport.requestDataRange(o,l),this._rangeReaders.push(S),S}cancelAllRequests(o){for(let l of(this._fullRequestReader?.cancel(o),this._rangeReaders.slice(0)))l.cancel(o);this._pdfDataRangeTransport.abort()}}l.PDFDataTransportStream=P;class M{constructor(o,l,S=!1,E=null){for(let P of(this._stream=o,this._done=S||!1,this._filename=(0,T.isPdfFile)(E)?E:null,this._queuedChunks=l||[],this._loaded=0,this._queuedChunks))this._loaded+=P.byteLength;this._requests=[],this._headersReady=Promise.resolve(),o._fullRequestReader=this,this.onProgress=null}_enqueue(o){if(!this._done){if(this._requests.length>0){let l=this._requests.shift();l.resolve({value:o,done:!1})}else this._queuedChunks.push(o);this._loaded+=o.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){let o=this._queuedChunks.shift();return{value:o,done:!1}}if(this._done)return{value:void 0,done:!0};let o=new E.PromiseCapability;return this._requests.push(o),o.promise}cancel(o){for(let o of(this._done=!0,this._requests))o.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class F{constructor(o,l,S){this._stream=o,this._begin=l,this._end=S,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(o){if(!this._done){if(0===this._requests.length)this._queuedChunk=o;else{let l=this._requests.shift();for(let S of(l.resolve({value:o,done:!1}),this._requests))S.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){let o=this._queuedChunk;return this._queuedChunk=null,{value:o,done:!1}}if(this._done)return{value:void 0,done:!0};let o=new E.PromiseCapability;return this._requests.push(o),o.promise}cancel(o){for(let o of(this._done=!0,this._requests))o.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(o,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.XfaText=void 0;class S{static textContent(o){let l=[],E={items:l,styles:Object.create(null)};function T(o){if(!o)return;let E=null,P=o.name;if("#text"===P)E=o.value;else{if(!S.shouldBuildText(P))return;o?.attributes?.textContent?E=o.attributes.textContent:o.value&&(E=o.value)}if(null!==E&&l.push({str:E}),o.children)for(let l of o.children)T(l)}return T(o),E}static shouldBuildText(o){return!("textarea"===o||"input"===o||"option"===o||"select"===o)}}l.XfaText=S},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.NodeStandardFontDataFactory=l.NodeFilterFactory=l.NodeCanvasFactory=l.NodeCMapReaderFactory=void 0;var E=S(7);let T=function(o){return new Promise((l,S)=>{let E=__webpack_require__(9080);E.readFile(o,(o,E)=>{if(o||!E){S(Error(o));return}l(new Uint8Array(E))})})};class P extends E.BaseFilterFactory{}l.NodeFilterFactory=P;class M extends E.BaseCanvasFactory{_createCanvas(o,l){let S=__webpack_require__(9349);return S.createCanvas(o,l)}}l.NodeCanvasFactory=M;class F extends E.BaseCMapReaderFactory{_fetchData(o,l){return T(o).then(o=>({cMapData:o,compressionType:l}))}}l.NodeCMapReaderFactory=F;class O extends E.BaseStandardFontDataFactory{_fetchData(o){return T(o)}}l.NodeStandardFontDataFactory=O},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.PDFNodeStream=void 0;var E=S(1),T=S(22);let P=__webpack_require__(9080),M=__webpack_require__(7588),F=__webpack_require__(3071),O=__webpack_require__(692),I=/^file:\/\/\/[a-zA-Z]:\//;function D(o){let l=O.parse(o);return"file:"===l.protocol||l.host?l:/^[a-z]:[/\\]/i.test(o)?O.parse(`file:///${o}`):(l.host||(l.protocol="file:"),l)}class L{constructor(o){this.source=o,this.url=D(o.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&o.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,E.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new V(this):new W(this),this._fullRequestReader}getRangeReader(o,l){if(l<=this._progressiveDataLength)return null;let S=this.isFsUrl?new $(this,o,l):new z(this,o,l);return this._rangeRequestReaders.push(S),S}cancelAllRequests(o){for(let l of(this._fullRequestReader?.cancel(o),this._rangeRequestReaders.slice(0)))l.cancel(o)}}l.PDFNodeStream=L;class N{constructor(o){this._url=o.url,this._done=!1,this._storedError=null,this.onProgress=null;let l=o.source;this._contentLength=l.length,this._loaded=0,this._filename=null,this._disableRange=l.disableRange||!1,this._rangeChunkSize=l.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!l.disableStream,this._isRangeSupported=!l.disableRange,this._readableStream=null,this._readCapability=new E.PromiseCapability,this._headersCapability=new E.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let o=this._readableStream.read();if(null===o)return this._readCapability=new E.PromiseCapability,this.read();this._loaded+=o.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength});let l=new Uint8Array(o).buffer;return{value:l,done:!1}}cancel(o){if(!this._readableStream){this._error(o);return}this._readableStream.destroy(o)}_error(o){this._storedError=o,this._readCapability.resolve()}_setReadableStream(o){this._readableStream=o,o.on("readable",()=>{this._readCapability.resolve()}),o.on("end",()=>{o.destroy(),this._done=!0,this._readCapability.resolve()}),o.on("error",o=>{this._error(o)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new E.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class U{constructor(o){this._url=o.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new E.PromiseCapability;let l=o.source;this._isStreamingSupported=!l.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let o=this._readableStream.read();if(null===o)return this._readCapability=new E.PromiseCapability,this.read();this._loaded+=o.length,this.onProgress?.({loaded:this._loaded});let l=new Uint8Array(o).buffer;return{value:l,done:!1}}cancel(o){if(!this._readableStream){this._error(o);return}this._readableStream.destroy(o)}_error(o){this._storedError=o,this._readCapability.resolve()}_setReadableStream(o){this._readableStream=o,o.on("readable",()=>{this._readCapability.resolve()}),o.on("end",()=>{o.destroy(),this._done=!0,this._readCapability.resolve()}),o.on("error",o=>{this._error(o)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function H(o,l){return{protocol:o.protocol,auth:o.auth,host:o.hostname,port:o.port,path:o.path,method:"GET",headers:l}}class W extends N{constructor(o){super(o);let l=l=>{if(404===l.statusCode){let o=new E.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=o,this._headersCapability.reject(o);return}this._headersCapability.resolve(),this._setReadableStream(l);let S=o=>this._readableStream.headers[o.toLowerCase()],{allowRangeRequests:P,suggestedLength:M}=(0,T.validateRangeRequestCapabilities)({getResponseHeader:S,isHttp:o.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=P,this._contentLength=M||this._contentLength,this._filename=(0,T.extractFilenameFromHeader)(S)};this._request=null,"http:"===this._url.protocol?this._request=M.request(H(this._url,o.httpHeaders),l):this._request=F.request(H(this._url,o.httpHeaders),l),this._request.on("error",o=>{this._storedError=o,this._headersCapability.reject(o)}),this._request.end()}}class z extends U{constructor(o,l,S){for(let l in super(o),this._httpHeaders={},o.httpHeaders){let S=o.httpHeaders[l];void 0!==S&&(this._httpHeaders[l]=S)}this._httpHeaders.Range=`bytes=${l}-${S-1}`;let T=o=>{if(404===o.statusCode){let o=new E.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=o;return}this._setReadableStream(o)};this._request=null,"http:"===this._url.protocol?this._request=M.request(H(this._url,this._httpHeaders),T):this._request=F.request(H(this._url,this._httpHeaders),T),this._request.on("error",o=>{this._storedError=o}),this._request.end()}}class V extends N{constructor(o){super(o);let l=decodeURIComponent(this._url.path);I.test(this._url.href)&&(l=l.replace(/^\//,"")),P.lstat(l,(o,S)=>{if(o){"ENOENT"===o.code&&(o=new E.MissingPDFException(`Missing PDF "${l}".`)),this._storedError=o,this._headersCapability.reject(o);return}this._contentLength=S.size,this._setReadableStream(P.createReadStream(l)),this._headersCapability.resolve()})}}class $ extends U{constructor(o,l,S){super(o);let E=decodeURIComponent(this._url.path);I.test(this._url.href)&&(E=E.replace(/^\//,"")),this._setReadableStream(P.createReadStream(E,{start:l,end:S-1}))}}},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.createResponseStatusError=O,l.extractFilenameFromHeader=F,l.validateRangeRequestCapabilities=M,l.validateResponseStatus=I;var E=S(1),T=S(23),P=S(6);function M({getResponseHeader:o,isHttp:l,rangeChunkSize:S,disableRange:E}){let T={allowRangeRequests:!1,suggestedLength:void 0},P=parseInt(o("Content-Length"),10);if(!Number.isInteger(P)||(T.suggestedLength=P,P<=2*S||E||!l||"bytes"!==o("Accept-Ranges")))return T;let M=o("Content-Encoding")||"identity";return"identity"!==M||(T.allowRangeRequests=!0),T}function F(o){let l=o("Content-Disposition");if(l){let o=(0,T.getFilenameFromContentDispositionHeader)(l);if(o.includes("%"))try{o=decodeURIComponent(o)}catch(o){}if((0,P.isPdfFile)(o))return o}return null}function O(o,l){return 404===o||0===o&&l.startsWith("file:")?new E.MissingPDFException('Missing PDF "'+l+'".'):new E.UnexpectedResponseException(`Unexpected server response (${o}) while retrieving PDF "${l}".`,o)}function I(o){return 200===o||206===o}},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.getFilenameFromContentDispositionHeader=T;var E=S(1);function T(o){let l=!0,S=T("filename\\*","i").exec(o);if(S){let o=O(S=S[1]);return M(o=D(o=I(o=unescape(o))))}if(S=F(o)){let o=D(S);return M(o)}if(S=T("filename","i").exec(o)){let o=O(S=S[1]);return M(o=D(o))}function T(o,l){return RegExp("(?:^|;)\\s*"+o+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',l)}function P(o,S){if(o){if(!/^[\x00-\xFF]+$/.test(S))return S;try{let T=new TextDecoder(o,{fatal:!0}),P=(0,E.stringToBytes)(S);S=T.decode(P),l=!1}catch(o){}}return S}function M(o){return l&&/[\x80-\xff]/.test(o)&&(o=P("utf-8",o),l&&(o=P("iso-8859-1",o))),o}function F(o){let l;let S=[],E=T("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(l=E.exec(o));){let[,o,E,T]=l;if((o=parseInt(o,10))in S){if(0===o)break;continue}S[o]=[E,T]}let P=[];for(let o=0;o<S.length&&(o in S);++o){let[l,E]=S[o];E=O(E),l&&(E=unescape(E),0===o&&(E=I(E))),P.push(E)}return P.join("")}function O(o){if(o.startsWith('"')){let l=o.slice(1).split('\\"');for(let o=0;o<l.length;++o){let S=l[o].indexOf('"');-1!==S&&(l[o]=l[o].slice(0,S),l.length=o+1),l[o]=l[o].replaceAll(/\\(.)/g,"$1")}o=l.join('"')}return o}function I(o){let l=o.indexOf("'");if(-1===l)return o;let S=o.slice(0,l),E=o.slice(l+1),T=E.replace(/^[^']*'/,"");return P(S,T)}function D(o){return!o.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(o)?o:o.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(o,l,S,E){if("q"===S||"Q"===S)return P(l,E=(E=E.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(o,l){return String.fromCharCode(parseInt(l,16))}));try{E=atob(E)}catch(o){}return P(l,E)})}return""}},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.PDFNetworkStream=void 0;var E=S(1),T=S(22);let P=200,M=206;function F(o){let l=o.response;return"string"!=typeof l?l:(0,E.stringToBytes)(l).buffer}class O{constructor(o,l={}){this.url=o,this.isHttp=/^https?:/i.test(o),this.httpHeaders=this.isHttp&&l.httpHeaders||Object.create(null),this.withCredentials=l.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(o,l,S){let E={begin:o,end:l};for(let o in S)E[o]=S[o];return this.request(E)}requestFull(o){return this.request(o)}request(o){let l=new XMLHttpRequest,S=this.currXhrId++,E=this.pendingRequests[S]={xhr:l};for(let o in l.open("GET",this.url),l.withCredentials=this.withCredentials,this.httpHeaders){let S=this.httpHeaders[o];void 0!==S&&l.setRequestHeader(o,S)}return this.isHttp&&"begin"in o&&"end"in o?(l.setRequestHeader("Range",`bytes=${o.begin}-${o.end-1}`),E.expectedStatus=M):E.expectedStatus=P,l.responseType="arraybuffer",o.onError&&(l.onerror=function(S){o.onError(l.status)}),l.onreadystatechange=this.onStateChange.bind(this,S),l.onprogress=this.onProgress.bind(this,S),E.onHeadersReceived=o.onHeadersReceived,E.onDone=o.onDone,E.onError=o.onError,E.onProgress=o.onProgress,l.send(null),S}onProgress(o,l){let S=this.pendingRequests[o];S&&S.onProgress?.(l)}onStateChange(o,l){let S=this.pendingRequests[o];if(!S)return;let E=S.xhr;if(E.readyState>=2&&S.onHeadersReceived&&(S.onHeadersReceived(),delete S.onHeadersReceived),4!==E.readyState||!(o in this.pendingRequests))return;if(delete this.pendingRequests[o],0===E.status&&this.isHttp){S.onError?.(E.status);return}let T=E.status||P,O=T===P&&S.expectedStatus===M;if(!O&&T!==S.expectedStatus){S.onError?.(E.status);return}let I=F(E);if(T===M){let o=E.getResponseHeader("Content-Range"),l=/bytes (\d+)-(\d+)\/(\d+)/.exec(o);S.onDone({begin:parseInt(l[1],10),chunk:I})}else I?S.onDone({begin:0,chunk:I}):S.onError?.(E.status)}getRequestXhr(o){return this.pendingRequests[o].xhr}isPendingRequest(o){return o in this.pendingRequests}abortRequest(o){let l=this.pendingRequests[o].xhr;delete this.pendingRequests[o],l.abort()}}class I{constructor(o){this._source=o,this._manager=new O(o.url,{httpHeaders:o.httpHeaders,withCredentials:o.withCredentials}),this._rangeChunkSize=o.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(o){let l=this._rangeRequestReaders.indexOf(o);l>=0&&this._rangeRequestReaders.splice(l,1)}getFullReader(){return(0,E.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new D(this._manager,this._source),this._fullRequestReader}getRangeReader(o,l){let S=new L(this._manager,o,l);return S.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(S),S}cancelAllRequests(o){for(let l of(this._fullRequestReader?.cancel(o),this._rangeRequestReaders.slice(0)))l.cancel(o)}}l.PDFNetworkStream=I;class D{constructor(o,l){this._manager=o;let S={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=l.url,this._fullRequestId=o.requestFull(S),this._headersReceivedCapability=new E.PromiseCapability,this._disableRange=l.disableRange||!1,this._contentLength=l.length,this._rangeChunkSize=l.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){let o=this._fullRequestId,l=this._manager.getRequestXhr(o),S=o=>l.getResponseHeader(o),{allowRangeRequests:E,suggestedLength:P}=(0,T.validateRangeRequestCapabilities)({getResponseHeader:S,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});E&&(this._isRangeSupported=!0),this._contentLength=P||this._contentLength,this._filename=(0,T.extractFilenameFromHeader)(S),this._isRangeSupported&&this._manager.abortRequest(o),this._headersReceivedCapability.resolve()}_onDone(o){if(o){if(this._requests.length>0){let l=this._requests.shift();l.resolve({value:o.chunk,done:!1})}else this._cachedChunks.push(o.chunk)}if(this._done=!0,!(this._cachedChunks.length>0)){for(let o of this._requests)o.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(o){for(let l of(this._storedError=(0,T.createResponseStatusError)(o,this._url),this._headersReceivedCapability.reject(this._storedError),this._requests))l.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(o){this.onProgress?.({loaded:o.loaded,total:o.lengthComputable?o.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0){let o=this._cachedChunks.shift();return{value:o,done:!1}}if(this._done)return{value:void 0,done:!0};let o=new E.PromiseCapability;return this._requests.push(o),o.promise}cancel(o){for(let l of(this._done=!0,this._headersReceivedCapability.reject(o),this._requests))l.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L{constructor(o,l,S){this._manager=o;let E={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=o.url,this._requestId=o.requestRange(l,S,E),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(o){let l=o.chunk;if(this._requests.length>0){let o=this._requests.shift();o.resolve({value:l,done:!1})}else this._queuedChunk=l;for(let o of(this._done=!0,this._requests))o.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(o){for(let l of(this._storedError=(0,T.createResponseStatusError)(o,this._url),this._requests))l.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(o){this.isStreamingSupported||this.onProgress?.({loaded:o.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){let o=this._queuedChunk;return this._queuedChunk=null,{value:o,done:!1}}if(this._done)return{value:void 0,done:!0};let o=new E.PromiseCapability;return this._requests.push(o),o.promise}cancel(o){for(let o of(this._done=!0,this._requests))o.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.PDFFetchStream=void 0;var E=S(1),T=S(22);function P(o,l,S){return{method:"GET",headers:o,signal:S.signal,mode:"cors",credentials:l?"include":"same-origin",redirect:"follow"}}function M(o){let l=new Headers;for(let S in o){let E=o[S];void 0!==E&&l.append(S,E)}return l}function F(o){return o instanceof Uint8Array?o.buffer:o instanceof ArrayBuffer?o:((0,E.warn)(`getArrayBuffer - unexpected data format: ${o}`),new Uint8Array(o).buffer)}class O{constructor(o){this.source=o,this.isHttp=/^https?:/i.test(o.url),this.httpHeaders=this.isHttp&&o.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,E.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new I(this),this._fullRequestReader}getRangeReader(o,l){if(l<=this._progressiveDataLength)return null;let S=new D(this,o,l);return this._rangeRequestReaders.push(S),S}cancelAllRequests(o){for(let l of(this._fullRequestReader?.cancel(o),this._rangeRequestReaders.slice(0)))l.cancel(o)}}l.PDFFetchStream=O;class I{constructor(o){this._stream=o,this._reader=null,this._loaded=0,this._filename=null;let l=o.source;this._withCredentials=l.withCredentials||!1,this._contentLength=l.length,this._headersCapability=new E.PromiseCapability,this._disableRange=l.disableRange||!1,this._rangeChunkSize=l.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!l.disableStream,this._isRangeSupported=!l.disableRange,this._headers=M(this._stream.httpHeaders);let S=l.url;fetch(S,P(this._headers,this._withCredentials,this._abortController)).then(o=>{if(!(0,T.validateResponseStatus)(o.status))throw(0,T.createResponseStatusError)(o.status,S);this._reader=o.body.getReader(),this._headersCapability.resolve();let l=l=>o.headers.get(l),{allowRangeRequests:P,suggestedLength:M}=(0,T.validateRangeRequestCapabilities)({getResponseHeader:l,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=P,this._contentLength=M||this._contentLength,this._filename=(0,T.extractFilenameFromHeader)(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new E.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;let{value:o,done:l}=await this._reader.read();return l?{value:o,done:l}:(this._loaded+=o.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:F(o),done:!1})}cancel(o){this._reader?.cancel(o),this._abortController.abort()}}class D{constructor(o,l,S){this._stream=o,this._reader=null,this._loaded=0;let F=o.source;this._withCredentials=F.withCredentials||!1,this._readCapability=new E.PromiseCapability,this._isStreamingSupported=!F.disableStream,this._abortController=new AbortController,this._headers=M(this._stream.httpHeaders),this._headers.append("Range",`bytes=${l}-${S-1}`);let O=F.url;fetch(O,P(this._headers,this._withCredentials,this._abortController)).then(o=>{if(!(0,T.validateResponseStatus)(o.status))throw(0,T.createResponseStatusError)(o.status,O);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;let{value:o,done:l}=await this._reader.read();return l?{value:o,done:l}:(this._loaded+=o.byteLength,this.onProgress?.({loaded:this._loaded}),{value:F(o),done:!1})}cancel(o){this._reader?.cancel(o),this._abortController.abort()}}},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.TextLayerRenderTask=void 0,l.renderTextLayer=W,l.updateTextLayer=z;var E=S(1),T=S(6);let P=1e5,M=30,F=.8,O=new Map;function I(o,l){let S;if(l&&E.FeatureTest.isOffscreenCanvasSupported)S=new OffscreenCanvas(o,o).getContext("2d",{alpha:!1});else{let l=document.createElement("canvas");l.width=l.height=o,S=l.getContext("2d",{alpha:!1})}return S}function D(o,l){let S=O.get(o);if(S)return S;let E=I(M,l);E.font=`${M}px ${o}`;let T=E.measureText(""),P=T.fontBoundingBoxAscent,D=Math.abs(T.fontBoundingBoxDescent);if(P){let l=P/(P+D);return O.set(o,l),E.canvas.width=E.canvas.height=0,l}E.strokeStyle="red",E.clearRect(0,0,M,M),E.strokeText("g",0,0);let L=E.getImageData(0,0,M,M).data;D=0;for(let o=L.length-1-3;o>=0;o-=4)if(L[o]>0){D=Math.ceil(o/4/M);break}E.clearRect(0,0,M,M),E.strokeText("A",0,M),L=E.getImageData(0,0,M,M).data,P=0;for(let o=0,l=L.length;o<l;o+=4)if(L[o]>0){P=M-Math.floor(o/4/M);break}if(E.canvas.width=E.canvas.height=0,P){let l=P/(P+D);return O.set(o,l),l}return O.set(o,F),F}function L(o,l,S){let T,P;let M=document.createElement("span"),F={angle:0,canvasWidth:0,hasText:""!==l.str,hasEOL:l.hasEOL,fontSize:0};o._textDivs.push(M);let O=E.Util.transform(o._transform,l.transform),I=Math.atan2(O[1],O[0]),L=S[l.fontName];L.vertical&&(I+=Math.PI/2);let N=Math.hypot(O[2],O[3]),U=N*D(L.fontFamily,o._isOffscreenCanvasSupported);0===I?(T=O[4],P=O[5]-U):(T=O[4]+U*Math.sin(I),P=O[5]-U*Math.cos(I));let H="calc(var(--scale-factor)*",W=M.style;o._container===o._rootContainer?(W.left=`${(100*T/o._pageWidth).toFixed(2)}%`,W.top=`${(100*P/o._pageHeight).toFixed(2)}%`):(W.left=`${H}${T.toFixed(2)}px)`,W.top=`${H}${P.toFixed(2)}px)`),W.fontSize=`${H}${N.toFixed(2)}px)`,W.fontFamily=L.fontFamily,F.fontSize=N,M.setAttribute("role","presentation"),M.textContent=l.str,M.dir=l.dir,o._fontInspectorEnabled&&(M.dataset.fontName=l.fontName),0!==I&&(F.angle=I*(180/Math.PI));let z=!1;if(l.str.length>1)z=!0;else if(" "!==l.str&&l.transform[0]!==l.transform[3]){let o=Math.abs(l.transform[0]),S=Math.abs(l.transform[3]);o!==S&&Math.max(o,S)/Math.min(o,S)>1.5&&(z=!0)}z&&(F.canvasWidth=L.vertical?l.height:l.width),o._textDivProperties.set(M,F),o._isReadableStream&&o._layoutText(M)}function N(o){let{div:l,scale:S,properties:E,ctx:T,prevFontSize:P,prevFontFamily:M}=o,{style:F}=l,O="";if(0!==E.canvasWidth&&E.hasText){let{fontFamily:I}=F,{canvasWidth:D,fontSize:L}=E;(P!==L||M!==I)&&(T.font=`${L*S}px ${I}`,o.prevFontSize=L,o.prevFontFamily=I);let{width:N}=T.measureText(l.textContent);N>0&&(O=`scaleX(${D*S/N})`)}0!==E.angle&&(O=`rotate(${E.angle}deg) ${O}`),O.length>0&&(F.transform=O)}function U(o){if(o._canceled)return;let l=o._textDivs,S=o._capability,E=l.length;if(E>P){S.resolve();return}if(!o._isReadableStream)for(let S of l)o._layoutText(S);S.resolve()}class H{constructor({textContentSource:o,container:l,viewport:S,textDivs:P,textDivProperties:M,textContentItemsStr:F,isOffscreenCanvasSupported:O}){this._textContentSource=o,this._isReadableStream=o instanceof ReadableStream,this._container=this._rootContainer=l,this._textDivs=P||[],this._textContentItemsStr=F||[],this._isOffscreenCanvasSupported=O,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=M||new WeakMap,this._canceled=!1,this._capability=new E.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:S.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:I(0,O)};let{pageWidth:D,pageHeight:L,pageX:N,pageY:U}=S.rawDims;this._transform=[1,0,0,-1,-N,U+L],this._pageWidth=D,this._pageHeight=L,(0,T.setLayerDimensions)(l,S),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new E.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new E.AbortException("TextLayer task cancelled."))}_processItems(o,l){for(let S of o){if(void 0===S.str){if("beginMarkedContentProps"===S.type||"beginMarkedContent"===S.type){let o=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==S.id&&this._container.setAttribute("id",`${S.id}`),o.append(this._container)}else"endMarkedContent"===S.type&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(S.str),L(this,S,l)}}_layoutText(o){let l=this._layoutTextParams.properties=this._textDivProperties.get(o);if(this._layoutTextParams.div=o,N(this._layoutTextParams),l.hasText&&this._container.append(o),l.hasEOL){let o=document.createElement("br");o.setAttribute("role","presentation"),this._container.append(o)}}_render(){let o=new E.PromiseCapability,l=Object.create(null);if(this._isReadableStream){let S=()=>{this._reader.read().then(({value:E,done:T})=>{if(T){o.resolve();return}Object.assign(l,E.styles),this._processItems(E.items,l),S()},o.reject)};this._reader=this._textContentSource.getReader(),S()}else if(this._textContentSource){let{items:l,styles:S}=this._textContentSource;this._processItems(l,S),o.resolve()}else throw Error('No "textContentSource" parameter specified.');o.promise.then(()=>{l=null,U(this)},this._capability.reject)}}function W(o){!o.textContentSource&&(o.textContent||o.textContentStream)&&((0,T.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),o.textContentSource=o.textContent||o.textContentStream);let{container:l,viewport:S}=o,E=getComputedStyle(l),P=E.getPropertyValue("visibility"),M=parseFloat(E.getPropertyValue("--scale-factor"));"visible"===P&&(!M||Math.abs(M-S.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");let F=new H(o);return F._render(),F}function z({container:o,viewport:l,textDivs:S,textDivProperties:E,isOffscreenCanvasSupported:P,mustRotate:M=!0,mustRescale:F=!0}){if(M&&(0,T.setLayerDimensions)(o,{rotation:l.rotation}),F){let o=I(0,P),T=l.scale*(globalThis.devicePixelRatio||1),M={prevFontSize:null,prevFontFamily:null,div:null,scale:T,properties:null,ctx:o};for(let o of S)M.properties=E.get(o),M.div=o,N(M)}}l.TextLayerRenderTask=H},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.AnnotationEditorLayer=void 0;var E=S(1),T=S(5),P=S(28),M=S(29),F=S(6);class O{#tD;#tL=!1;#tN=this.pointerup.bind(this);#tj=this.pointerdown.bind(this);#tB=new Map;#tU=!1;#tG=!1;#tH;static _initialized=!1;constructor(o){O._initialized||(O._initialized=!0,P.FreeTextEditor.initialize(o.l10n),M.InkEditor.initialize(o.l10n)),o.uiManager.registerEditorTypes([P.FreeTextEditor,M.InkEditor]),this.#tH=o.uiManager,this.pageIndex=o.pageIndex,this.div=o.div,this.#tD=o.accessibilityManager,this.#tH.addLayer(this)}get isEmpty(){return 0===this.#tB.size}updateToolbar(o){this.#tH.updateToolbar(o)}updateMode(o=this.#tH.getMode()){this.#tq(),o===E.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),this.#tH.unselectAll(),o!==E.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",o===E.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",o===E.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(o){if(!o&&this.#tH.getMode()!==E.AnnotationEditorType.INK)return;if(!o){for(let o of this.#tB.values())if(o.isEmpty()){o.setInBackground();return}}let l=this.#tW({offsetX:0,offsetY:0});l.setInBackground()}setEditingState(o){this.#tH.setEditingState(o)}addCommands(o){this.#tH.addCommands(o)}enable(){for(let o of(this.div.style.pointerEvents="auto",this.#tB.values()))o.enableEditing()}disable(){for(let o of(this.div.style.pointerEvents="none",this.#tB.values()))o.disableEditing();this.#tq(),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(o){let l=this.#tH.getActive();l!==o&&this.#tH.setActiveEditor(o)}enableClick(){this.div.addEventListener("pointerdown",this.#tj),this.div.addEventListener("pointerup",this.#tN)}disableClick(){this.div.removeEventListener("pointerdown",this.#tj),this.div.removeEventListener("pointerup",this.#tN)}attach(o){this.#tB.set(o.id,o)}detach(o){this.#tB.delete(o.id),this.#tD?.removePointerInTextLayer(o.contentDiv)}remove(o){this.#tH.removeEditor(o),this.detach(o),o.div.style.display="none",setTimeout(()=>{o.div.style.display="",o.div.remove(),o.isAttachedToDOM=!1,document.activeElement===document.body&&this.#tH.focusMainContainer()},0),this.#tG||this.addInkEditorIfNeeded(!1)}#tz(o){o.parent!==this&&(this.attach(o),o.parent?.detach(o),o.setParent(this),o.div&&o.isAttachedToDOM&&(o.div.remove(),this.div.append(o.div)))}add(o){if(this.#tz(o),this.#tH.addEditor(o),this.attach(o),!o.isAttachedToDOM){let l=o.render();this.div.append(l),o.isAttachedToDOM=!0}this.moveEditorInDOM(o),o.onceAdded(),this.#tH.addToAnnotationStorage(o)}moveEditorInDOM(o){this.#tD?.moveElementInDOM(this.div,o.div,o.contentDiv,!0)}addOrRebuild(o){o.needsToBeRebuilt()?o.rebuild():this.add(o)}addANewEditor(o){let l=()=>{this.addOrRebuild(o)},S=()=>{o.remove()};this.addCommands({cmd:l,undo:S,mustExec:!0})}addUndoableEditor(o){let l=()=>{this.addOrRebuild(o)},S=()=>{o.remove()};this.addCommands({cmd:l,undo:S,mustExec:!1})}getNextId(){return this.#tH.getId()}#tV(o){switch(this.#tH.getMode()){case E.AnnotationEditorType.FREETEXT:return new P.FreeTextEditor(o);case E.AnnotationEditorType.INK:return new M.InkEditor(o)}return null}deserialize(o){switch(o.annotationType){case E.AnnotationEditorType.FREETEXT:return P.FreeTextEditor.deserialize(o,this,this.#tH);case E.AnnotationEditorType.INK:return M.InkEditor.deserialize(o,this,this.#tH)}return null}#tW(o){let l=this.getNextId(),S=this.#tV({parent:this,id:l,x:o.offsetX,y:o.offsetY,uiManager:this.#tH});return S&&this.add(S),S}setSelected(o){this.#tH.setSelected(o)}toggleSelected(o){this.#tH.toggleSelected(o)}isSelected(o){return this.#tH.isSelected(o)}unselect(o){this.#tH.unselect(o)}pointerup(o){let{isMac:l}=E.FeatureTest.platform;if(0===o.button&&(!o.ctrlKey||!l)&&o.target===this.div&&this.#tU){if(this.#tU=!1,!this.#tL){this.#tL=!0;return}this.#tW(o)}}pointerdown(o){let{isMac:l}=E.FeatureTest.platform;if(0!==o.button||o.ctrlKey&&l||o.target!==this.div)return;this.#tU=!0;let S=this.#tH.getActive();this.#tL=!S||S.isEmpty()}drop(o){let l=o.dataTransfer.getData("text/plain"),S=this.#tH.getEditor(l);if(!S)return;o.preventDefault(),o.dataTransfer.dropEffect="move",this.#tz(S);let E=this.div.getBoundingClientRect(),T=o.clientX-E.x,P=o.clientY-E.y;S.translate(T-S.startX,P-S.startY),this.moveEditorInDOM(S),S.div.focus()}dragover(o){o.preventDefault()}destroy(){for(let o of(this.#tH.getActive()?.parent===this&&this.#tH.setActiveEditor(null),this.#tB.values()))this.#tD?.removePointerInTextLayer(o.contentDiv),o.setParent(null),o.isAttachedToDOM=!1,o.div.remove();this.div=null,this.#tB.clear(),this.#tH.removeLayer(this)}#tq(){for(let o of(this.#tG=!0,this.#tB.values()))o.isEmpty()&&o.remove();this.#tG=!1}render({viewport:o}){for(let l of(this.viewport=o,(0,F.setLayerDimensions)(this.div,o),(0,T.bindEvents)(this,this.div,["dragover","drop"]),this.#tH.getEditors(this.pageIndex)))this.add(l);this.updateMode()}update({viewport:o}){this.#tH.commitOrRemove(),this.viewport=o,(0,F.setLayerDimensions)(this.div,{rotation:o.rotation}),this.updateMode()}get pageDimensions(){let{pageWidth:o,pageHeight:l}=this.viewport.rawDims;return[o,l]}}l.AnnotationEditorLayer=O},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.FreeTextEditor=void 0;var E=S(1),T=S(5),P=S(4);class M extends P.AnnotationEditor{#t$=this.editorDivBlur.bind(this);#tX=this.editorDivFocus.bind(this);#tK=this.editorDivInput.bind(this);#tY=this.editorDivKeydown.bind(this);#tJ;#tQ="";#tZ=`${this.id}-editor`;#t0=!1;#t1;static _freeTextDefaultContent="";static _l10nPromise;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static _keyboardManager=new T.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],M.prototype.commitOrRemove]]);static _type="freetext";constructor(o){super({...o,name:"freeTextEditor"}),this.#tJ=o.color||M._defaultColor||P.AnnotationEditor._defaultLineColor,this.#t1=o.fontSize||M._defaultFontSize}static initialize(o){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(l=>[l,o.get(l)]));let l=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(l.getPropertyValue("--freetext-padding"))}static updateDefaultParams(o,l){switch(o){case E.AnnotationEditorParamsType.FREETEXT_SIZE:M._defaultFontSize=l;break;case E.AnnotationEditorParamsType.FREETEXT_COLOR:M._defaultColor=l}}updateParams(o,l){switch(o){case E.AnnotationEditorParamsType.FREETEXT_SIZE:this.#t2(l);break;case E.AnnotationEditorParamsType.FREETEXT_COLOR:this.#t3(l)}}static get defaultPropertiesToUpdate(){return[[E.AnnotationEditorParamsType.FREETEXT_SIZE,M._defaultFontSize],[E.AnnotationEditorParamsType.FREETEXT_COLOR,M._defaultColor||P.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[E.AnnotationEditorParamsType.FREETEXT_SIZE,this.#t1],[E.AnnotationEditorParamsType.FREETEXT_COLOR,this.#tJ]]}#t2(o){let l=o=>{this.editorDiv.style.fontSize=`calc(${o}px * var(--scale-factor))`,this.translate(0,-(o-this.#t1)*this.parentScale),this.#t1=o,this.#t5()},S=this.#t1;this.addCommands({cmd:()=>{l(o)},undo:()=>{l(S)},mustExec:!0,type:E.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#t3(o){let l=this.#tJ;this.addCommands({cmd:()=>{this.#tJ=this.editorDiv.style.color=o},undo:()=>{this.#tJ=this.editorDiv.style.color=l},mustExec:!0,type:E.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}getInitialTranslation(){let o=this.parentScale;return[-M._internalPadding*o,-(M._internalPadding+this.#t1)*o]}rebuild(){super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(E.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#tY),this.editorDiv.addEventListener("focus",this.#tX),this.editorDiv.addEventListener("blur",this.#t$),this.editorDiv.addEventListener("input",this.#tK))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#tZ),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",this.#tY),this.editorDiv.removeEventListener("focus",this.#tX),this.editorDiv.removeEventListener("blur",this.#t$),this.editorDiv.removeEventListener("input",this.#tK),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(o){super.focusin(o),o.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}#t4(){let o=this.editorDiv.getElementsByTagName("div");if(0===o.length)return this.editorDiv.innerText;let l=[];for(let S of o)l.push(S.innerText.replace(/\r\n?|\n/,""));return l.join("\n")}#t5(){let o;let[l,S]=this.parentDimensions;if(this.isAttachedToDOM)o=this.div.getBoundingClientRect();else{let{currentLayer:l,div:S}=this,E=S.style.display;S.style.display="hidden",l.div.append(this.div),o=S.getBoundingClientRect(),S.remove(),S.style.display=E}this.width=o.width/l,this.height=o.height/S}commit(){this.isInEditMode()&&(super.commit(),this.#t0||(this.#t0=!0,this.parent.addUndoableEditor(this)),this.disableEditMode(),this.#tQ=this.#t4().trimEnd(),this.#t5())}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(o){this.enableEditMode(),this.editorDiv.focus()}keydown(o){o.target===this.div&&"Enter"===o.key&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(o){M._keyboardManager.exec(this,o)}editorDivFocus(o){this.isEditing=!0}editorDivBlur(o){this.isEditing=!1}editorDivInput(o){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){let o,l;if(this.div)return this.div;this.width&&(o=this.x,l=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#tZ),this.enableEditing(),M._l10nPromise.get("editor_free_text2_aria_label").then(o=>this.editorDiv?.setAttribute("aria-label",o)),M._l10nPromise.get("free_text2_default_content").then(o=>this.editorDiv?.setAttribute("default-content",o)),this.editorDiv.contentEditable=!0;let{style:S}=this.editorDiv;if(S.fontSize=`calc(${this.#t1}px * var(--scale-factor))`,S.color=this.#tJ,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,T.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){let[S,E]=this.parentDimensions;for(let T of(this.setAt(o*S,l*E,this.width*S,this.height*E),this.#tQ.split("\n"))){let o=document.createElement("div");o.append(T?document.createTextNode(T):document.createElement("br")),this.editorDiv.append(o)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(o,l,S){let T=super.deserialize(o,l,S);return T.#t1=o.fontSize,T.#tJ=E.Util.makeHexColor(...o.color),T.#tQ=o.value,T}serialize(){if(this.isEmpty())return null;let o=M._internalPadding*this.parentScale,l=this.getRect(o,o),S=P.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#tJ);return{annotationType:E.AnnotationEditorType.FREETEXT,color:S,fontSize:this.#t1,value:this.#tQ,pageIndex:this.pageIndex,rect:l,rotation:this.rotation}}}l.FreeTextEditor=M},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.InkEditor=void 0,Object.defineProperty(l,"fitCurve",{enumerable:!0,get:function(){return P.fitCurve}});var E=S(1),T=S(4),P=S(30),M=S(5);let F=16;class O extends T.AnnotationEditor{#t8=0;#t6=0;#t7=0;#t9=this.canvasPointermove.bind(this);#et=this.canvasPointerleave.bind(this);#ee=this.canvasPointerup.bind(this);#ei=this.canvasPointerdown.bind(this);#es=!1;#er=!1;#ea=null;#en=null;#eo=0;#el=0;#eh=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _l10nPromise;static _type="ink";constructor(o){super({...o,name:"inkEditor"}),this.color=o.color||null,this.thickness=o.thickness||null,this.opacity=o.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(o){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(l=>[l,o.get(l)]))}static updateDefaultParams(o,l){switch(o){case E.AnnotationEditorParamsType.INK_THICKNESS:O._defaultThickness=l;break;case E.AnnotationEditorParamsType.INK_COLOR:O._defaultColor=l;break;case E.AnnotationEditorParamsType.INK_OPACITY:O._defaultOpacity=l/100}}updateParams(o,l){switch(o){case E.AnnotationEditorParamsType.INK_THICKNESS:this.#ed(l);break;case E.AnnotationEditorParamsType.INK_COLOR:this.#t3(l);break;case E.AnnotationEditorParamsType.INK_OPACITY:this.#ec(l)}}static get defaultPropertiesToUpdate(){return[[E.AnnotationEditorParamsType.INK_THICKNESS,O._defaultThickness],[E.AnnotationEditorParamsType.INK_COLOR,O._defaultColor||T.AnnotationEditor._defaultLineColor],[E.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*O._defaultOpacity)]]}get propertiesToUpdate(){return[[E.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||O._defaultThickness],[E.AnnotationEditorParamsType.INK_COLOR,this.color||O._defaultColor||T.AnnotationEditor._defaultLineColor],[E.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??O._defaultOpacity))]]}#ed(o){let l=this.thickness;this.addCommands({cmd:()=>{this.thickness=o,this.#eu()},undo:()=>{this.thickness=l,this.#eu()},mustExec:!0,type:E.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#t3(o){let l=this.color;this.addCommands({cmd:()=>{this.color=o,this.#ep()},undo:()=>{this.color=l,this.#ep()},mustExec:!0,type:E.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#ec(o){o/=100;let l=this.opacity;this.addCommands({cmd:()=>{this.opacity=o,this.#ep()},undo:()=>{this.opacity=l,this.#ep()},mustExec:!0,type:E.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){super.rebuild(),null!==this.div&&(this.canvas||(this.#eg(),this.#ef()),this.isAttachedToDOM||(this.parent.add(this),this.#em()),this.#eu())}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#en.disconnect(),this.#en=null,super.remove())}setParent(o){!this.parent&&o?this._uiManager.removeShouldRescale(this):this.parent&&null===o&&this._uiManager.addShouldRescale(this),super.setParent(o)}onScaleChanging(){let[o,l]=this.parentDimensions,S=this.width*o,E=this.height*l;this.setDimensions(S,E)}enableEditMode(){this.#es||null===this.canvas||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",this.#ei),this.canvas.addEventListener("pointerup",this.#ee))}disableEditMode(){this.isInEditMode()&&null!==this.canvas&&(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#ei),this.canvas.removeEventListener("pointerup",this.#ee))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}#eb(){let{parentRotation:o,parentDimensions:[l,S]}=this;switch(o){case 90:return[0,S,S,l];case 180:return[l,S,l,S];case 270:return[l,0,S,l];default:return[0,0,l,S]}}#eA(){let{ctx:o,color:l,opacity:S,thickness:E,parentScale:T,scaleFactor:P}=this;o.lineWidth=E*T/P,o.lineCap="round",o.lineJoin="round",o.miterLimit=10,o.strokeStyle=`${l}${(0,M.opacityToHex)(S)}`}#ev(o,l){this.isEditing=!0,this.#er||(this.#er=!0,this.#em(),this.thickness||=O._defaultThickness,this.color||=O._defaultColor||T.AnnotationEditor._defaultLineColor,this.opacity??=O._defaultOpacity),this.currentPath.push([o,l]),this.#ea=null,this.#eA(),this.ctx.beginPath(),this.ctx.moveTo(o,l),this.#eh=()=>{this.#eh&&(this.#ea&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):this.#ep(),this.ctx.lineTo(...this.#ea),this.#ea=null,this.ctx.stroke()),window.requestAnimationFrame(this.#eh))},window.requestAnimationFrame(this.#eh)}#ey(o,l){let[S,E]=this.currentPath.at(-1);(o!==S||l!==E)&&(this.currentPath.push([o,l]),this.#ea=[o,l])}#e_(o,l){let S;this.ctx.closePath(),this.#eh=null,o=Math.min(Math.max(o,0),this.canvas.width),l=Math.min(Math.max(l,0),this.canvas.height);let[E,T]=this.currentPath.at(-1);if((o!==E||l!==T)&&this.currentPath.push([o,l]),1!==this.currentPath.length)S=(0,P.fitCurve)(this.currentPath,30,null);else{let E=[o,l];S=[[E,E.slice(),E.slice(),E]]}let M=O.#eS(S);this.currentPath.length=0;let F=()=>{this.paths.push(S),this.bezierPath2D.push(M),this.rebuild()},I=()=>{this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||(this.#eg(),this.#ef()),this.#eu())};this.addCommands({cmd:F,undo:I,mustExec:!0})}#ep(){if(this.isEmpty()){this.#ex();return}this.#eA();let{canvas:o,ctx:l}=this;for(let S of(l.setTransform(1,0,0,1,0,0),l.clearRect(0,0,o.width,o.height),this.#ex(),this.bezierPath2D))l.stroke(S)}commit(){this.#es||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#es=!0,this.div.classList.add("disabled"),this.#eu(!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(o){super.focusin(o),this.enableEditMode()}canvasPointerdown(o){0===o.button&&this.isInEditMode()&&!this.#es&&(this.setInForeground(),"mouse"!==o.type&&this.div.focus(),o.stopPropagation(),this.canvas.addEventListener("pointerleave",this.#et),this.canvas.addEventListener("pointermove",this.#t9),this.#ev(o.offsetX,o.offsetY))}canvasPointermove(o){o.stopPropagation(),this.#ey(o.offsetX,o.offsetY)}canvasPointerup(o){0===o.button&&this.isInEditMode()&&0!==this.currentPath.length&&(o.stopPropagation(),this.#eC(o),this.setInBackground())}canvasPointerleave(o){this.#eC(o),this.setInBackground()}#eC(o){this.#e_(o.offsetX,o.offsetY),this.canvas.removeEventListener("pointerleave",this.#et),this.canvas.removeEventListener("pointermove",this.#t9),this.addToAnnotationStorage()}#eg(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",O._l10nPromise.get("editor_ink_canvas_aria_label").then(o=>this.canvas?.setAttribute("aria-label",o)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#ef(){this.#en=new ResizeObserver(o=>{let l=o[0].contentRect;l.width&&l.height&&this.setDimensions(l.width,l.height)}),this.#en.observe(this.div)}render(){let o,l;if(this.div)return this.div;this.width&&(o=this.x,l=this.y),super.render(),O._l10nPromise.get("editor_ink2_aria_label").then(o=>this.div?.setAttribute("aria-label",o));let[S,E,T,P]=this.#eb();if(this.setAt(S,E,0,0),this.setDims(T,P),this.#eg(),this.width){let[S,E]=this.parentDimensions;this.setAt(o*S,l*E,this.width*S,this.height*E),this.#er=!0,this.#em(),this.setDims(this.width*S,this.height*E),this.#ep(),this.#eE(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#ef(),this.div}#em(){if(!this.#er)return;let[o,l]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*o),this.canvas.height=Math.ceil(this.height*l),this.#ex()}setDimensions(o,l){let S=Math.round(o),E=Math.round(l);if(this.#eo===S&&this.#el===E)return;this.#eo=S,this.#el=E,this.canvas.style.visibility="hidden",this.#t8&&Math.abs(this.#t8-o/l)>.01&&(l=Math.ceil(o/this.#t8),this.setDims(o,l));let[T,P]=this.parentDimensions;this.width=o/T,this.height=l/P,this.#es&&this.#eT(o,l),this.#em(),this.#ep(),this.canvas.style.visibility="visible",this.fixDims()}#eT(o,l){let S=this.#eP(),E=(o-S)/this.#t7,T=(l-S)/this.#t6;this.scaleFactor=Math.min(E,T)}#ex(){let o=this.#eP()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+o,this.translationY*this.scaleFactor+o)}static #eS(o){let l=new Path2D;for(let S=0,E=o.length;S<E;S++){let[E,T,P,M]=o[S];0===S&&l.moveTo(...E),l.bezierCurveTo(T[0],T[1],P[0],P[1],M[0],M[1])}return l}#eM(o,l,S,E){let T,P;let M=4,F=[],O=this.thickness/2;for(let I of this.paths){T=[],P=[];for(let F=0,D=I.length;F<D;F++){let[D,L,N,U]=I[F],H=o*(D[0]+l)+O,W=E-o*(D[1]+S)-O,z=o*(L[0]+l)+O,V=E-o*(L[1]+S)-O,$=o*(N[0]+l)+O,K=E-o*(N[1]+S)-O,Y=o*(U[0]+l)+O,J=E-o*(U[1]+S)-O;0===F&&(T.push(H,W),P.push(H,W)),T.push(z,V,$,K,Y,J),this.#ek(H,W,z,V,$,K,Y,J,M,P)}F.push({bezier:T,points:P})}return F}#ek(o,l,S,E,T,P,M,F,O,I){if(this.#ew(o,l,S,E,T,P,M,F)){I.push(M,F);return}for(let D=1;D<O-1;D++){let L=D/O,N=1-L,U=L*o+N*S,H=L*l+N*E,W=L*S+N*T,z=L*E+N*P,V=L*T+N*M,$=L*P+N*F;U=L*U+N*W,H=L*H+N*z,W=L*W+N*V,z=L*z+N*$,U=L*U+N*W,H=L*H+N*z,I.push(U,H)}I.push(M,F)}#ew(o,l,S,E,T,P,M,F){let O=10,I=(3*S-2*o-M)**2,D=(3*E-2*l-F)**2,L=(3*T-o-2*M)**2,N=(3*P-l-2*F)**2;return Math.max(I,L)+Math.max(D,N)<=O}#eR(){let o=1/0,l=-1/0,S=1/0,T=-1/0;for(let P of this.paths)for(let[M,F,O,I]of P){let P=E.Util.bezierBoundingBox(...M,...F,...O,...I);o=Math.min(o,P[0]),S=Math.min(S,P[1]),l=Math.max(l,P[2]),T=Math.max(T,P[3])}return[o,S,l,T]}#eP(){return this.#es?Math.ceil(this.thickness*this.parentScale):0}#eu(o=!1){if(this.isEmpty())return;if(!this.#es){this.#ep();return}let l=this.#eR(),S=this.#eP();this.#t7=Math.max(F,l[2]-l[0]),this.#t6=Math.max(F,l[3]-l[1]);let E=Math.ceil(S+this.#t7*this.scaleFactor),T=Math.ceil(S+this.#t6*this.scaleFactor),[P,M]=this.parentDimensions;this.width=E/P,this.height=T/M,this.#t8=E/T,this.#eE();let O=this.translationX,I=this.translationY;this.translationX=-l[0],this.translationY=-l[1],this.#em(),this.#ep(),this.#eo=E,this.#el=T,this.setDims(E,T);let D=o?S/this.scaleFactor/2:0;this.translate(O-this.translationX-D,I-this.translationY-D)}#eE(){let{style:o}=this.div;this.#t8>=1?(o.minHeight=`${F}px`,o.minWidth=`${Math.round(this.#t8*F)}px`):(o.minWidth=`${F}px`,o.minHeight=`${Math.round(F/this.#t8)}px`)}static deserialize(o,l,S){let T=super.deserialize(o,l,S);T.thickness=o.thickness,T.color=E.Util.makeHexColor(...o.color),T.opacity=o.opacity;let[P,M]=T.pageDimensions,O=T.width*P,I=T.height*M,D=T.parentScale,L=o.thickness/2;for(let{bezier:l}of(T.#t8=O/I,T.#es=!0,T.#eo=Math.round(O),T.#el=Math.round(I),o.paths)){let o=[];T.paths.push(o);let S=D*(l[0]-L),E=D*(I-l[1]-L);for(let T=2,P=l.length;T<P;T+=6){let P=D*(l[T]-L),M=D*(I-l[T+1]-L),F=D*(l[T+2]-L),O=D*(I-l[T+3]-L),N=D*(l[T+4]-L),U=D*(I-l[T+5]-L);o.push([[S,E],[P,M],[F,O],[N,U]]),S=N,E=U}let P=this.#eS(o);T.bezierPath2D.push(P)}let N=T.#eR();return T.#t7=Math.max(F,N[2]-N[0]),T.#t6=Math.max(F,N[3]-N[1]),T.#eT(O,I),T}serialize(){if(this.isEmpty())return null;let o=this.getRect(0,0),l=this.rotation%180==0?o[3]-o[1]:o[2]-o[0],S=T.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:E.AnnotationEditorType.INK,color:S,thickness:this.thickness,opacity:this.opacity,paths:this.#eM(this.scaleFactor/this.parentScale,this.translationX,this.translationY,l),pageIndex:this.pageIndex,rect:o,rotation:this.rotation}}}l.InkEditor=O},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.fitCurve=void 0;let E=S(31);l.fitCurve=E},o=>{function l(o,l,E){if(!Array.isArray(o))throw TypeError("First argument should be an array");if(o.forEach(l=>{if(!Array.isArray(l)||l.some(o=>"number"!=typeof o)||l.length!==o[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),(o=o.filter((l,S)=>0===S||!l.every((l,E)=>l===o[S-1][E]))).length<2)return[];let T=o.length,P=L(o[1],o[0]),M=L(o[T-2],o[T-1]);return S(o,P,M,l,E)}function S(o,l,T,M,O){var I,D,L,U,H,W,z,V,$,K,Y,J,Q;let Z=20;if(2===o.length)return J=N.vectorLen(N.subtract(o[0],o[1]))/3,[I=[o[0],N.addArrays(o[0],N.mulItems(l,J)),N.addArrays(o[1],N.mulItems(T,J)),o[1]]];if(D=F(o),[I,U,W]=E(o,D,D,l,T,O),0===U||U<M)return[I];if(U<M*M)for(Q=0,L=D,H=U,z=W;Q<Z;Q++){if(L=P(I,o,L),[I,U,W]=E(o,D,L,l,T,O),U<M)return[I];if(W===z){let o=U/H;if(o>.9999&&o<1.0001)break}H=U,z=W}return Y=[],(V=N.subtract(o[W-1],o[W+1])).every(o=>0===o)&&(V=N.subtract(o[W-1],o[W]),[V[0],V[1]]=[-V[1],V[0]]),$=N.normalize(V),K=N.mulItems($,-1),Y=(Y=Y.concat(S(o.slice(0,W+1),l,$,M,O))).concat(S(o.slice(W),K,T,M,O))}function E(o,l,S,E,P,M){var F,I,D;return F=T(o,S,E,P,M),[I,D]=O(o,F,l),M&&M({bez:F,points:o,params:l,maxErr:I,maxPoint:D}),[F,I,D]}function T(o,l,S,E){var T,P,M,F,O,I,D,L,H,W,z,V,$,K,Y,J,Q,Z=o[0],tt=o[o.length-1];for($=0,T=[Z,null,null,tt],P=N.zeros_Xx2x2(l.length),K=l.length;$<K;$++)Q=1-(J=l[$]),(M=P[$])[0]=N.mulItems(S,3*J*(Q*Q)),M[1]=N.mulItems(E,3*Q*(J*J));for($=0,F=[[0,0],[0,0]],O=[0,0],K=o.length;$<K;$++)J=l[$],M=P[$],F[0][0]+=N.dot(M[0],M[0]),F[0][1]+=N.dot(M[0],M[1]),F[1][0]+=N.dot(M[0],M[1]),F[1][1]+=N.dot(M[1],M[1]),Y=N.subtract(o[$],U.q([Z,Z,tt,tt],J)),O[0]+=N.dot(M[0],Y),O[1]+=N.dot(M[1],Y);return I=F[0][0]*F[1][1]-F[1][0]*F[0][1],D=F[0][0]*O[1]-F[1][0]*O[0],L=O[0]*F[1][1]-O[1]*F[0][1],H=0===I?0:L/I,W=0===I?0:D/I,H<(z=1e-6*(V=N.vectorLen(N.subtract(Z,tt))))||W<z?(T[1]=N.addArrays(Z,N.mulItems(S,V/3)),T[2]=N.addArrays(tt,N.mulItems(E,V/3))):(T[1]=N.addArrays(Z,N.mulItems(S,H)),T[2]=N.addArrays(tt,N.mulItems(E,W))),T}function P(o,l,S){return S.map((S,E)=>M(o,l[E],S))}function M(o,l,S){var E=N.subtract(U.q(o,S),l),T=U.qprime(o,S),P=N.mulMatrix(E,T),M=N.sum(N.squareItems(T))+2*N.mulMatrix(E,U.qprimeprime(o,S));return 0===M?S:S-P/M}function F(o){var l,S,E,T=[];return o.forEach((o,P)=>{l=P?S+N.vectorLen(N.subtract(o,E)):0,T.push(l),S=l,E=o}),T=T.map(o=>o/S)}function O(o,l,S){var E,T,P,M,F,O,L,H;T=0,P=Math.floor(o.length/2);let W=I(l,10);for(F=0,O=o.length;F<O;F++)L=o[F],H=D(l,S[F],W,10),(E=(M=N.subtract(U.q(l,H),L))[0]*M[0]+M[1]*M[1])>T&&(T=E,P=F);return[T,P]}var I=function(o,l){for(var S,E=[0],T=o[0],P=0,M=1;M<=l;M++)S=U.q(o,M/l),E.push(P+=N.vectorLen(N.subtract(S,T))),T=S;return E.map(o=>o/P)};function D(o,l,S,E){if(l<0)return 0;if(l>1)return 1;for(var T,P,M,F,O=1;O<=E;O++)if(l<=S[O]){M=(O-1)/E,P=O/E,F=(l-(T=S[O-1]))/(S[O]-T)*(P-M)+M;break}return F}function L(o,l){return N.normalize(N.subtract(o,l))}class N{static zeros_Xx2x2(o){for(var l=[];o--;)l.push([0,0]);return l}static mulItems(o,l){return o.map(o=>o*l)}static mulMatrix(o,l){return o.reduce((o,S,E)=>o+S*l[E],0)}static subtract(o,l){return o.map((o,S)=>o-l[S])}static addArrays(o,l){return o.map((o,S)=>o+l[S])}static addItems(o,l){return o.map(o=>o+l)}static sum(o){return o.reduce((o,l)=>o+l)}static dot(o,l){return N.mulMatrix(o,l)}static vectorLen(o){return Math.hypot(...o)}static divItems(o,l){return o.map(o=>o/l)}static squareItems(o){return o.map(o=>o*o)}static normalize(o){return this.divItems(o,this.vectorLen(o))}}class U{static q(o,l){var S=1-l,E=N.mulItems(o[0],S*S*S),T=N.mulItems(o[1],3*S*S*l),P=N.mulItems(o[2],3*S*l*l),M=N.mulItems(o[3],l*l*l);return N.addArrays(N.addArrays(E,T),N.addArrays(P,M))}static qprime(o,l){var S=1-l,E=N.mulItems(N.subtract(o[1],o[0]),3*S*S),T=N.mulItems(N.subtract(o[2],o[1]),6*S*l),P=N.mulItems(N.subtract(o[3],o[2]),3*l*l);return N.addArrays(N.addArrays(E,T),P)}static qprimeprime(o,l){return N.addArrays(N.mulItems(N.addArrays(N.subtract(o[2],N.mulItems(o[1],2)),o[0]),6*(1-l)),N.mulItems(N.addArrays(N.subtract(o[3],N.mulItems(o[2],2)),o[1]),6*l))}}o.exports=l,o.exports.fitCubic=S,o.exports.createTangent=L},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.AnnotationLayer=void 0;var E=S(1),T=S(6),P=S(3),M=S(33),F=S(34);let O=1e3,I=9,D=new WeakSet;function L(o){return{width:o[2]-o[0],height:o[3]-o[1]}}class N{static create(o){let l=o.data.annotationType;switch(l){case E.AnnotationType.LINK:return new H(o);case E.AnnotationType.TEXT:return new W(o);case E.AnnotationType.WIDGET:let S=o.data.fieldType;switch(S){case"Tx":return new V(o);case"Btn":if(o.data.radioButton)return new K(o);if(o.data.checkBox)return new $(o);return new Y(o);case"Ch":return new J(o)}return new z(o);case E.AnnotationType.POPUP:return new Q(o);case E.AnnotationType.FREETEXT:return new tt(o);case E.AnnotationType.LINE:return new te(o);case E.AnnotationType.SQUARE:return new ti(o);case E.AnnotationType.CIRCLE:return new ts(o);case E.AnnotationType.POLYLINE:return new tr(o);case E.AnnotationType.CARET:return new tn(o);case E.AnnotationType.INK:return new to(o);case E.AnnotationType.POLYGON:return new ta(o);case E.AnnotationType.HIGHLIGHT:return new tl(o);case E.AnnotationType.UNDERLINE:return new th(o);case E.AnnotationType.SQUIGGLY:return new td(o);case E.AnnotationType.STRIKEOUT:return new tc(o);case E.AnnotationType.STAMP:return new tu(o);case E.AnnotationType.FILEATTACHMENT:return new tp(o);default:return new U(o)}}}class U{constructor(o,{isRenderable:l=!1,ignoreBorder:S=!1,createQuadrilaterals:E=!1}={}){this.isRenderable=l,this.data=o.data,this.layer=o.layer,this.page=o.page,this.viewport=o.viewport,this.linkService=o.linkService,this.downloadManager=o.downloadManager,this.imageResourcesPath=o.imageResourcesPath,this.renderForms=o.renderForms,this.svgFactory=o.svgFactory,this.annotationStorage=o.annotationStorage,this.enableScripting=o.enableScripting,this.hasJSActions=o.hasJSActions,this._fieldObjects=o.fieldObjects,l&&(this.container=this._createContainer(S)),E&&(this.quadrilaterals=this._createQuadrilaterals(S))}_createContainer(o=!1){let{data:l,page:S,viewport:T}=this,P=document.createElement("section");P.setAttribute("data-annotation-id",l.id),l.noRotate&&P.classList.add("norotate");let{pageWidth:M,pageHeight:F,pageX:O,pageY:I}=T.rawDims,{width:D,height:N}=L(l.rect),U=E.Util.normalizeRect([l.rect[0],S.view[3]-l.rect[1]+S.view[1],l.rect[2],S.view[3]-l.rect[3]+S.view[1]]);if(!o&&l.borderStyle.width>0){P.style.borderWidth=`${l.borderStyle.width}px`;let o=l.borderStyle.horizontalCornerRadius,S=l.borderStyle.verticalCornerRadius;if(o>0||S>0){let l=`calc(${o}px * var(--scale-factor)) / calc(${S}px * var(--scale-factor))`;P.style.borderRadius=l}else if(this instanceof K){let o=`calc(${D}px * var(--scale-factor)) / calc(${N}px * var(--scale-factor))`;P.style.borderRadius=o}switch(l.borderStyle.style){case E.AnnotationBorderStyleType.SOLID:P.style.borderStyle="solid";break;case E.AnnotationBorderStyleType.DASHED:P.style.borderStyle="dashed";break;case E.AnnotationBorderStyleType.BEVELED:(0,E.warn)("Unimplemented border style: beveled");break;case E.AnnotationBorderStyleType.INSET:(0,E.warn)("Unimplemented border style: inset");break;case E.AnnotationBorderStyleType.UNDERLINE:P.style.borderBottomStyle="solid"}let T=l.borderColor||null;T?P.style.borderColor=E.Util.makeHexColor(0|T[0],0|T[1],0|T[2]):P.style.borderWidth=0}P.style.left=`${100*(U[0]-O)/M}%`,P.style.top=`${100*(U[1]-I)/F}%`;let{rotation:H}=l;return l.hasOwnCanvas||0===H?(P.style.width=`${100*D/M}%`,P.style.height=`${100*N/F}%`):this.setRotation(H,P),P}setRotation(o,l=this.container){let S,E;let{pageWidth:T,pageHeight:P}=this.viewport.rawDims,{width:M,height:F}=L(this.data.rect);o%180==0?(S=100*M/T,E=100*F/P):(S=100*F/T,E=100*M/P),l.style.width=`${S}%`,l.style.height=`${E}%`,l.setAttribute("data-main-rotation",(360-o)%360)}get _commonActions(){let o=(o,l,S)=>{let E=S.detail[o];S.target.style[l]=M.ColorConverters[`${E[0]}_HTML`](E.slice(1))};return(0,E.shadow)(this,"_commonActions",{display:o=>{let l=o.detail.display%2==1;this.container.style.visibility=l?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:l,print:0===o.detail.display||3===o.detail.display})},print:o=>{this.annotationStorage.setValue(this.data.id,{print:o.detail.print})},hidden:o=>{this.container.style.visibility=o.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:o.detail.hidden})},focus:o=>{setTimeout(()=>o.target.focus({preventScroll:!1}),0)},userName:o=>{o.target.title=o.detail.userName},readonly:o=>{o.detail.readonly?o.target.setAttribute("readonly",""):o.target.removeAttribute("readonly")},required:o=>{this._setRequired(o.target,o.detail.required)},bgColor:l=>{o("bgColor","backgroundColor",l)},fillColor:l=>{o("fillColor","backgroundColor",l)},fgColor:l=>{o("fgColor","color",l)},textColor:l=>{o("textColor","color",l)},borderColor:l=>{o("borderColor","borderColor",l)},strokeColor:l=>{o("strokeColor","borderColor",l)},rotation:o=>{let l=o.detail.rotation;this.setRotation(l),this.annotationStorage.setValue(this.data.id,{rotation:l})}})}_dispatchEventFromSandbox(o,l){let S=this._commonActions;for(let E of Object.keys(l.detail)){let T=o[E]||S[E];T?.(l)}}_setDefaultPropertiesFromJS(o){if(!this.enableScripting)return;let l=this.annotationStorage.getRawValue(this.data.id);if(!l)return;let S=this._commonActions;for(let[E,T]of Object.entries(l)){let P=S[E];if(P){let S={detail:{[E]:T},target:o};P(S),delete l[E]}}}_createQuadrilaterals(o=!1){if(!this.data.quadPoints)return null;let l=[],S=this.data.rect;for(let S of this.data.quadPoints)this.data.rect=[S[2].x,S[2].y,S[1].x,S[1].y],l.push(this._createContainer(o));return this.data.rect=S,l}_createPopup(o,l){let S=this.container;this.quadrilaterals&&(o||=this.quadrilaterals,S=this.quadrilaterals[0]),o||((o=document.createElement("div")).classList.add("popupTriggerArea"),S.append(o));let E=new Z({container:S,trigger:o,color:l.color,titleObj:l.titleObj,modificationDate:l.modificationDate,contentsObj:l.contentsObj,richText:l.richText,hideWrapper:!0}),T=E.render();T.style.left="100%",S.append(T)}_renderQuadrilaterals(o){for(let l of this.quadrilaterals)l.classList.add(o);return this.quadrilaterals}render(){(0,E.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(o,l=null){let S=[];if(this._fieldObjects){let T=this._fieldObjects[o];if(T)for(let{page:o,id:P,exportValues:M}of T){if(-1===o||P===l)continue;let T="string"==typeof M?M:null,F=document.querySelector(`[data-element-id="${P}"]`);if(F&&!D.has(F)){(0,E.warn)(`_getElementsByName - element not allowed: ${P}`);continue}S.push({id:P,exportValue:T,domElement:F})}return S}for(let E of document.getElementsByName(o)){let{exportValue:o}=E,T=E.getAttribute("data-element-id");T!==l&&D.has(E)&&S.push({id:T,exportValue:o,domElement:E})}return S}}class H extends U{constructor(o,l=null){super(o,{isRenderable:!0,ignoreBorder:!!l?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=o.data.isTooltipOnly}render(){let{data:o,linkService:l}=this,S=document.createElement("a");S.setAttribute("data-element-id",o.id);let E=!1;return(o.url?(l.addLinkAttributes(S,o.url,o.newWindow),E=!0):o.action?(this._bindNamedAction(S,o.action),E=!0):o.attachment?(this._bindAttachment(S,o.attachment),E=!0):o.setOCGState?(this.#eF(S,o.setOCGState),E=!0):o.dest?(this._bindLink(S,o.dest),E=!0):(o.actions&&(o.actions.Action||o.actions["Mouse Up"]||o.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(S,o),E=!0),o.resetForm?(this._bindResetFormAction(S,o.resetForm),E=!0):this.isTooltipOnly&&!E&&(this._bindLink(S,""),E=!0)),this.quadrilaterals)?this._renderQuadrilaterals("linkAnnotation").map((o,l)=>{let E=0===l?S:S.cloneNode();return o.append(E),o}):(this.container.classList.add("linkAnnotation"),E&&this.container.append(S),this.container)}#eO(){this.container.setAttribute("data-internal-link","")}_bindLink(o,l){o.href=this.linkService.getDestinationHash(l),o.onclick=()=>(l&&this.linkService.goToDestination(l),!1),(l||""===l)&&this.#eO()}_bindNamedAction(o,l){o.href=this.linkService.getAnchorUrl(""),o.onclick=()=>(this.linkService.executeNamedAction(l),!1),this.#eO()}_bindAttachment(o,l){o.href=this.linkService.getAnchorUrl(""),o.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,l.content,l.filename),!1),this.#eO()}#eF(o,l){o.href=this.linkService.getAnchorUrl(""),o.onclick=()=>(this.linkService.executeSetOCGState(l),!1),this.#eO()}_bindJSAction(o,l){o.href=this.linkService.getAnchorUrl("");let S=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(let E of Object.keys(l.actions)){let T=S.get(E);T&&(o[T]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l.id,name:E}}),!1))}o.onclick||(o.onclick=()=>!1),this.#eO()}_bindResetFormAction(o,l){let S=o.onclick;if(S||(o.href=this.linkService.getAnchorUrl("")),this.#eO(),!this._fieldObjects){(0,E.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),S||(o.onclick=()=>!1);return}o.onclick=()=>{S?.();let{fields:o,refs:T,include:P}=l,M=[];if(0!==o.length||0!==T.length){let l=new Set(T);for(let S of o){let o=this._fieldObjects[S]||[];for(let{id:S}of o)l.add(S)}for(let o of Object.values(this._fieldObjects))for(let S of o)l.has(S.id)===P&&M.push(S)}else for(let o of Object.values(this._fieldObjects))M.push(...o);let F=this.annotationStorage,O=[];for(let o of M){let{id:l}=o;switch(O.push(l),o.type){case"text":{let S=o.defaultValue||"";F.setValue(l,{value:S});break}case"checkbox":case"radiobutton":{let S=o.defaultValue===o.exportValues;F.setValue(l,{value:S});break}case"combobox":case"listbox":{let S=o.defaultValue||"";F.setValue(l,{value:S});break}default:continue}let S=document.querySelector(`[data-element-id="${l}"]`);if(S){if(!D.has(S)){(0,E.warn)(`_bindResetFormAction - element not allowed: ${l}`);continue}S.dispatchEvent(new Event("resetform"))}}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:O,name:"ResetForm"}}),!1}}}class W extends U{constructor(o){let l=!!(o.data.hasPopup||o.data.titleObj?.str||o.data.contentsObj?.str||o.data.richText?.str);super(o,{isRenderable:l})}render(){this.container.classList.add("textAnnotation");let o=document.createElement("img");return o.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",o.alt="[{{type}} Annotation]",o.dataset.l10nId="text_annotation_type",o.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(o,this.data),this.container.append(o),this.container}}class z extends U{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(o){this.data.hasOwnCanvas&&(o.previousSibling?.nodeName==="CANVAS"&&(o.previousSibling.hidden=!0),o.hidden=!1)}_getKeyModifier(o){let{isWin:l,isMac:S}=E.FeatureTest.platform;return l&&o.ctrlKey||S&&o.metaKey}_setEventListener(o,l,S,E){l.includes("mouse")?o.addEventListener(l,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:S,value:E(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):o.addEventListener(l,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:S,value:E(o)}})})}_setEventListeners(o,l,S){for(let[E,T]of l)("Action"===T||this.data.actions?.[T])&&this._setEventListener(o,E,T,S)}_setBackgroundColor(o){let l=this.data.backgroundColor||null;o.style.backgroundColor=null===l?"transparent":E.Util.makeHexColor(l[0],l[1],l[2])}_setTextStyle(o){let l;let S=["left","center","right"],{fontColor:T}=this.data.defaultAppearanceData,P=this.data.defaultAppearanceData.fontSize||I,M=o.style,F=2,O=o=>Math.round(10*o)/10;if(this.data.multiLine){let o=Math.abs(this.data.rect[3]-this.data.rect[1]-F),S=Math.round(o/(E.LINE_FACTOR*P))||1,T=o/S;l=Math.min(P,O(T/E.LINE_FACTOR))}else{let o=Math.abs(this.data.rect[3]-this.data.rect[1]-F);l=Math.min(P,O(o/E.LINE_FACTOR))}M.fontSize=`calc(${l}px * var(--scale-factor))`,M.color=E.Util.makeHexColor(T[0],T[1],T[2]),null!==this.data.textAlignment&&(M.textAlign=S[this.data.textAlignment])}_setRequired(o,l){l?o.setAttribute("required",!0):o.removeAttribute("required"),o.setAttribute("aria-required",l)}}class V extends z{constructor(o){let l=o.renderForms||!o.data.hasAppearance&&!!o.data.fieldValue;super(o,{isRenderable:l})}setPropertyOnSiblings(o,l,S,E){let T=this.annotationStorage;for(let P of this._getElementsByName(o.name,o.id))P.domElement&&(P.domElement[l]=S),T.setValue(P.id,{[E]:S})}render(){let o=this.annotationStorage,l=this.data.id;this.container.classList.add("textWidgetAnnotation");let S=null;if(this.renderForms){let E=o.getValue(l,{value:this.data.fieldValue}),T=E.formattedValue||E.value||"",P=o.getValue(l,{charLimit:this.data.maxLen}).charLimit;P&&T.length>P&&(T=T.slice(0,P));let M={userValue:T,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?((S=document.createElement("textarea")).textContent=T,this.data.doNotScroll&&(S.style.overflowY="hidden")):((S=document.createElement("input")).type="text",S.setAttribute("value",T),this.data.doNotScroll&&(S.style.overflowX="hidden")),this.data.hasOwnCanvas&&(S.hidden=!0),D.add(S),S.setAttribute("data-element-id",l),S.disabled=this.data.readOnly,S.name=this.data.fieldName,S.tabIndex=O,this._setRequired(S,this.data.required),P&&(S.maxLength=P),S.addEventListener("input",E=>{o.setValue(l,{value:E.target.value}),this.setPropertyOnSiblings(S,"value",E.target.value,"value")}),S.addEventListener("resetform",o=>{let l=this.data.defaultFieldValue??"";S.value=M.userValue=l,M.formattedValue=null});let F=o=>{let{formattedValue:l}=M;null!=l&&(o.target.value=l),o.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){S.addEventListener("focus",o=>{let{target:l}=o;M.userValue&&(l.value=M.userValue),M.lastCommittedValue=l.value,M.commitKey=1}),S.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);let E={value(S){M.userValue=S.detail.value??"",o.setValue(l,{value:M.userValue.toString()}),S.target.value=M.userValue},formattedValue(S){let{formattedValue:E}=S.detail;M.formattedValue=E,null!=E&&S.target!==document.activeElement&&(S.target.value=E),o.setValue(l,{formattedValue:E})},selRange(o){o.target.setSelectionRange(...o.detail.selRange)},charLimit:S=>{let{charLimit:E}=S.detail,{target:T}=S;if(0===E){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",E);let P=M.userValue;P&&!(P.length<=E)&&(P=P.slice(0,E),T.value=M.userValue=P,o.setValue(l,{value:P}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:P,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(E,S)}),S.addEventListener("keydown",o=>{M.commitKey=1;let S=-1;if("Escape"===o.key?S=0:"Enter"!==o.key||this.data.multiLine?"Tab"===o.key&&(M.commitKey=3):S=2,-1===S)return;let{value:E}=o.target;M.lastCommittedValue!==E&&(M.lastCommittedValue=E,M.userValue=E,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:E,willCommit:!0,commitKey:S,selStart:o.target.selectionStart,selEnd:o.target.selectionEnd}}))});let E=F;F=null,S.addEventListener("blur",o=>{if(!o.relatedTarget)return;let{value:S}=o.target;M.userValue=S,M.lastCommittedValue!==S&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:S,willCommit:!0,commitKey:M.commitKey,selStart:o.target.selectionStart,selEnd:o.target.selectionEnd}}),E(o)}),this.data.actions?.Keystroke&&S.addEventListener("beforeinput",o=>{M.lastCommittedValue=null;let{data:S,target:E}=o,{value:T,selectionStart:P,selectionEnd:F}=E,O=P,I=F;switch(o.inputType){case"deleteWordBackward":{let o=T.substring(0,P).match(/\w*[^\w]*$/);o&&(O-=o[0].length);break}case"deleteWordForward":{let o=T.substring(P).match(/^[^\w]*\w*/);o&&(I+=o[0].length);break}case"deleteContentBackward":P===F&&(O-=1);break;case"deleteContentForward":P===F&&(I+=1)}o.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:T,change:S||"",willCommit:!1,selStart:O,selEnd:I}})}),this._setEventListeners(S,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.value)}if(F&&S.addEventListener("blur",F),this.data.comb){let o=this.data.rect[2]-this.data.rect[0],l=o/P;S.classList.add("comb"),S.style.letterSpacing=`calc(${l}px * var(--scale-factor) - 1ch)`}}else(S=document.createElement("div")).textContent=this.data.fieldValue,S.style.verticalAlign="middle",S.style.display="table-cell";return this._setTextStyle(S),this._setBackgroundColor(S),this._setDefaultPropertiesFromJS(S),this.container.append(S),this.container}}class $ extends z{constructor(o){super(o,{isRenderable:o.renderForms})}render(){let o=this.annotationStorage,l=this.data,S=l.id,E=o.getValue(S,{value:l.exportValue===l.fieldValue}).value;"string"==typeof E&&(E="Off"!==E,o.setValue(S,{value:E})),this.container.classList.add("buttonWidgetAnnotation","checkBox");let T=document.createElement("input");return D.add(T),T.setAttribute("data-element-id",S),T.disabled=l.readOnly,this._setRequired(T,this.data.required),T.type="checkbox",T.name=l.fieldName,E&&T.setAttribute("checked",!0),T.setAttribute("exportValue",l.exportValue),T.tabIndex=O,T.addEventListener("change",E=>{let{name:T,checked:P}=E.target;for(let E of this._getElementsByName(T,S)){let S=P&&E.exportValue===l.exportValue;E.domElement&&(E.domElement.checked=S),o.setValue(E.id,{value:S})}o.setValue(S,{value:P})}),T.addEventListener("resetform",o=>{let S=l.defaultFieldValue||"Off";o.target.checked=S===l.exportValue}),this.enableScripting&&this.hasJSActions&&(T.addEventListener("updatefromsandbox",l=>{let E={value(l){l.target.checked="Off"!==l.detail.value,o.setValue(S,{value:l.target.checked})}};this._dispatchEventFromSandbox(E,l)}),this._setEventListeners(T,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(T),this._setDefaultPropertiesFromJS(T),this.container.append(T),this.container}}class K extends z{constructor(o){super(o,{isRenderable:o.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");let o=this.annotationStorage,l=this.data,S=l.id,E=o.getValue(S,{value:l.fieldValue===l.buttonValue}).value;"string"==typeof E&&(E=E!==l.buttonValue,o.setValue(S,{value:E}));let T=document.createElement("input");if(D.add(T),T.setAttribute("data-element-id",S),T.disabled=l.readOnly,this._setRequired(T,this.data.required),T.type="radio",T.name=l.fieldName,E&&T.setAttribute("checked",!0),T.tabIndex=O,T.addEventListener("change",l=>{let{name:E,checked:T}=l.target;for(let l of this._getElementsByName(E,S))o.setValue(l.id,{value:!1});o.setValue(S,{value:T})}),T.addEventListener("resetform",o=>{let S=l.defaultFieldValue;o.target.checked=null!=S&&S===l.buttonValue}),this.enableScripting&&this.hasJSActions){let E=l.buttonValue;T.addEventListener("updatefromsandbox",l=>{let T={value:l=>{let T=E===l.detail.value;for(let E of this._getElementsByName(l.target.name)){let l=T&&E.id===S;E.domElement&&(E.domElement.checked=l),o.setValue(E.id,{value:l})}}};this._dispatchEventFromSandbox(T,l)}),this._setEventListeners(T,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(T),this._setDefaultPropertiesFromJS(T),this.container.append(T),this.container}}class Y extends H{constructor(o){super(o,{ignoreBorder:o.data.hasAppearance})}render(){let o=super.render();o.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(o.title=this.data.alternativeText);let l=o.lastChild;return this.enableScripting&&this.hasJSActions&&l&&(this._setDefaultPropertiesFromJS(l),l.addEventListener("updatefromsandbox",o=>{this._dispatchEventFromSandbox({},o)})),o}}class J extends z{constructor(o){super(o,{isRenderable:o.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");let o=this.annotationStorage,l=this.data.id,S=o.getValue(l,{value:this.data.fieldValue}),E=document.createElement("select");D.add(E),E.setAttribute("data-element-id",l),E.disabled=this.data.readOnly,this._setRequired(E,this.data.required),E.name=this.data.fieldName,E.tabIndex=O;let T=this.data.combo&&this.data.options.length>0;for(let o of(!this.data.combo&&(E.size=this.data.options.length,this.data.multiSelect&&(E.multiple=!0)),E.addEventListener("resetform",o=>{let l=this.data.defaultFieldValue;for(let o of E.options)o.selected=o.value===l}),this.data.options)){let l=document.createElement("option");l.textContent=o.displayValue,l.value=o.exportValue,S.value.includes(o.exportValue)&&(l.setAttribute("selected",!0),T=!1),E.append(l)}let P=null;if(T){let o=document.createElement("option");o.value=" ",o.setAttribute("hidden",!0),o.setAttribute("selected",!0),E.prepend(o),P=()=>{o.remove(),E.removeEventListener("input",P),P=null},E.addEventListener("input",P)}let M=o=>{let l=o?"value":"textContent",{options:S,multiple:T}=E;return T?Array.prototype.filter.call(S,o=>o.selected).map(o=>o[l]):-1===S.selectedIndex?null:S[S.selectedIndex][l]},F=M(!1),I=o=>{let l=o.target.options;return Array.prototype.map.call(l,o=>({displayValue:o.textContent,exportValue:o.value}))};return this.enableScripting&&this.hasJSActions?(E.addEventListener("updatefromsandbox",S=>{let T={value(S){P?.();let T=S.detail.value,O=new Set(Array.isArray(T)?T:[T]);for(let o of E.options)o.selected=O.has(o.value);o.setValue(l,{value:M(!0)}),F=M(!1)},multipleSelection(o){E.multiple=!0},remove(S){let T=E.options,P=S.detail.remove;if(T[P].selected=!1,E.remove(P),T.length>0){let o=Array.prototype.findIndex.call(T,o=>o.selected);-1===o&&(T[0].selected=!0)}o.setValue(l,{value:M(!0),items:I(S)}),F=M(!1)},clear(S){for(;0!==E.length;)E.remove(0);o.setValue(l,{value:null,items:[]}),F=M(!1)},insert(S){let{index:T,displayValue:P,exportValue:O}=S.detail.insert,D=E.children[T],L=document.createElement("option");L.textContent=P,L.value=O,D?D.before(L):E.append(L),o.setValue(l,{value:M(!0),items:I(S)}),F=M(!1)},items(S){let{items:T}=S.detail;for(;0!==E.length;)E.remove(0);for(let o of T){let{displayValue:l,exportValue:S}=o,T=document.createElement("option");T.textContent=l,T.value=S,E.append(T)}E.options.length>0&&(E.options[0].selected=!0),o.setValue(l,{value:M(!0),items:I(S)}),F=M(!1)},indices(S){let E=new Set(S.detail.indices);for(let o of S.target.options)o.selected=E.has(o.index);o.setValue(l,{value:M(!0)}),F=M(!1)},editable(o){o.target.disabled=!o.detail.editable}};this._dispatchEventFromSandbox(T,S)}),E.addEventListener("input",S=>{let E=M(!0);o.setValue(l,{value:E}),S.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:F,changeEx:E,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(E,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],o=>o.target.value)):E.addEventListener("input",function(S){o.setValue(l,{value:M(!0)})}),this.data.combo&&this._setTextStyle(E),this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class Q extends U{static IGNORE_TYPES=new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]);constructor(o){let{data:l}=o,S=!Q.IGNORE_TYPES.has(l.parentType)&&!!(l.titleObj?.str||l.contentsObj?.str||l.richText?.str);super(o,{isRenderable:S})}render(){this.container.classList.add("popupAnnotation");let o=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(0===o.length)return this.container;let l=new Z({container:this.container,trigger:Array.from(o),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),S=this.page,T=E.Util.normalizeRect([this.data.parentRect[0],S.view[3]-this.data.parentRect[1]+S.view[1],this.data.parentRect[2],S.view[3]-this.data.parentRect[3]+S.view[1]]),P=T[0]+this.data.parentRect[2]-this.data.parentRect[0],M=T[1],{pageWidth:F,pageHeight:O,pageX:I,pageY:D}=this.viewport.rawDims;return this.container.style.left=`${100*(P-I)/F}%`,this.container.style.top=`${100*(M-D)/O}%`,this.container.append(l.render()),this.container}}class Z{constructor(o){this.container=o.container,this.trigger=o.trigger,this.color=o.color,this.titleObj=o.titleObj,this.modificationDate=o.modificationDate,this.contentsObj=o.contentsObj,this.richText=o.richText,this.hideWrapper=o.hideWrapper||!1,this.pinned=!1}render(){let o=.7,l=document.createElement("div");l.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?l:this.container,this.hideElement.hidden=!0;let S=document.createElement("div");S.classList.add("popup");let P=this.color;if(P){let l=o*(255-P[0])+P[0],T=o*(255-P[1])+P[1],M=o*(255-P[2])+P[2];S.style.backgroundColor=E.Util.makeHexColor(0|l,0|T,0|M)}let M=document.createElement("h1");M.dir=this.titleObj.dir,M.textContent=this.titleObj.str,S.append(M);let O=T.PDFDateString.toDateObject(this.modificationDate);if(O){let o=document.createElement("span");o.classList.add("popupDate"),o.textContent="{{date}}, {{time}}",o.dataset.l10nId="annotation_date_string",o.dataset.l10nArgs=JSON.stringify({date:O.toLocaleDateString(),time:O.toLocaleTimeString()}),S.append(o)}if(this.richText?.str&&(!this.contentsObj?.str||this.contentsObj.str===this.richText.str))F.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:S}),S.lastChild.classList.add("richText","popupContent");else{let o=this._formatContents(this.contentsObj);S.append(o)}for(let o of(Array.isArray(this.trigger)||(this.trigger=[this.trigger]),this.trigger))o.addEventListener("click",this._toggle.bind(this)),o.addEventListener("mouseover",this._show.bind(this,!1)),o.addEventListener("mouseout",this._hide.bind(this,!1));return S.addEventListener("click",this._hide.bind(this,!0)),l.append(S),l}_formatContents({str:o,dir:l}){let S=document.createElement("p");S.classList.add("popupContent"),S.dir=l;let E=o.split(/(?:\r\n?|\n)/);for(let o=0,l=E.length;o<l;++o){let T=E[o];S.append(document.createTextNode(T)),o<l-1&&S.append(document.createElement("br"))}return S}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(o=!1){o&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(o=!0){o&&(this.pinned=!1),this.hideElement.hidden||this.pinned||(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class tt extends U{constructor(o){let l=!!(o.data.hasPopup||o.data.titleObj?.str||o.data.contentsObj?.str||o.data.richText?.str);super(o,{isRenderable:l,ignoreBorder:!0}),this.textContent=o.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){let o=document.createElement("div");for(let l of(o.classList.add("annotationTextContent"),o.setAttribute("role","comment"),this.textContent)){let S=document.createElement("span");S.textContent=l,o.append(S)}this.container.append(o)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class te extends U{constructor(o){let l=!!(o.data.hasPopup||o.data.titleObj?.str||o.data.contentsObj?.str||o.data.richText?.str);super(o,{isRenderable:l,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");let o=this.data,{width:l,height:S}=L(o.rect),E=this.svgFactory.create(l,S,!0),T=this.svgFactory.createElement("svg:line");return T.setAttribute("x1",o.rect[2]-o.lineCoordinates[0]),T.setAttribute("y1",o.rect[3]-o.lineCoordinates[1]),T.setAttribute("x2",o.rect[2]-o.lineCoordinates[2]),T.setAttribute("y2",o.rect[3]-o.lineCoordinates[3]),T.setAttribute("stroke-width",o.borderStyle.width||1),T.setAttribute("stroke","transparent"),T.setAttribute("fill","transparent"),E.append(T),this.container.append(E),this._createPopup(T,o),this.container}}class ti extends U{constructor(o){let l=!!(o.data.hasPopup||o.data.titleObj?.str||o.data.contentsObj?.str||o.data.richText?.str);super(o,{isRenderable:l,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");let o=this.data,{width:l,height:S}=L(o.rect),E=this.svgFactory.create(l,S,!0),T=o.borderStyle.width,P=this.svgFactory.createElement("svg:rect");return P.setAttribute("x",T/2),P.setAttribute("y",T/2),P.setAttribute("width",l-T),P.setAttribute("height",S-T),P.setAttribute("stroke-width",T||1),P.setAttribute("stroke","transparent"),P.setAttribute("fill","transparent"),E.append(P),this.container.append(E),this._createPopup(P,o),this.container}}class ts extends U{constructor(o){let l=!!(o.data.hasPopup||o.data.titleObj?.str||o.data.contentsObj?.str||o.data.richText?.str);super(o,{isRenderable:l,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");let o=this.data,{width:l,height:S}=L(o.rect),E=this.svgFactory.create(l,S,!0),T=o.borderStyle.width,P=this.svgFactory.createElement("svg:ellipse");return P.setAttribute("cx",l/2),P.setAttribute("cy",S/2),P.setAttribute("rx",l/2-T/2),P.setAttribute("ry",S/2-T/2),P.setAttribute("stroke-width",T||1),P.setAttribute("stroke","transparent"),P.setAttribute("fill","transparent"),E.append(P),this.container.append(E),this._createPopup(P,o),this.container}}class tr extends U{constructor(o){let l=!!(o.data.hasPopup||o.data.titleObj?.str||o.data.contentsObj?.str||o.data.richText?.str);super(o,{isRenderable:l,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let o=this.data,{width:l,height:S}=L(o.rect),E=this.svgFactory.create(l,S,!0),T=[];for(let l of o.vertices){let S=l.x-o.rect[0],E=o.rect[3]-l.y;T.push(S+","+E)}T=T.join(" ");let P=this.svgFactory.createElement(this.svgElementName);return P.setAttribute("points",T),P.setAttribute("stroke-width",o.borderStyle.width||1),P.setAttribute("stroke","transparent"),P.setAttribute("fill","transparent"),E.append(P),this.container.append(E),this._createPopup(P,o),this.container}}class ta extends tr{constructor(o){super(o),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class tn extends U{constructor(o){let l=!!(o.data.hasPopup||o.data.titleObj?.str||o.data.contentsObj?.str||o.data.richText?.str);super(o,{isRenderable:l,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class to extends U{constructor(o){let l=!!(o.data.hasPopup||o.data.titleObj?.str||o.data.contentsObj?.str||o.data.richText?.str);super(o,{isRenderable:l,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let o=this.data,{width:l,height:S}=L(o.rect),E=this.svgFactory.create(l,S,!0);for(let l of o.inkLists){let S=[];for(let E of l){let l=E.x-o.rect[0],T=o.rect[3]-E.y;S.push(`${l},${T}`)}S=S.join(" ");let T=this.svgFactory.createElement(this.svgElementName);T.setAttribute("points",S),T.setAttribute("stroke-width",o.borderStyle.width||1),T.setAttribute("stroke","transparent"),T.setAttribute("fill","transparent"),this._createPopup(T,o),E.append(T)}return this.container.append(E),this.container}}class tl extends U{constructor(o){let l=!!(o.data.hasPopup||o.data.titleObj?.str||o.data.contentsObj?.str||o.data.richText?.str);super(o,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return(this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals)?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class th extends U{constructor(o){let l=!!(o.data.hasPopup||o.data.titleObj?.str||o.data.contentsObj?.str||o.data.richText?.str);super(o,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return(this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals)?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class td extends U{constructor(o){let l=!!(o.data.hasPopup||o.data.titleObj?.str||o.data.contentsObj?.str||o.data.richText?.str);super(o,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return(this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals)?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class tc extends U{constructor(o){let l=!!(o.data.hasPopup||o.data.titleObj?.str||o.data.contentsObj?.str||o.data.richText?.str);super(o,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return(this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals)?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class tu extends U{constructor(o){let l=!!(o.data.hasPopup||o.data.titleObj?.str||o.data.contentsObj?.str||o.data.richText?.str);super(o,{isRenderable:l,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class tp extends U{constructor(o){super(o,{isRenderable:!0});let{filename:l,content:S}=this.data.file;this.filename=(0,T.getFilenameFromUrl)(l,!0),this.content=S,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:l,content:S})}render(){let o;return this.container.classList.add("fileAttachmentAnnotation"),this.data.hasAppearance?o=document.createElement("div"):(o=document.createElement("img")).src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`,o.classList.add("popupTriggerArea"),o.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(o,this.data),this.container.append(o),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class tg{static #eI(o,l,S,E){let P=o.firstChild||o;P.id=`${T.AnnotationPrefix}${l}`,S.append(o),E?.moveElementInDOM(S,o,P,!1)}static render(o){let{annotations:l,div:S,viewport:M,accessibilityManager:F}=o;(0,T.setLayerDimensions)(S,M);let O={data:null,layer:S,page:o.page,viewport:M,linkService:o.linkService,downloadManager:o.downloadManager,imageResourcesPath:o.imageResourcesPath||"",renderForms:!1!==o.renderForms,svgFactory:new T.DOMSVGFactory,annotationStorage:o.annotationStorage||new P.AnnotationStorage,enableScripting:!0===o.enableScripting,hasJSActions:o.hasJSActions,fieldObjects:o.fieldObjects},I=0;for(let o of l){if(o.noHTML)continue;if(o.annotationType!==E.AnnotationType.POPUP){let{width:l,height:S}=L(o.rect);if(l<=0||S<=0)continue}O.data=o;let l=N.create(O);if(!l.isRenderable)continue;let T=l.render();if(o.hidden&&(T.style.visibility="hidden"),Array.isArray(T))for(let l of T)l.style.zIndex=I++,tg.#eI(l,o.id,S,F);else T.style.zIndex=I++,l instanceof Q?S.prepend(T):tg.#eI(T,o.id,S,F)}this.#eD(S,o.annotationCanvasMap)}static update(o){let{annotationCanvasMap:l,div:S,viewport:E}=o;(0,T.setLayerDimensions)(S,{rotation:E.rotation}),this.#eD(S,l),S.hidden=!1}static #eD(o,l){if(l){for(let[S,E]of l){let l=o.querySelector(`[data-annotation-id="${S}"]`);if(!l)continue;let{firstChild:T}=l;T?"CANVAS"===T.nodeName?T.replaceWith(E):T.before(E):l.append(E)}l.clear()}}}l.AnnotationLayer=tg},(o,l)=>{function S(o){return Math.floor(255*Math.max(0,Math.min(1,o))).toString(16).padStart(2,"0")}Object.defineProperty(l,"__esModule",{value:!0}),l.ColorConverters=void 0;class E{static CMYK_G([o,l,S,E]){return["G",1-Math.min(1,.3*o+.59*S+.11*l+E)]}static G_CMYK([o]){return["CMYK",0,0,0,1-o]}static G_RGB([o]){return["RGB",o,o,o]}static G_HTML([o]){let l=S(o);return`#${l}${l}${l}`}static RGB_G([o,l,S]){return["G",.3*o+.59*l+.11*S]}static RGB_HTML([o,l,E]){let T=S(o),P=S(l),M=S(E);return`#${T}${P}${M}`}static T_HTML(){return"#00000000"}static CMYK_RGB([o,l,S,E]){return["RGB",1-Math.min(1,o+E),1-Math.min(1,S+E),1-Math.min(1,l+E)]}static CMYK_HTML(o){let l=this.CMYK_RGB(o).slice(1);return this.RGB_HTML(l)}static RGB_CMYK([o,l,S]){let E=1-o,T=1-l,P=1-S,M=Math.min(E,T,P);return["CMYK",E,T,P,M]}}l.ColorConverters=E},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.XfaLayer=void 0;var E=S(19);class T{static setupStorage(o,l,S,E,T){let P=E.getValue(l,{value:null});switch(S.name){case"textarea":if(null!==P.value&&(o.textContent=P.value),"print"===T)break;o.addEventListener("input",o=>{E.setValue(l,{value:o.target.value})});break;case"input":if("radio"===S.attributes.type||"checkbox"===S.attributes.type){if(P.value===S.attributes.xfaOn?o.setAttribute("checked",!0):P.value===S.attributes.xfaOff&&o.removeAttribute("checked"),"print"===T)break;o.addEventListener("change",o=>{E.setValue(l,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(null!==P.value&&o.setAttribute("value",P.value),"print"===T)break;o.addEventListener("input",o=>{E.setValue(l,{value:o.target.value})})}break;case"select":if(null!==P.value)for(let o of S.children)o.attributes.value===P.value&&(o.attributes.selected=!0);o.addEventListener("input",o=>{let S=o.target.options,T=-1===S.selectedIndex?"":S[S.selectedIndex].value;E.setValue(l,{value:T})})}}static setAttributes({html:o,element:l,storage:S=null,intent:E,linkService:T}){let{attributes:P}=l,M=o instanceof HTMLAnchorElement;for(let[l,S]of("radio"===P.type&&(P.name=`${P.name}-${E}`),Object.entries(P)))if(null!=S)switch(l){case"class":S.length&&o.setAttribute(l,S.join(" "));break;case"dataId":break;case"id":o.setAttribute("data-element-id",S);break;case"style":Object.assign(o.style,S);break;case"textContent":o.textContent=S;break;default:M&&("href"===l||"newWindow"===l)||o.setAttribute(l,S)}M&&T.addLinkAttributes(o,P.href,P.newWindow),S&&P.dataId&&this.setupStorage(o,P.dataId,l,S)}static render(o){let l=o.annotationStorage,S=o.linkService,T=o.xfaHtml,P=o.intent||"display",M=document.createElement(T.name);T.attributes&&this.setAttributes({html:M,element:T,intent:P,linkService:S});let F=[[T,-1,M]],O=o.div;if(O.append(M),o.viewport){let l=`matrix(${o.viewport.transform.join(",")})`;O.style.transform=l}"richText"!==P&&O.setAttribute("class","xfaLayer xfaFont");let I=[];for(;F.length>0;){let o;let[T,M,O]=F.at(-1);if(M+1===T.children.length){F.pop();continue}let D=T.children[++F.at(-1)[1]];if(null===D)continue;let{name:L}=D;if("#text"===L){let o=document.createTextNode(D.value);I.push(o),O.append(o);continue}if(o=D?.attributes?.xmlns?document.createElementNS(D.attributes.xmlns,L):document.createElement(L),O.append(o),D.attributes&&this.setAttributes({html:o,element:D,storage:l,intent:P,linkService:S}),D.children&&D.children.length>0)F.push([D,-1,o]);else if(D.value){let l=document.createTextNode(D.value);E.XfaText.shouldBuildText(L)&&I.push(l),o.append(l)}}for(let o of O.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))o.setAttribute("readOnly",!0);return{textDivs:I}}static update(o){let l=`matrix(${o.viewport.transform.join(",")})`;o.div.style.transform=l,o.div.hidden=!1}}l.XfaLayer=T},(o,l,S)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.SVGGraphics=void 0;var E=S(6),T=S(1),P=S(10);let M=class{constructor(){(0,T.unreachable)("Not implemented: SVGGraphics")}};l.SVGGraphics=M;{let o={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},S="http://www.w3.org/XML/1998/namespace",D="http://www.w3.org/1999/xlink",L=["butt","round","square"],N=["miter","round","bevel"],U=function(o,l="",S=!1){if(URL.createObjectURL&&"undefined"!=typeof Blob&&!S)return URL.createObjectURL(new Blob([o],{type:l}));let E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",T=`data:${l};base64,`;for(let l=0,S=o.length;l<S;l+=3){let P=255&o[l],M=255&o[l+1],F=255&o[l+2],O=P>>2,I=(3&P)<<4|M>>4,D=l+1<S?(15&M)<<2|F>>6:64,L=l+2<S?63&F:64;T+=E[O]+E[I]+E[D]+E[L]}return T},H=function(){let o=new Uint8Array([137,80,78,71,13,10,26,10]),l=12,S=new Int32Array(256);for(let o=0;o<256;o++){let l=o;for(let o=0;o<8;o++)l=1&l?3988292384^l>>1&2147483647:l>>1&2147483647;S[o]=l}function E(o,l,E){let T=-1;for(let P=l;P<E;P++){let l=(T^o[P])&255,E=S[l];T=T>>>8^E}return -1^T}function M(o,l,S,T){let P=T,M=l.length;S[P]=M>>24&255,S[P+1]=M>>16&255,S[P+2]=M>>8&255,S[P+3]=255&M,S[P+=4]=255&o.charCodeAt(0),S[P+1]=255&o.charCodeAt(1),S[P+2]=255&o.charCodeAt(2),S[P+3]=255&o.charCodeAt(3),P+=4,S.set(l,P),P+=l.length;let F=E(S,T+4,P);S[P]=F>>24&255,S[P+1]=F>>16&255,S[P+2]=F>>8&255,S[P+3]=255&F}function F(o,l,S){let E=1,T=0;for(let P=l;P<S;++P)T=(T+(E=(E+(255&o[P]))%65521))%65521;return T<<16|E}function O(o){if(!P.isNodeJS)return I(o);try{let l;l=parseInt(process.versions.node)>=8?o:Buffer.from(o);let S=__webpack_require__(5232).deflateSync(l,{level:9});return S instanceof Uint8Array?S:new Uint8Array(S)}catch(o){(0,T.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+o)}return I(o)}function I(o){let l=o.length,S=65535,E=Math.ceil(l/S),T=new Uint8Array(2+l+5*E+4),P=0;T[P++]=120,T[P++]=156;let M=0;for(;l>S;)T[P++]=0,T[P++]=255,T[P++]=255,T[P++]=0,T[P++]=0,T.set(o.subarray(M,M+S),P),P+=S,M+=S,l-=S;T[P++]=1,T[P++]=255&l,T[P++]=l>>8&255,T[P++]=255&~l,T[P++]=(65535&~l)>>8&255,T.set(o.subarray(M),P),P+=o.length-M;let O=F(o,0,o.length);return T[P++]=O>>24&255,T[P++]=O>>16&255,T[P++]=O>>8&255,T[P++]=255&O,T}function D(S,E,P,F){let I,D,L;let N=S.width,H=S.height,W=S.data;switch(E){case T.ImageKind.GRAYSCALE_1BPP:D=0,I=1,L=N+7>>3;break;case T.ImageKind.RGB_24BPP:D=2,I=8,L=3*N;break;case T.ImageKind.RGBA_32BPP:D=6,I=8,L=4*N;break;default:throw Error("invalid format")}let z=new Uint8Array((1+L)*H),V=0,$=0;for(let o=0;o<H;++o)z[V++]=0,z.set(W.subarray($,$+L),V),$+=L,V+=L;if(E===T.ImageKind.GRAYSCALE_1BPP&&F){V=0;for(let o=0;o<H;o++){V++;for(let o=0;o<L;o++)z[V++]^=255}}let K=new Uint8Array([N>>24&255,N>>16&255,N>>8&255,255&N,H>>24&255,H>>16&255,H>>8&255,255&H,I,D,0,0,0]),Y=O(z),J=o.length+3*l+K.length+Y.length,Q=new Uint8Array(J),Z=0;return Q.set(o,Z),M("IHDR",K,Q,Z+=o.length),M("IDATA",Y,Q,Z+=l+K.length),Z+=l+Y.length,M("IEND",new Uint8Array(0),Q,Z),U(Q,"image/png",P)}return function(o,l,S){let E=void 0===o.kind?T.ImageKind.GRAYSCALE_1BPP:o.kind;return D(o,E,l,S)}}();class W{constructor(){this.fontSizeScale=1,this.fontWeight=o.fontWeight,this.fontSize=0,this.textMatrix=T.IDENTITY_MATRIX,this.fontMatrix=T.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=T.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=o.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(o,l){this.x=o,this.y=l}}function F(o){let l=[],S=[];for(let E of o){if("save"===E.fn){l.push({fnId:92,fn:"group",items:[]}),S.push(l),l=l.at(-1).items;continue}"restore"===E.fn?l=S.pop():l.push(E)}return l}function O(o){if(Number.isInteger(o))return o.toString();let l=o.toFixed(10),S=l.length-1;if("0"!==l[S])return l;do S--;while("0"===l[S]);return l.substring(0,"."===l[S]?S:S+1)}function I(o){if(0===o[4]&&0===o[5]){if(0===o[1]&&0===o[2])return 1===o[0]&&1===o[3]?"":`scale(${O(o[0])} ${O(o[3])})`;if(o[0]===o[3]&&o[1]===-o[2]){let l=180*Math.acos(o[0])/Math.PI;return`rotate(${O(l)})`}}else if(1===o[0]&&0===o[1]&&0===o[2]&&1===o[3])return`translate(${O(o[4])} ${O(o[5])})`;return`matrix(${O(o[0])} ${O(o[1])} ${O(o[2])} ${O(o[3])} ${O(o[4])} ${O(o[5])})`}let z=0,V=0,$=0;l.SVGGraphics=M=class{constructor(o,l,S=!1){for(let P in(0,E.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new E.DOMSVGFactory,this.current=new W,this.transformMatrix=T.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=o,this.objs=l,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!S,this._operatorIdMapping=[],T.OPS)this._operatorIdMapping[T.OPS[P]]=P}getObject(o,l=null){return"string"==typeof o?o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o):l}save(){this.transformStack.push(this.transformMatrix);let o=this.current;this.extraStack.push(o),this.current=o.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(o){this.save(),this.executeOpTree(o),this.restore()}loadDependencies(o){let l=o.fnArray,S=o.argsArray;for(let o=0,E=l.length;o<E;o++)if(l[o]===T.OPS.dependency)for(let l of S[o]){let o=l.startsWith("g_")?this.commonObjs:this.objs,S=new Promise(S=>{o.get(l,S)});this.current.dependencies.push(S)}return Promise.all(this.current.dependencies)}transform(o,l,S,E,P,M){let F=[o,l,S,E,P,M];this.transformMatrix=T.Util.transform(this.transformMatrix,F),this.tgrp=null}getSVG(o,l){this.viewport=l;let S=this._initialize(l);return this.loadDependencies(o).then(()=>(this.transformMatrix=T.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(o)),S))}convertOpList(o){let l=this._operatorIdMapping,S=o.argsArray,E=o.fnArray,T=[];for(let o=0,P=E.length;o<P;o++){let P=E[o];T.push({fnId:P,fn:l[P],args:S[o]})}return F(T)}executeOpTree(o){for(let l of o){let o=l.fn,S=l.fnId,E=l.args;switch(0|S){case T.OPS.beginText:this.beginText();break;case T.OPS.dependency:break;case T.OPS.setLeading:this.setLeading(E);break;case T.OPS.setLeadingMoveText:this.setLeadingMoveText(E[0],E[1]);break;case T.OPS.setFont:this.setFont(E);break;case T.OPS.showText:case T.OPS.showSpacedText:this.showText(E[0]);break;case T.OPS.endText:this.endText();break;case T.OPS.moveText:this.moveText(E[0],E[1]);break;case T.OPS.setCharSpacing:this.setCharSpacing(E[0]);break;case T.OPS.setWordSpacing:this.setWordSpacing(E[0]);break;case T.OPS.setHScale:this.setHScale(E[0]);break;case T.OPS.setTextMatrix:this.setTextMatrix(E[0],E[1],E[2],E[3],E[4],E[5]);break;case T.OPS.setTextRise:this.setTextRise(E[0]);break;case T.OPS.setTextRenderingMode:this.setTextRenderingMode(E[0]);break;case T.OPS.setLineWidth:this.setLineWidth(E[0]);break;case T.OPS.setLineJoin:this.setLineJoin(E[0]);break;case T.OPS.setLineCap:this.setLineCap(E[0]);break;case T.OPS.setMiterLimit:this.setMiterLimit(E[0]);break;case T.OPS.setFillRGBColor:this.setFillRGBColor(E[0],E[1],E[2]);break;case T.OPS.setStrokeRGBColor:this.setStrokeRGBColor(E[0],E[1],E[2]);break;case T.OPS.setStrokeColorN:this.setStrokeColorN(E);break;case T.OPS.setFillColorN:this.setFillColorN(E);break;case T.OPS.shadingFill:this.shadingFill(E[0]);break;case T.OPS.setDash:this.setDash(E[0],E[1]);break;case T.OPS.setRenderingIntent:this.setRenderingIntent(E[0]);break;case T.OPS.setFlatness:this.setFlatness(E[0]);break;case T.OPS.setGState:this.setGState(E[0]);break;case T.OPS.fill:this.fill();break;case T.OPS.eoFill:this.eoFill();break;case T.OPS.stroke:this.stroke();break;case T.OPS.fillStroke:this.fillStroke();break;case T.OPS.eoFillStroke:this.eoFillStroke();break;case T.OPS.clip:this.clip("nonzero");break;case T.OPS.eoClip:this.clip("evenodd");break;case T.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case T.OPS.paintImageXObject:this.paintImageXObject(E[0]);break;case T.OPS.paintInlineImageXObject:this.paintInlineImageXObject(E[0]);break;case T.OPS.paintImageMaskXObject:this.paintImageMaskXObject(E[0]);break;case T.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(E[0],E[1]);break;case T.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case T.OPS.closePath:this.closePath();break;case T.OPS.closeStroke:this.closeStroke();break;case T.OPS.closeFillStroke:this.closeFillStroke();break;case T.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case T.OPS.nextLine:this.nextLine();break;case T.OPS.transform:this.transform(E[0],E[1],E[2],E[3],E[4],E[5]);break;case T.OPS.constructPath:this.constructPath(E[0],E[1]);break;case T.OPS.endPath:this.endPath();break;case 92:this.group(l.items);break;default:(0,T.warn)(`Unimplemented operator ${o}`)}}}setWordSpacing(o){this.current.wordSpacing=o}setCharSpacing(o){this.current.charSpacing=o}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(o,l,S,E,T,P){let M=this.current;M.textMatrix=M.lineMatrix=[o,l,S,E,T,P],M.textMatrixScale=Math.hypot(o,l),M.x=M.lineX=0,M.y=M.lineY=0,M.xcoords=[],M.ycoords=[],M.tspan=this.svgFactory.createElement("svg:tspan"),M.tspan.setAttributeNS(null,"font-family",M.fontFamily),M.tspan.setAttributeNS(null,"font-size",`${O(M.fontSize)}px`),M.tspan.setAttributeNS(null,"y",O(-M.y)),M.txtElement=this.svgFactory.createElement("svg:text"),M.txtElement.append(M.tspan)}beginText(){let o=this.current;o.x=o.lineX=0,o.y=o.lineY=0,o.textMatrix=T.IDENTITY_MATRIX,o.lineMatrix=T.IDENTITY_MATRIX,o.textMatrixScale=1,o.tspan=this.svgFactory.createElement("svg:tspan"),o.txtElement=this.svgFactory.createElement("svg:text"),o.txtgrp=this.svgFactory.createElement("svg:g"),o.xcoords=[],o.ycoords=[]}moveText(o,l){let S=this.current;S.x=S.lineX+=o,S.y=S.lineY+=l,S.xcoords=[],S.ycoords=[],S.tspan=this.svgFactory.createElement("svg:tspan"),S.tspan.setAttributeNS(null,"font-family",S.fontFamily),S.tspan.setAttributeNS(null,"font-size",`${O(S.fontSize)}px`),S.tspan.setAttributeNS(null,"y",O(-S.y))}showText(l){let E=this.current,P=E.font,M=E.fontSize;if(0===M)return;let F=E.fontSizeScale,D=E.charSpacing,L=E.wordSpacing,N=E.fontDirection,U=E.textHScale*N,H=P.vertical,W=H?1:-1,z=P.defaultVMetrics,V=M*E.fontMatrix[0],$=0;for(let o of l){let l,S,T;if(null===o){$+=N*L;continue}if("number"==typeof o){$+=W*o*M/1e3;continue}let O=(o.isSpace?L:0)+D,I=o.fontChar,U=o.width;if(H){let E;let T=o.vmetric||z;E=-(E=o.vmetric?T[1]:.5*U)*V;let P=T[2]*V;U=T?-T[0]:U,l=E/F,S=($+P)/F}else l=$/F,S=0;(o.isInFont||P.missingFile)&&(E.xcoords.push(E.x+l),H&&E.ycoords.push(-E.y+S),E.tspan.textContent+=I),$+=T=H?U*V-O*N:U*V+O*N}E.tspan.setAttributeNS(null,"x",E.xcoords.map(O).join(" ")),H?E.tspan.setAttributeNS(null,"y",E.ycoords.map(O).join(" ")):E.tspan.setAttributeNS(null,"y",O(-E.y)),H?E.y-=$:E.x+=$*U,E.tspan.setAttributeNS(null,"font-family",E.fontFamily),E.tspan.setAttributeNS(null,"font-size",`${O(E.fontSize)}px`),E.fontStyle!==o.fontStyle&&E.tspan.setAttributeNS(null,"font-style",E.fontStyle),E.fontWeight!==o.fontWeight&&E.tspan.setAttributeNS(null,"font-weight",E.fontWeight);let K=E.textRenderingMode&T.TextRenderingMode.FILL_STROKE_MASK;if(K===T.TextRenderingMode.FILL||K===T.TextRenderingMode.FILL_STROKE?(E.fillColor!==o.fillColor&&E.tspan.setAttributeNS(null,"fill",E.fillColor),E.fillAlpha<1&&E.tspan.setAttributeNS(null,"fill-opacity",E.fillAlpha)):E.textRenderingMode===T.TextRenderingMode.ADD_TO_PATH?E.tspan.setAttributeNS(null,"fill","transparent"):E.tspan.setAttributeNS(null,"fill","none"),K===T.TextRenderingMode.STROKE||K===T.TextRenderingMode.FILL_STROKE){let o=1/(E.textMatrixScale||1);this._setStrokeAttributes(E.tspan,o)}let Y=E.textMatrix;0!==E.textRise&&(Y=Y.slice(),Y[5]+=E.textRise),E.txtElement.setAttributeNS(null,"transform",`${I(Y)} scale(${O(U)}, -1)`),E.txtElement.setAttributeNS(S,"xml:space","preserve"),E.txtElement.append(E.tspan),E.txtgrp.append(E.txtElement),this._ensureTransformGroup().append(E.txtElement)}setLeadingMoveText(o,l){this.setLeading(-l),this.moveText(o,l)}addFontStyle(o){if(!o.data)throw Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));let l=U(o.data,o.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${o.loadedName}"; src: url(${l}); }
`}setFont(o){let l=this.current,S=this.commonObjs.get(o[0]),E=o[1];l.font=S,!this.embedFonts||S.missingFile||this.embeddedFonts[S.loadedName]||(this.addFontStyle(S),this.embeddedFonts[S.loadedName]=S),l.fontMatrix=S.fontMatrix||T.FONT_IDENTITY_MATRIX;let P="normal";S.black?P="900":S.bold&&(P="bold");let M=S.italic?"italic":"normal";E<0?(E=-E,l.fontDirection=-1):l.fontDirection=1,l.fontSize=E,l.fontFamily=S.loadedName,l.fontWeight=P,l.fontStyle=M,l.tspan=this.svgFactory.createElement("svg:tspan"),l.tspan.setAttributeNS(null,"y",O(-l.y)),l.xcoords=[],l.ycoords=[]}endText(){let o=this.current;o.textRenderingMode&T.TextRenderingMode.ADD_TO_PATH_FLAG&&o.txtElement?.hasChildNodes()&&(o.element=o.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(o){o>0&&(this.current.lineWidth=o)}setLineCap(o){this.current.lineCap=L[o]}setLineJoin(o){this.current.lineJoin=N[o]}setMiterLimit(o){this.current.miterLimit=o}setStrokeAlpha(o){this.current.strokeAlpha=o}setStrokeRGBColor(o,l,S){this.current.strokeColor=T.Util.makeHexColor(o,l,S)}setFillAlpha(o){this.current.fillAlpha=o}setFillRGBColor(o,l,S){this.current.fillColor=T.Util.makeHexColor(o,l,S),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(o){this.current.strokeColor=this._makeColorN_Pattern(o)}setFillColorN(o){this.current.fillColor=this._makeColorN_Pattern(o)}shadingFill(o){let l=this.viewport.width,S=this.viewport.height,E=T.Util.inverseTransform(this.transformMatrix),P=T.Util.applyTransform([0,0],E),M=T.Util.applyTransform([0,S],E),F=T.Util.applyTransform([l,0],E),O=T.Util.applyTransform([l,S],E),I=Math.min(P[0],M[0],F[0],O[0]),D=Math.min(P[1],M[1],F[1],O[1]),L=Math.max(P[0],M[0],F[0],O[0]),N=Math.max(P[1],M[1],F[1],O[1]),U=this.svgFactory.createElement("svg:rect");U.setAttributeNS(null,"x",I),U.setAttributeNS(null,"y",D),U.setAttributeNS(null,"width",L-I),U.setAttributeNS(null,"height",N-D),U.setAttributeNS(null,"fill",this._makeShadingPattern(o)),this.current.fillAlpha<1&&U.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(U)}_makeColorN_Pattern(o){return"TilingPattern"===o[0]?this._makeTilingPattern(o):this._makeShadingPattern(o)}_makeTilingPattern(o){let l=o[1],S=o[2],E=o[3]||T.IDENTITY_MATRIX,[P,M,F,O]=o[4],I=o[5],D=o[6],L=o[7],N=`shading${$++}`,[U,H,W,z]=T.Util.normalizeRect([...T.Util.applyTransform([P,M],E),...T.Util.applyTransform([F,O],E)]),[V,K]=T.Util.singularValueDecompose2dScale(E),Y=I*V,J=D*K,Q=this.svgFactory.createElement("svg:pattern");Q.setAttributeNS(null,"id",N),Q.setAttributeNS(null,"patternUnits","userSpaceOnUse"),Q.setAttributeNS(null,"width",Y),Q.setAttributeNS(null,"height",J),Q.setAttributeNS(null,"x",`${U}`),Q.setAttributeNS(null,"y",`${H}`);let Z=this.svg,tt=this.transformMatrix,te=this.current.fillColor,ti=this.current.strokeColor,ts=this.svgFactory.create(W-U,z-H);if(this.svg=ts,this.transformMatrix=E,2===L){let o=T.Util.makeHexColor(...l);this.current.fillColor=o,this.current.strokeColor=o}return this.executeOpTree(this.convertOpList(S)),this.svg=Z,this.transformMatrix=tt,this.current.fillColor=te,this.current.strokeColor=ti,Q.append(ts.childNodes[0]),this.defs.append(Q),`url(#${N})`}_makeShadingPattern(o){switch("string"==typeof o&&(o=this.objs.get(o)),o[0]){case"RadialAxial":let l;let S=`shading${$++}`,E=o[3];switch(o[1]){case"axial":let P=o[4],M=o[5];(l=this.svgFactory.createElement("svg:linearGradient")).setAttributeNS(null,"id",S),l.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),l.setAttributeNS(null,"x1",P[0]),l.setAttributeNS(null,"y1",P[1]),l.setAttributeNS(null,"x2",M[0]),l.setAttributeNS(null,"y2",M[1]);break;case"radial":let F=o[4],O=o[5],I=o[6],D=o[7];(l=this.svgFactory.createElement("svg:radialGradient")).setAttributeNS(null,"id",S),l.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),l.setAttributeNS(null,"cx",O[0]),l.setAttributeNS(null,"cy",O[1]),l.setAttributeNS(null,"r",D),l.setAttributeNS(null,"fx",F[0]),l.setAttributeNS(null,"fy",F[1]),l.setAttributeNS(null,"fr",I);break;default:throw Error(`Unknown RadialAxial type: ${o[1]}`)}for(let o of E){let S=this.svgFactory.createElement("svg:stop");S.setAttributeNS(null,"offset",o[0]),S.setAttributeNS(null,"stop-color",o[1]),l.append(S)}return this.defs.append(l),`url(#${S})`;case"Mesh":return(0,T.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw Error(`Unknown IR type: ${o[0]}`)}}setDash(o,l){this.current.dashArray=o,this.current.dashPhase=l}constructPath(o,l){let S=this.current,E=S.x,P=S.y,M=[],F=0;for(let S of o)switch(0|S){case T.OPS.rectangle:E=l[F++],P=l[F++];let o=l[F++],I=l[F++],D=E+o,L=P+I;M.push("M",O(E),O(P),"L",O(D),O(P),"L",O(D),O(L),"L",O(E),O(L),"Z");break;case T.OPS.moveTo:E=l[F++],P=l[F++],M.push("M",O(E),O(P));break;case T.OPS.lineTo:E=l[F++],P=l[F++],M.push("L",O(E),O(P));break;case T.OPS.curveTo:E=l[F+4],P=l[F+5],M.push("C",O(l[F]),O(l[F+1]),O(l[F+2]),O(l[F+3]),O(E),O(P)),F+=6;break;case T.OPS.curveTo2:M.push("C",O(E),O(P),O(l[F]),O(l[F+1]),O(l[F+2]),O(l[F+3])),E=l[F+2],P=l[F+3],F+=4;break;case T.OPS.curveTo3:E=l[F+2],P=l[F+3],M.push("C",O(l[F]),O(l[F+1]),O(E),O(P),O(E),O(P)),F+=4;break;case T.OPS.closePath:M.push("Z")}M=M.join(" "),S.path&&o.length>0&&o[0]!==T.OPS.rectangle&&o[0]!==T.OPS.moveTo?M=S.path.getAttributeNS(null,"d")+M:(S.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(S.path)),S.path.setAttributeNS(null,"d",M),S.path.setAttributeNS(null,"fill","none"),S.element=S.path,S.setCurrentPoint(E,P)}endPath(){let o=this.current;if(o.path=null,!this.pendingClip)return;if(!o.element){this.pendingClip=null;return}let l=`clippath${z++}`,S=this.svgFactory.createElement("svg:clipPath");S.setAttributeNS(null,"id",l),S.setAttributeNS(null,"transform",I(this.transformMatrix));let E=o.element.cloneNode(!0);if("evenodd"===this.pendingClip?E.setAttributeNS(null,"clip-rule","evenodd"):E.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,S.append(E),this.defs.append(S),o.activeClipUrl){for(let l of(o.clipGroup=null,this.extraStack))l.clipGroup=null;S.setAttributeNS(null,"clip-path",o.activeClipUrl)}o.activeClipUrl=`url(#${l})`,this.tgrp=null}clip(o){this.pendingClip=o}closePath(){let o=this.current;if(o.path){let l=`${o.path.getAttributeNS(null,"d")}Z`;o.path.setAttributeNS(null,"d",l)}}setLeading(o){this.current.leading=-o}setTextRise(o){this.current.textRise=o}setTextRenderingMode(o){this.current.textRenderingMode=o}setHScale(o){this.current.textHScale=o/100}setRenderingIntent(o){}setFlatness(o){}setGState(o){for(let[l,S]of o)switch(l){case"LW":this.setLineWidth(S);break;case"LC":this.setLineCap(S);break;case"LJ":this.setLineJoin(S);break;case"ML":this.setMiterLimit(S);break;case"D":this.setDash(S[0],S[1]);break;case"RI":this.setRenderingIntent(S);break;case"FL":this.setFlatness(S);break;case"Font":this.setFont(S);break;case"CA":this.setStrokeAlpha(S);break;case"ca":this.setFillAlpha(S);break;default:(0,T.warn)(`Unimplemented graphic state operator ${l}`)}}fill(){let o=this.current;o.element&&(o.element.setAttributeNS(null,"fill",o.fillColor),o.element.setAttributeNS(null,"fill-opacity",o.fillAlpha),this.endPath())}stroke(){let o=this.current;o.element&&(this._setStrokeAttributes(o.element),o.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(o,l=1){let S=this.current,E=S.dashArray;1!==l&&E.length>0&&(E=E.map(function(o){return l*o})),o.setAttributeNS(null,"stroke",S.strokeColor),o.setAttributeNS(null,"stroke-opacity",S.strokeAlpha),o.setAttributeNS(null,"stroke-miterlimit",O(S.miterLimit)),o.setAttributeNS(null,"stroke-linecap",S.lineCap),o.setAttributeNS(null,"stroke-linejoin",S.lineJoin),o.setAttributeNS(null,"stroke-width",O(l*S.lineWidth)+"px"),o.setAttributeNS(null,"stroke-dasharray",E.map(O).join(" ")),o.setAttributeNS(null,"stroke-dashoffset",O(l*S.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){let o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y","0"),o.setAttributeNS(null,"width","1px"),o.setAttributeNS(null,"height","1px"),o.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(o)}paintImageXObject(o){let l=this.getObject(o);if(!l){(0,T.warn)(`Dependent image with object ID ${o} is not ready yet`);return}this.paintInlineImageXObject(l)}paintInlineImageXObject(o,l){let S=o.width,E=o.height,T=H(o,this.forceDataSchema,!!l),P=this.svgFactory.createElement("svg:rect");P.setAttributeNS(null,"x","0"),P.setAttributeNS(null,"y","0"),P.setAttributeNS(null,"width",O(S)),P.setAttributeNS(null,"height",O(E)),this.current.element=P,this.clip("nonzero");let M=this.svgFactory.createElement("svg:image");M.setAttributeNS(D,"xlink:href",T),M.setAttributeNS(null,"x","0"),M.setAttributeNS(null,"y",O(-E)),M.setAttributeNS(null,"width",O(S)+"px"),M.setAttributeNS(null,"height",O(E)+"px"),M.setAttributeNS(null,"transform",`scale(${O(1/S)} ${O(-1/E)})`),l?l.append(M):this._ensureTransformGroup().append(M)}paintImageMaskXObject(o){let l=this.getObject(o.data,o);if(l.bitmap){(0,T.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}let S=this.current,E=l.width,P=l.height,M=S.fillColor;S.maskId=`mask${V++}`;let F=this.svgFactory.createElement("svg:mask");F.setAttributeNS(null,"id",S.maskId);let I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x","0"),I.setAttributeNS(null,"y","0"),I.setAttributeNS(null,"width",O(E)),I.setAttributeNS(null,"height",O(P)),I.setAttributeNS(null,"fill",M),I.setAttributeNS(null,"mask",`url(#${S.maskId})`),this.defs.append(F),this._ensureTransformGroup().append(I),this.paintInlineImageXObject(l,F)}paintFormXObjectBegin(o,l){if(Array.isArray(o)&&6===o.length&&this.transform(o[0],o[1],o[2],o[3],o[4],o[5]),l){let o=l[2]-l[0],S=l[3]-l[1],E=this.svgFactory.createElement("svg:rect");E.setAttributeNS(null,"x",l[0]),E.setAttributeNS(null,"y",l[1]),E.setAttributeNS(null,"width",O(o)),E.setAttributeNS(null,"height",O(S)),this.current.element=E,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(o){let l=this.svgFactory.create(o.width,o.height),S=this.svgFactory.createElement("svg:defs");l.append(S),this.defs=S;let E=this.svgFactory.createElement("svg:g");return E.setAttributeNS(null,"transform",I(o.transform)),l.append(E),this.svg=E,l}_ensureClipGroup(){if(!this.current.clipGroup){let o=this.svgFactory.createElement("svg:g");o.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(o),this.current.clipGroup=o}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",I(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(o){var l=__webpack_module_cache__[o];if(void 0!==l)return l.exports;var S=__webpack_module_cache__[o]={exports:{}};return __webpack_modules__[o](S,S.exports,__w_pdfjs_require__),S.exports}var __nested_webpack_exports__={};return(()=>{var o=__nested_webpack_exports__;Object.defineProperty(o,"__esModule",{value:!0}),Object.defineProperty(o,"AbortException",{enumerable:!0,get:function(){return l.AbortException}}),Object.defineProperty(o,"AnnotationEditorLayer",{enumerable:!0,get:function(){return P.AnnotationEditorLayer}}),Object.defineProperty(o,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return l.AnnotationEditorParamsType}}),Object.defineProperty(o,"AnnotationEditorType",{enumerable:!0,get:function(){return l.AnnotationEditorType}}),Object.defineProperty(o,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return M.AnnotationEditorUIManager}}),Object.defineProperty(o,"AnnotationLayer",{enumerable:!0,get:function(){return F.AnnotationLayer}}),Object.defineProperty(o,"AnnotationMode",{enumerable:!0,get:function(){return l.AnnotationMode}}),Object.defineProperty(o,"CMapCompressionType",{enumerable:!0,get:function(){return l.CMapCompressionType}}),Object.defineProperty(o,"FeatureTest",{enumerable:!0,get:function(){return l.FeatureTest}}),Object.defineProperty(o,"GlobalWorkerOptions",{enumerable:!0,get:function(){return O.GlobalWorkerOptions}}),Object.defineProperty(o,"InvalidPDFException",{enumerable:!0,get:function(){return l.InvalidPDFException}}),Object.defineProperty(o,"MissingPDFException",{enumerable:!0,get:function(){return l.MissingPDFException}}),Object.defineProperty(o,"OPS",{enumerable:!0,get:function(){return l.OPS}}),Object.defineProperty(o,"PDFDataRangeTransport",{enumerable:!0,get:function(){return S.PDFDataRangeTransport}}),Object.defineProperty(o,"PDFDateString",{enumerable:!0,get:function(){return E.PDFDateString}}),Object.defineProperty(o,"PDFWorker",{enumerable:!0,get:function(){return S.PDFWorker}}),Object.defineProperty(o,"PasswordResponses",{enumerable:!0,get:function(){return l.PasswordResponses}}),Object.defineProperty(o,"PermissionFlag",{enumerable:!0,get:function(){return l.PermissionFlag}}),Object.defineProperty(o,"PixelsPerInch",{enumerable:!0,get:function(){return E.PixelsPerInch}}),Object.defineProperty(o,"PromiseCapability",{enumerable:!0,get:function(){return l.PromiseCapability}}),Object.defineProperty(o,"RenderingCancelledException",{enumerable:!0,get:function(){return E.RenderingCancelledException}}),Object.defineProperty(o,"SVGGraphics",{enumerable:!0,get:function(){return I.SVGGraphics}}),Object.defineProperty(o,"UnexpectedResponseException",{enumerable:!0,get:function(){return l.UnexpectedResponseException}}),Object.defineProperty(o,"Util",{enumerable:!0,get:function(){return l.Util}}),Object.defineProperty(o,"VerbosityLevel",{enumerable:!0,get:function(){return l.VerbosityLevel}}),Object.defineProperty(o,"XfaLayer",{enumerable:!0,get:function(){return D.XfaLayer}}),Object.defineProperty(o,"build",{enumerable:!0,get:function(){return S.build}}),Object.defineProperty(o,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return l.createValidAbsoluteUrl}}),Object.defineProperty(o,"getDocument",{enumerable:!0,get:function(){return S.getDocument}}),Object.defineProperty(o,"getFilenameFromUrl",{enumerable:!0,get:function(){return E.getFilenameFromUrl}}),Object.defineProperty(o,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return E.getPdfFilenameFromUrl}}),Object.defineProperty(o,"getXfaPageViewport",{enumerable:!0,get:function(){return E.getXfaPageViewport}}),Object.defineProperty(o,"isDataScheme",{enumerable:!0,get:function(){return E.isDataScheme}}),Object.defineProperty(o,"isPdfFile",{enumerable:!0,get:function(){return E.isPdfFile}}),Object.defineProperty(o,"loadScript",{enumerable:!0,get:function(){return E.loadScript}}),Object.defineProperty(o,"normalizeUnicode",{enumerable:!0,get:function(){return l.normalizeUnicode}}),Object.defineProperty(o,"renderTextLayer",{enumerable:!0,get:function(){return T.renderTextLayer}}),Object.defineProperty(o,"setLayerDimensions",{enumerable:!0,get:function(){return E.setLayerDimensions}}),Object.defineProperty(o,"shadow",{enumerable:!0,get:function(){return l.shadow}}),Object.defineProperty(o,"updateTextLayer",{enumerable:!0,get:function(){return T.updateTextLayer}}),Object.defineProperty(o,"version",{enumerable:!0,get:function(){return S.version}});var l=__w_pdfjs_require__(1),S=__w_pdfjs_require__(2),E=__w_pdfjs_require__(6),T=__w_pdfjs_require__(26),P=__w_pdfjs_require__(27),M=__w_pdfjs_require__(5),F=__w_pdfjs_require__(32),O=__w_pdfjs_require__(14),I=__w_pdfjs_require__(35),D=__w_pdfjs_require__(34)})(),__nested_webpack_exports__})())}}]);